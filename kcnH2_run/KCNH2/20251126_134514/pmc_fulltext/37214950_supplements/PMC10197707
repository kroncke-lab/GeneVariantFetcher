
<!DOCTYPE html>
<html lang="en" >
    <head >

        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
        

        
        
  <link rel="stylesheet" href="/static/assets/style-8258669d.css" />
<script type="module" crossorigin="" src="/static/assets/base_style-f4a99799.js"></script>

  <link rel="stylesheet" href="/static/assets/style-ef962842.css" />
<link rel="stylesheet" href="/static/assets/style-3ade8b5c.css" />
<script type="module" crossorigin="" src="/static/assets/article_style-d757a0dd.js"></script>

  
  
    <style>
  
  
  @media screen and (min-width: 64em) {
    div.pmc-wm {
      background: repeat-y;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='350' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cdefs%3E%3Cfilter x='-.02' y='0' width='1.05' height='1' id='c'%3E%3CfeFlood flood-color='%23FFF'/%3E%3CfeComposite in='SourceGraphic'/%3E%3C/filter%3E%3Ctext id='b' font-family='Helvetica' font-size='11pt' style='opacity:1;fill:%23005ea2;stroke:none;text-anchor:middle' x='175' y='14'%3EPreprint%3C/text%3E%3Cpath id='a' style='fill:%23005ea2' d='M0 8h350v3H0z'/%3E%3C/defs%3E%3Cuse xlink:href='%23a' transform='rotate(90 10 10)'/%3E%3Cuse xlink:href='%23b' transform='rotate(90 10 10)' filter='url(%23c)'/%3E%3C/svg%3E");
      padding-left: 3rem;
    }
  }
</style>

  



        
            <link rel="apple-touch-icon"
                  sizes="180x180"
                  href="/static/img/favicons/apple-touch-icon.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="48x48"
                  href="/static/img/favicons/favicon-48x48.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="32x32"
                  href="/static/img/favicons/favicon-32x32.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="16x16"
                  href="/static/img/favicons/favicon-16x16.png" />
            <link rel="manifest" href="/static/img/favicons/site.webmanifest" />
            <link rel="mask-icon"
                  href="/static/img/favicons/safari-pinned-tab.svg"
                  color="#0071bc" />
            <meta name="msapplication-config"
                  content="/static/img/favicons/browserconfig.xml" />
            <meta name="theme-color" content="#ffffff" />
        

        <title>
            Enhlink infers distal and context-specific enhancer-promoter linkages - PMC
        </title>

        
        
  
  <!-- Logging params: Pinger defaults -->
<meta name="ncbi_app" content="cloudpmc-viewer" />
<meta name="ncbi_db" content="pmc" />
<meta name="ncbi_phid" content="8E598BED92769AB33B8BED000081DB2D.m_1" />
<meta name="ncbi_pinger_stat_url" content="https://pmc.ncbi.nlm.nih.gov/stat" />
<!-- Logging params: Pinger custom -->
<meta name="ncbi_pdid" content="article" />
  
    <link rel="preconnect" href="https://www.google-analytics.com" />

    
        <link rel="preconnect" href="https://cdn.ncbi.nlm.nih.gov" />
    

    <!-- Include USWDS Init Script -->
    <script src="/static/assets/uswds-init.js"></script>


    <meta name="ncbi_domain" content="biorxiv">
<meta name="ncbi_type" content="fulltext">
<meta name="ncbi_pcid" content="preprint">
<meta name="ncbi_feature" content="associated_data">
<link rel="canonical" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10197707/">
<meta name="robots" content="INDEX,NOFOLLOW,NOARCHIVE">
<meta name="citation_journal_title" content="bioRxiv">
<meta name="citation_title" content="Enhlink infers distal and context-specific enhancer-promoter linkages">
<meta name="citation_author" content="Olivier B Poirion">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author" content="Wulin Zuo">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author" content="Catrina Spruce">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author" content="Sandra L Daigle">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author" content="Ashley Olson">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author_institution" content="Center for Systems Neurogenetics of Addiction at The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author" content="Daniel A Skelly">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author" content="Elissa J Chesler">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author_institution" content="Center for Systems Neurogenetics of Addiction at The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author" content="Christopher L Baker">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author_institution" content="Center for Systems Neurogenetics of Addiction at The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_author" content="Brian S White">
<meta name="citation_author_institution" content="The Jackson Laboratory, Bar Harbor, ME, USA">
<meta name="citation_publication_date" content="2023 May 11">
<meta name="citation_firstpage" content="2023.05.11.540453">
<meta name="citation_doi" content="10.1101/2023.05.11.540453">
<meta name="citation_pmid" content="37214950">
<meta name="citation_abstract_html_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC10197707/">
<meta name="citation_fulltext_html_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC10197707/">
<meta name="citation_pdf_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC10197707/pdf/nihpp-2023.05.11.540453v1.pdf">
<meta name="description" content="Enhancers play a crucial role in regulating gene expression and their functional status can be queried with cell type precision using using single-cell (sc)ATAC-seq. To facilitate analysis of such data, we developed Enhlink, a novel computational ...">
<meta name="og:title" content="Enhlink infers distal and context-specific enhancer-promoter linkages">
<meta name="og:type" content="article">
<meta name="og:site_name" content="PubMed Central (PMC)">
<meta name="og:description" content="Enhancers play a crucial role in regulating gene expression and their functional status can be queried with cell type precision using using single-cell (sc)ATAC-seq. To facilitate analysis of such data, we developed Enhlink, a novel computational ...">
<meta name="og:url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC10197707/">
<meta name="og:image" content="https://cdn.ncbi.nlm.nih.gov/pmc/cms/images/pmc-card-share.jpg?_=0">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ncbi">
    
    

    </head>
    <body >
        
    <a class="usa-skipnav " href="#main-content">
      Skip to main content
    </a>


        
            

<section class="usa-banner " aria-label="Official website of the United States government" >
    <div class="usa-accordion">
        <header class="usa-banner__header">
            <div class="usa-banner__inner">
                <div class="grid-col-auto">
                    <img aria-hidden="true"
                         class="usa-banner__header-flag"
                         src="/static/img/us_flag.svg"
                         alt="" />
                </div>

                <div class="grid-col-fill tablet:grid-col-auto" aria-hidden="true">
                    <p class="usa-banner__header-text">
                        An official website of the United States government
                    </p>
                    <span class="usa-banner__header-action">Here's how you know</span>
                </div>

                



















    
        <button
            type="button"
        
    
    class="usa-accordion__button usa-banner__button
           

           
               
               
               
               
            

           
           
           
           "
    aria-expanded="false"
    aria-controls="gov-banner-default"
    
    data-testid="storybook-django-banner"
    
    >
    
        

        
                    <span class="usa-banner__button-text">Here's how you know</span>
                

        
    
        
            </button>
        


            </div>
        </header>

        <div class="usa-banner__content usa-accordion__content"
             id="gov-banner-default"
             hidden>
            <div class="grid-row grid-gap-lg">
                <div class="usa-banner__guidance tablet:grid-col-6">
                    <img class="usa-banner__icon usa-media-block__img"
                         src="/static/img/icon-dot-gov.svg"
                         alt=""
                         aria-hidden="true" />
                    <div class="usa-media-block__body">
                        <p>
                            <strong>Official websites use .gov</strong>
                            <br />
                            A
                            <strong>.gov</strong> website belongs to an official
                            government organization in the United States.
                        </p>
                    </div>
                </div>

                <div class="usa-banner__guidance tablet:grid-col-6">
                    <img class="usa-banner__icon usa-media-block__img"
                         src="/static/img/icon-https.svg"
                         alt=""
                         aria-hidden="true" />

                    <div class="usa-media-block__body">
                        <p>
                            <strong>Secure .gov websites use HTTPS</strong>
                            <br />
                            A <strong>lock</strong> (
                            <span class="icon-lock">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="52"
                                     height="64"
                                     viewBox="0 0 52 64"
                                     class="usa-banner__lock-image"
                                     role="graphics-symbol"
                                     aria-labelledby="banner-lock-description"
                                     focusable="false">
                                    <title id="banner-lock-title">Lock</title>
                                    <desc id="banner-lock-description">
                                    Locked padlock icon
                                    </desc>
                                    <path fill="#000000"
                                          fill-rule="evenodd"
                                          d="M26 0c10.493 0 19 8.507 19 19v9h3a4 4 0 0 1 4 4v28a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V32a4 4 0 0 1 4-4h3v-9C7 8.507 15.507 0 26 0zm0 8c-5.979 0-10.843 4.77-10.996 10.712L15 19v9h22v-9c0-6.075-4.925-11-11-11z" />
                                </svg>
</span>) or <strong>https://</strong> means you've safely
                                connected to the .gov website. Share sensitive
                                information only on official, secure websites.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

        

        
    
    
    

<div class="usa-overlay">
</div>



<header class="usa-header usa-header--extended usa-header--wide" data-header data-testid="header"    >
    <div class="ncbi-header">
        <div class="ncbi-header__container">
            <a class="ncbi-header__logo-container"
               href="https://www.ncbi.nlm.nih.gov/">
                <img alt="NCBI home page"
                     class="ncbi-header__logo-image"
                     src="/static/img/ncbi-logos/nih-nlm-ncbi--white.svg"
                     width="410"
                     height="100" />
            </a>

            <!-- Mobile menu hamburger button -->
            



















    
        <button
            type="button"
        
    
    class="usa-menu-btn ncbi-header__hamburger-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    aria-label="Show menu"
    data-testid="navMenuButton"
    
    >
    
        

        
                <svg aria-hidden="true"
                     class="ncbi-hamburger-icon"
                     fill="none"
                     focusable="false"
                     height="21"
                     viewBox="0 0 31 21"
                     width="31"
                     xmlns="http://www.w3.org/2000/svg">
                    <path clip-rule="evenodd"
                          d="M0.125 20.75H30.875V17.3333H0.125V20.75ZM0.125 12.2083H30.875V8.79167H0.125V12.2083ZM0.125 0.25V3.66667H30.875V0.25H0.125Z"
                          fill="#F1F1F1"
                          fill-rule="evenodd" />
                </svg>
            

        
    
        
            </button>
        



            
                <!-- Desktop buttons-->
                <div class="ncbi-header__desktop-buttons">
                    
                        <!-- Desktop search button -->
                        



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--unstyled ncbi-header__desktop-button
           "
    aria-expanded="false"
    aria-controls="search-field-desktop-navigation"
    aria-label="Show search overlay"
    data-testid="toggleSearchPanelButton"
    data-toggle-search-panel-button
    >
    
        

        
                            



    <svg class="usa-icon " role="graphics-symbol" aria-hidden="true" >
        
        <use xlink:href="/static/img/sprite.svg#search" />
    </svg>


                            Search
                        

        
    
        
            </button>
        


                    

                    <!-- Desktop login dropdown -->
                    
                        <div class="ncbi-header__login-dropdown">
                            



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--unstyled ncbi-header__desktop-button ncbi-header__login-dropdown-button
           "
    aria-expanded="false"
    aria-controls="login-dropdown-menu"
    aria-label="Show login menu"
    data-testid="toggleLoginMenuDropdown"
    data-desktop-login-button
    >
    
        

        
                                



    <svg class="usa-icon " role="graphics-symbol" aria-hidden="true" >
        
        <use xlink:href="/static/img/sprite.svg#person" />
    </svg>



                                <span data-login-dropdown-text>Log in</span>

                                <!-- Dropdown icon pointing up -->
                                



    <svg class="usa-icon ncbi-header__login-dropdown-icon ncbi-header__login-dropdown-icon--expand-less ncbi-header__login-dropdown-icon--hidden" role="graphics-symbol" aria-hidden="true" data-login-dropdown-up-arrow>
        
        <use xlink:href="/static/img/sprite.svg#expand_less" />
    </svg>



                                <!-- Dropdown icon pointing down -->
                                



    <svg class="usa-icon ncbi-header__login-dropdown-icon ncbi-header__login-dropdown-icon--expand-more ncbi-header__login-dropdown-icon--hidden" role="graphics-symbol" aria-hidden="true" data-login-dropdown-down-arrow>
        
        <use xlink:href="/static/img/sprite.svg#expand_more" />
    </svg>


                            

        
    
        
            </button>
        



                            <!-- Login dropdown menu -->
                            <ul class="usa-nav__submenu ncbi-header__login-dropdown-menu"
                                id="login-dropdown-menu"
                                data-desktop-login-menu-dropdown
                                hidden>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/" class="usa-link  "  >
        

        
            Dashboard
        

        
    </a>


                                    </li>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/collections/bibliography/" class="usa-link  "  >
        

        
            Publications
        

        
    </a>


                                    </li>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/account/settings/" class="usa-link  "  >
        

        
            Account settings
        

        
    </a>


                                    </li>
                                
                                <li class="usa-nav__submenu-item">
                                    



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--outline ncbi-header__login-dropdown-logout-button
           "
    
    
    
    data-testid="desktopLogoutButton"
    data-desktop-logout-button
    >
    
        

        Log out

        
    
        
            </button>
        


                                </li>
                            </ul>
                        </div>
                    
                </div>
            
        </div>
    </div>

    <!-- Search panel -->
    
        <div class="ncbi-search-panel ncbi--show-only-at-desktop"
             data-header-search-panel
             hidden>
            <div class="ncbi-search-panel__container">
                <form action="https://www.ncbi.nlm.nih.gov/search/all/"
                      
                      autocomplete="off"
                      class="usa-search usa-search--big ncbi-search-panel__form"
                      data-testid="desktop-navigation-search-form"
                      method="GET"
                      role="search">
                    <label class="usa-sr-only" for="search-field-desktop-navigation">
                        Search…
                    </label>
                    <input class="usa-input"
                           id="search-field-desktop-navigation"
                           name="term"
                           
                               placeholder="Search NCBI"
                           
                           type="search"
                           value="" />
                    



















    
        <button
            type="submit"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    
    
    
    >
    
        

        
                        <span class="usa-search__submit-text">
                            Search NCBI
                        </span>
                    

        
    
        
            </button>
        


                </form>

                
            </div>
        </div>
    

    <nav aria-label="Primary navigation" class="usa-nav">
        <p class="usa-sr-only" id="primary-navigation-sr-only-title">
            Primary site navigation
        </p>

        <!-- Mobile menu close button -->
        



















    
        <button
            type="button"
        
    
    class="usa-nav__close ncbi-nav__close-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    aria-label="Close navigation menu"
    data-testid="navCloseButton"
    
    >
    
        

        
            <img src="/static/img/usa-icons/close.svg" alt="Close" />
        

        
    
        
            </button>
        



        
            <!-- Mobile search component -->
            <form class="usa-search usa-search--small ncbi--hide-at-desktop margin-top-6"
                  action="https://www.ncbi.nlm.nih.gov/search/all/"
                  
                  autocomplete="off"
                  data-testid="mobile-navigation-search-form"
                  method="GET"
                  role="search">
                <label class="usa-sr-only" for="search-field-mobile-navigation">
                    Search
                </label>

                <input class="usa-input"
                       id="search-field-mobile-navigation"
                       type="search"
                       
                           placeholder="Search NCBI"
                       
                       name="term" />

                



















    
        <button
            type="submit"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    
    
    
    >
    
        

        
                    <!-- This SVG should be kept inline and not replaced with a link to the icon as otherwise it will render in the wrong color -->
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0Ij48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTE1LjUgMTRoLS43OWwtLjI4LS4yN0E2LjQ3MSA2LjQ3MSAwIDAgMCAxNiA5LjUgNi41IDYuNSAwIDEgMCA5LjUgMTZjMS42MSAwIDMuMDktLjU5IDQuMjMtMS41N2wuMjcuMjh2Ljc5bDUgNC45OUwyMC40OSAxOWwtNC45OS01em0tNiAwQzcuMDEgMTQgNSAxMS45OSA1IDkuNVM3LjAxIDUgOS41IDUgMTQgNy4wMSAxNCA5LjUgMTEuOTkgMTQgOS41IDE0eiIvPjwvc3ZnPg=="
                         class="usa-search__submit-icon"
                         alt="Search" />
                

        
    
        
            </button>
        


            </form>

            
        

        <!-- Primary navigation menu items -->
        <!-- This usa-nav__inner wrapper is required to correctly style the navigation items on Desktop -->
        

        
            <div class="ncbi-nav__mobile-login-menu ncbi--hide-at-desktop"
                 data-mobile-login-menu
                 hidden>
                <p class="ncbi-nav__mobile-login-menu-status">
                    Logged in as:
                    <strong class="ncbi-nav__mobile-login-menu-email"
                            data-mobile-login-email-text></strong>
                </p>
                <ul class="usa-nav__primary usa-accordion">
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/" class="usa-link  "  >
        

        
            Dashboard
        

        
    </a>


                        </li>
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/collections/bibliography/" class="usa-link  "  >
        

        
            Publications
        

        
    </a>


                        </li>
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/account/settings/" class="usa-link  "  >
        

        
            Account settings
        

        
    </a>


                        </li>
                    
                </ul>
            </div>
        

        



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           ncbi-nav__mobile-login-button ncbi--hide-at-desktop
           "
    
    
    
    data-testid="mobileLoginButton"
    data-mobile-login-button
    >
    
        

        Log in

        
    
        
            </button>
        


    </nav>
</header>

    
    
        

<section class="pmc-header pmc-header--basic" aria-label="PMC Header with search box">
    <div class="pmc-nav-container">
        <div class="pmc-header__bar">
           <div class="pmc-header__logo">
               <a href="/" title="Home" aria-label="PMC Home"></a>
           </div>
            <button
                    type="button"
                    class="usa-button usa-button--unstyled pmc-header__search__button"
                    aria-label="Open search"
                    data-ga-category="search"
                    data-ga-action="PMC"
                    data-ga-label="pmc_search_panel_mobile"
            >
                <svg class="usa-icon width-4 height-4 pmc-icon__open" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#search"></use>
                </svg>
                <svg class="usa-icon width-4 height-4 pmc-icon__close" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#close"></use>
                </svg>
            </button>
        </div>
        <div class="pmc-header__search">
            


<form class="usa-search usa-search--extra usa-search--article-right-column  pmc-header__search__form" id="pmc-search-form" autocomplete="off" role="search">
<label class="usa-sr-only" for="pmc-search">Search PMC Full-Text Archive</label>
<span class="autoComplete_wrapper flex-1">
<input class="usa-input width-full maxw-none" required="required" placeholder="Search PMC Full-Text Archive" id="pmc-search"  type="search" name="term" data-autocomplete-url="https://pmc.ncbi.nlm.nih.gov/autocomp/search/autocomp/"/>
</span>
<button
class="usa-button"
type="submit"
formaction="https://pmc.ncbi.nlm.nih.gov/search/"
data-ga-category="search"
data-ga-action="PMC"
data-ga-label="PMC_search_button"
>
<span class="usa-search__submit-text">Search in PMC</span>
<img
src="/static/img/usa-icons-bg/search--white.svg"
class="usa-search__submit-icon"
alt="Search"
/>
</button>
</form>
            <div class="display-flex flex-column tablet:flex-row tablet:flex-justify flex-justify-center flex-align-center width-full desktop:maxw-44">
                <ul class="pmc-header__search__menu">
                    <li>
                        
                            <a class="usa-link" href="/journals/" data-ga-action="featured_link" data-ga-label="journal list">
                                Journal List
                            </a>
                        
                    </li>
                    <li>
                        
                            <a class="usa-link" href="/about/userguide/" data-ga-action="featured_link"
                            data-ga-label="user guide">
                                User Guide
                            </a>
                        
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>

    


        
        

       
  <div class="usa-section padding-top-0 desktop:padding-top-6 pmc-article-section" data-article-db="pmc" data-article-id="10197707">

    

   



<div class="grid-container pmc-actions-bar" aria-label="Actions bar" role="complementary">
    <div class="grid-row">
        <div class="grid-col-fill display-flex">
             <div class="display-flex">
                <ul class="usa-list usa-list--unstyled usa-list--horizontal">
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex mob">
                        <button
                                type="button"
                                class="usa-button pmc-sidenav__container__open usa-button--unstyled width-auto display-flex"
                                aria-label="Open resources"
                                data-extra-class="is-visible-resources"
                                data-ga-category="resources_accordion"
                                data-ga-action="click"
                                data-ga-label="mobile_icon"
                        >
                            <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                <use xlink:href="/static/img/sprite.svg#more_vert"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex mob">
                        <a
                                href="https://doi.org/10.1101/2023.05.11.540453"
                                class="usa-link display-flex usa-tooltip"
                                role="button"
                                target="_blank"
                                rel="noreferrer noopener"
                                title="View on publisher site"
                                data-position="bottom"
                                aria-label="View on publisher site"
                                data-ga-category="actions"
                                data-ga-action="click"
                                data-ga-label="publisher_link_mobile"
                        >
                                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                    <use xlink:href="/static/img/sprite.svg#launch"></use>
                                </svg>
                        </a>
                    </li>
                    
                    
                        <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                             <a
                                     href="pdf/nihpp-2023.05.11.540453v1.pdf"
                                     class="usa-link display-flex usa-tooltip"
                                     role="button"
                                     title="Download PDF"
                                     data-position="bottom"
                                     aria-label="Download PDF"
                                     data-ga-category="actions"
                                     data-ga-action="click"
                                     data-ga-label="pdf_download_mobile"
                             >
                                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                    <use xlink:href="/static/img/sprite.svg#file_download"></use>
                                </svg>
                            </a>
                        </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                        <button
                            class="usa-button usa-button--unstyled  usa-tooltip collections-dialog-trigger collections-button display-flex collections-button-empty"
                            title="Add to Collections"
                            data-position="bottom"
                            aria-label="Save article in MyNCBI collections."
                            data-ga-category="actions"
                            data-ga-action="click"
                            data-ga-label="collections_button_mobile"
                            data-collections-open-dialog-enabled="false"
                            data-collections-open-dialog-url="https://account.ncbi.nlm.nih.gov/?back_url=https%3A%2F%2Fpmc.ncbi.nlm.nih.gov%2Farticles%2FPMC10197707%2F%23open-collections-dialog"
                            data-in-collections="false"
                        >
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-full" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-full.svg#icon"></use>
                            </svg>
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-empty.svg#icon"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                        <button role="button" class="usa-button usa-button--unstyled usa-tooltip citation-dialog-trigger display-flex"
                            aria-label="Open dialog with citation text in different styles"
                            title="Cite"
                            data-position="bottom"
                            data-ga-category="actions"
                            data-ga-action="open"
                            data-ga-label="cite_mobile"
                            data-all-citations-url="/resources/citations/10197707/"
                            data-citation-style="nlm"
                            data-download-format-link="/resources/citations/10197707/export/"
                        >
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/sprite.svg#format_quote"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="pmc-permalink display-flex" >
                         <button
                                 type="button"
                                 title="Permalink"
                                 data-position="bottom"
                                 class="usa-button usa-button--unstyled display-flex usa-tooltip"
                                 aria-label="Show article permalink"
                                 aria-expanded="false"
                                 aria-haspopup="true"
                                 data-ga-category="actions"
                                 data-ga-action="open"
                                 data-ga-label="permalink_mobile"
                         >
                            <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                <use xlink:href="/static/img/sprite.svg#share"></use>
                            </svg>
                        </button>
                        

<div class="pmc-permalink__dropdown" hidden>
    <div class="pmc-permalink__dropdown__container">
          <h2 class="usa-modal__heading margin-top-0 margin-bottom-2 text-uppercase font-sans-xs">PERMALINK</h2>
          <div class="pmc-permalink__dropdown__content">
              <input type="text" class="usa-input" value="https://pmc.ncbi.nlm.nih.gov/articles/PMC10197707/" aria-label="Article permalink">
              <button class="usa-button display-inline-flex pmc-permalink__dropdown__copy__btn margin-right-0" title="Copy article permalink" data-ga-category="save_share" data-ga-action="link" data-ga-label="copy_link">
                  <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#content_copy"></use>
                  </svg>
                  <span class="margin-left-1">Copy</span>
              </button>
          </div>
    </div>
</div>
                    </li>
                </ul>
            </div>
            <button
                    type="button"
                    class="usa-button pmc-sidenav__container__open usa-button--unstyled width-auto display-flex"
                    aria-label="Open article navigation"
                    data-extra-class="is-visible-in-page"
                    data-ga-category="actions"
                    data-ga-action="open"
                    data-ga-label="article_nav_mobile"
            >
                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#list"></use>
                </svg>
            </button>
        </div>
    </div>
</div>
    <div class="grid-container desktop:padding-left-6">
      <div id="article-container" class="grid-row grid-gap">
        <div class="grid-col-12 desktop:grid-col-8 order-2 pmc-layout__content">
            <div class="grid-container padding-left-0 padding-right-0">
                <div class="grid-row desktop:margin-left-neg-6">
                    <div class="grid-col-12">
                        <div class="pmc-layout__disclaimer" role="complementary" aria-label="Disclaimer note">
    As a library, NLM provides access to scientific literature. Inclusion in an NLM database does not imply endorsement of, or agreement with,
    the contents by NLM or the National Institutes of Health.<br/>
    Learn more:
    <a class="usa-link" data-ga-category="Link click" data-ga-action="Disclaimer" data-ga-label="New disclaimer box" href="/about/disclaimer/">PMC Disclaimer</a>
    |
    <a class="usa-link" data-ga-category="Link click" data-ga-action="PMC Copyright Notice" data-ga-label="New disclaimer box" href="/about/copyright/">
        PMC Copyright Notice
    </a>
</div>
                    </div>
                </div>
                <div class="grid-row pmc-wm desktop:margin-left-neg-6">
                    <!-- Main content -->
                    <main
                      id="main-content"
                      class="usa-layout-docs__main usa-layout-docs grid-col-12 pmc-layout pmc-prose padding-0"
                    >

                      
                        <div class="usa-alert usa-alert--info" role="status"><div class="usa-alert__body">
<h4 class="usa-alert__heading">This is a preprint.</h4>
<p class="usa-alert__text"><strong>It has not yet been peer reviewed by a journal.</strong></p>
<p class="usa-alert__text">The National Library of Medicine is <a href="/about/nihpreprints/" class="usa-link">running a pilot</a> to include preprints that result from research funded by NIH in PMC and PubMed.</p>
</div></div><section class="pmc-journal-banner text-center line-height-none" aria-label="Journal banner"><img src="https://cdn.ncbi.nlm.nih.gov/pmc/banners/logo-preprints.png" alt="bioRxiv logo" usemap="#pmc-banner-imagemap" width="500" height="75"><map name="pmc-banner-imagemap"><area alt="Link to bioRxiv" title="Link to bioRxiv" shape="default" href="https://pmc.ncbi.nlm.nih.gov/about/nihpreprints/" target="_blank" rel="noopener noreferrer"></map></section><article lang="en"><section aria-label="Article citation and metadata"><section class="pmc-layout__citation font-secondary font-xs"><div>
<div class="display-inline-block"><button type="button" class="cursor-pointer text-no-underline bg-transparent border-0 padding-0 text-left margin-0 text-normal text-primary" aria-controls="journal_context_menu">bioRxiv</button></div> [Preprint]. 2023 May 11:2023.05.11.540453. [Version 1] doi: <a href="https://doi.org/10.1101/2023.05.11.540453" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">10.1101/2023.05.11.540453</a>
</div>
<nav id="journal_context_menu" hidden="hidden"><ul class="menu-list font-family-ui" role="menu">
<li role="presentation"><a href="https://pmc.ncbi.nlm.nih.gov/search/?term=%22bioRxiv%22%5Bjour%5D" class="usa-link" role="menuitem">Search in PMC</a></li>
<li role="presentation"><a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22bioRxiv%22%5Bjour%5D" lang="en" class="usa-link" role="menuitem">Search in PubMed</a></li>
<li role="presentation"><a href="https://www.ncbi.nlm.nih.gov/nlmcatalog?term=%22bioRxiv%22%5BTitle%20Abbreviation%5D" class="usa-link" role="menuitem">View in NLM Catalog</a></li>
<li role="presentation"><a href="?term=%22bioRxiv%22%5Bjour%5D" class="usa-link" role="menuitem" data-add-to-search="true">Add to search</a></li>
</ul></nav></section><section class="front-matter"><div class="ameta p font-secondary font-xs">
<hgroup><h1>Enhlink infers distal and context-specific enhancer-promoter linkages</h1></hgroup><div class="cg p">
<a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Poirion%20OB%22%5BAuthor%5D" class="usa-link" aria-describedby="id1"><span class="name western">Olivier B Poirion</span></a><div hidden="hidden" id="id1">
<h3><span class="name western">Olivier B Poirion</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Poirion%20OB%22%5BAuthor%5D" class="usa-link"><span class="name western">Olivier B Poirion</span></a>
</div>
</div>
<sup>1,</sup><sup>*</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Zuo%20W%22%5BAuthor%5D" class="usa-link" aria-describedby="id2"><span class="name western">Wulin Zuo</span></a><div hidden="hidden" id="id2">
<h3><span class="name western">Wulin Zuo</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Zuo%20W%22%5BAuthor%5D" class="usa-link"><span class="name western">Wulin Zuo</span></a>
</div>
</div>
<sup>1</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Spruce%20C%22%5BAuthor%5D" class="usa-link" aria-describedby="id3"><span class="name western">Catrina Spruce</span></a><div hidden="hidden" id="id3">
<h3><span class="name western">Catrina Spruce</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Spruce%20C%22%5BAuthor%5D" class="usa-link"><span class="name western">Catrina Spruce</span></a>
</div>
</div>
<sup>1</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Daigle%20SL%22%5BAuthor%5D" class="usa-link" aria-describedby="id4"><span class="name western">Sandra L Daigle</span></a><div hidden="hidden" id="id4">
<h3><span class="name western">Sandra L Daigle</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Daigle%20SL%22%5BAuthor%5D" class="usa-link"><span class="name western">Sandra L Daigle</span></a>
</div>
</div>
<sup>1</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Olson%20A%22%5BAuthor%5D" class="usa-link" aria-describedby="id5"><span class="name western">Ashley Olson</span></a><div hidden="hidden" id="id5">
<h3><span class="name western">Ashley Olson</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">
<sup>2</sup>Center for Systems Neurogenetics of Addiction at The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Olson%20A%22%5BAuthor%5D" class="usa-link"><span class="name western">Ashley Olson</span></a>
</div>
</div>
<sup>1,</sup><sup>2</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Skelly%20DA%22%5BAuthor%5D" class="usa-link" aria-describedby="id6"><span class="name western">Daniel A Skelly</span></a><div hidden="hidden" id="id6">
<h3><span class="name western">Daniel A Skelly</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Skelly%20DA%22%5BAuthor%5D" class="usa-link"><span class="name western">Daniel A Skelly</span></a>
</div>
</div>
<sup>1</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Chesler%20EJ%22%5BAuthor%5D" class="usa-link" aria-describedby="id7"><span class="name western">Elissa J Chesler</span></a><div hidden="hidden" id="id7">
<h3><span class="name western">Elissa J Chesler</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">
<sup>2</sup>Center for Systems Neurogenetics of Addiction at The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Chesler%20EJ%22%5BAuthor%5D" class="usa-link"><span class="name western">Elissa J Chesler</span></a>
</div>
</div>
<sup>1,</sup><sup>2</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Baker%20CL%22%5BAuthor%5D" class="usa-link" aria-describedby="id8"><span class="name western">Christopher L Baker</span></a><div hidden="hidden" id="id8">
<h3><span class="name western">Christopher L Baker</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">
<sup>2</sup>Center for Systems Neurogenetics of Addiction at The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Baker%20CL%22%5BAuthor%5D" class="usa-link"><span class="name western">Christopher L Baker</span></a>
</div>
</div>
<sup>1,</sup><sup>2,</sup><sup>†</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22White%20BS%22%5BAuthor%5D" class="usa-link" aria-describedby="id9"><span class="name western">Brian S White</span></a><div hidden="hidden" id="id9">
<h3><span class="name western">Brian S White</span></h3>
<div class="p">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22White%20BS%22%5BAuthor%5D" class="usa-link"><span class="name western">Brian S White</span></a>
</div>
</div>
<sup>1,</sup><sup>†</sup>
</div>
<ul class="d-buttons inline-list">
<li><button class="d-button" aria-controls="aip_a" aria-expanded="false">Author information</button></li>
<li><button class="d-button" aria-controls="clp_a" aria-expanded="false">Copyright and License information</button></li>
</ul>
<div class="d-panels font-secondary-light">
<div id="aip_a" class="d-panel p" style="display: none">
<div class="p" id="A1">
<sup>1</sup>The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div id="A2">
<sup>2</sup>Center for Systems Neurogenetics of Addiction at The Jackson Laboratory, Bar Harbor, ME, USA</div>
<div class="author-notes p">
<div class="fn" id="FN1">
<p id="P1">Author contributions</p>
<p id="P2">OP and BSW envisioned this project. OP developed Enhlink and implemented the project. OP, WZ, DS, and CLB conducted the analyses. CLB performed the eQTL analysis. OP, BSW, and CLB wrote the manuscript with inputs from all authors. EJC supervised the eQTL collection analysis. CLB supervised the striatum tissue collection and experimental design. CS and AO performed the tissue collection. SD performed the single-cell multiome experiment.</p>
</div>
<div class="fn" id="FN3">
<sup>†</sup><p class="display-inline" id="P3">These authors contributed equally to this work</p>
</div>
<div class="fn" id="CR1">
<sup>*</sup><p class="display-inline">Corresponding author</p>
</div>
</div>
</div>
<div id="clp_a" class="d-panel p" style="display: none">
<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>, which allows reusers to copy and distribute the material in any medium or format in unadapted form only, for noncommercial purposes only, and only so long as attribution is given to the creator.</p>
<div class="p"><a href="/about/copyright/" class="usa-link">PMC Copyright notice</a></div>
</div>
</div>
<div>PMCID: PMC10197707  PMID: <a href="https://pubmed.ncbi.nlm.nih.gov/37214950/" class="usa-link">37214950</a>
</div>
<div class="ra xbox p" role="complementary" aria-label="Related or updated information about this article">
<div>
<strong>Updated version available:</strong> A peer-reviewed version of this article, "<a href="/articles/PMC11368035/" class="usa-link">Enhlink infers distal and context-specific enhancer–promoter linkages</a>", has been published in <em>Genome Biology</em>.</div>
<div>The complete version history of this preprint is available at <a href="https://doi.org/10.1101/2023.05.11.540453" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">bioRxiv</a>.</div>
</div>
</div></section></section><section aria-label="Article content"><section class="body main-article-body"><section class="abstract" id="ABS1"><h2>Abstract</h2>
<p id="P4">Enhancers play a crucial role in regulating gene expression and their functional status can be queried with cell type precision using using single-cell (sc)ATAC-seq. To facilitate analysis of such data, we developed Enhlink, a novel computational approach that leverages single-cell signals to infer linkages between regulatory DNA sequences, such as enhancers and promoters. Enhlink uses an ensemble strategy that integrates cell-level technical covariates to control for batch effects and biological covariates to infer robust condition-specific links and their associated <em>p</em>-values. It can integrate simultaneous gene expression and chromatin accessibility measurements of individual cells profiled by multi-omic experiments for increased specificity. We evaluated Enhlink using simulated and real scATAC-seq data, including those paired with physical enhancer-promoter links enumerated by promoter capture Hi-C and with multi-omic scATAC-/RNA-seq data we generated from the mouse striatum. These examples demonstrated that our method outperforms popular alternative strategies. In conjunction with eQTL analysis, Enhlink revealed a putative super-enhancer regulating key cell type-specific markers of striatal neurons. Taken together, our analyses demonstrate that Enhlink is accurate, powerful, and provides features that can lead to novel biological insights.</p></section><section id="S1"><h2 class="pmc_sec_title">Introduction</h2>
<p id="P5">Gene transcription is regulated by non-coding DNA elements, called enhancers. Each consists of dense clusters of recognition motifs for sequence- and cell type-specific transcription factors (TFs), which bind and subsequently recruit coregulators, chromatin remodelers and modifiers, and RNA polymerase II (<a href="#R28" class="usa-link" aria-describedby="R28">Panigrahi and O’Malley, 2021</a>). A single gene can be regulated by multiple enhancers, with the cell type-specific activity of its enhancers conferring spatiotemporal control over it (<a href="#R16" class="usa-link" aria-describedby="R16">Heinz <em>et al</em>., 2015</a>; <a href="#R33" class="usa-link" aria-describedby="R33">Robson, Ringel and Mundlos, 2019</a>). Enhancer disruption and its concomitant modulation of target gene expression are increasingly recognized as disease-causing mechanisms (<a href="#R6" class="usa-link" aria-describedby="R6">Corradin and Scacheri, 2014</a>; <a href="#R5" class="usa-link" aria-describedby="R5">Claringbould and Zaugg, 2021</a>). In complex diseases, &gt;90% of single nucleotide polymorphisms (SNPs) identified by genome-wide association studies (GWAS) are in non-coding regions of the genome far from promoters and potentially within enhancers (<a href="#R5" class="usa-link" aria-describedby="R5">Claringbould and Zaugg, 2021</a>). The link between an enhancer and its target gene (or, equivalently, promoter) needs to be established, and is an ongoing challenge in the field.</p>
<p id="P6">Enhancer-promoter links can be directly detected with experimental techniques including Hi-C, (<a href="#R21" class="usa-link" aria-describedby="R21">Lieberman-Aiden <em>et al</em>., 2009</a>) (<a href="#R36" class="usa-link" aria-describedby="R36">Schoenfelder <em>et al</em>., 2018</a>). However, complex protocols, high cost, low resolution (<a href="#R10" class="usa-link" aria-describedby="R10">Galitsyna and Gelfand, 2021</a>) and their inability to detect interchromosomal interactions (<a href="#R28" class="usa-link" aria-describedby="R28">Panigrahi and O’Malley, 2021</a>) currently limit their applications.</p>
<p id="P7">As an alternative, Pliner and colleagues demonstrated how links can be inferred <em>computationally</em> by exploiting measurements of chromatin accessibility from single-cell ATAC-seq (scATAC-seq) data at a gene’s promoter and its active enhancers during transcription. The authors first inferred open chromatin regions (OCRs) from “peaks” of reads in scATAC-seq data, and applied a computational method, Cicero, to identify enhancer-promoter pairs with correlated peaks of chromatin accessibility (<a href="#R30" class="usa-link" aria-describedby="R30">Pliner <em>et al</em>., 2018</a>). Cicero handles the sparsity of scATAC-seq data by aggregating binary accessibility data from similar cells into counts, with related cells determined through similarities in a low-dimensional embedding. It reduces batch effects, principally arising from library size, by adjusting aggregated counts. Finally, it addresses the high dimension inherent in genome-wide discovery by inferring regularized covariance matrices describing accessibility peaks.</p>
<p id="P8">Following Cicero’s pioneering approach, linkage inference from scATAC-seq has become a popular strategy in various exploratory (<a href="#R41" class="usa-link" aria-describedby="R41">Wang <em>et al</em>., 2020</a>; ‘<a href="#R1" class="usa-link" aria-describedby="R1">A multimodal cell census and atlas of the mammalian primary motor cortex’, 2021</a>)(<a href="#R23" class="usa-link" aria-describedby="R23">Li <em>et al</em>., 2021</a>) and methodological studies (<a href="#R18" class="usa-link" aria-describedby="R18">Kamimoto, Hoffmann and Morris, 2020</a>). Several other recent methods can also be used to infer enhancer-gene links from scATAC-seq data. Signac (<a href="#R38" class="usa-link" aria-describedby="R38">Stuart <em>et al</em>., 2021</a>), ArchR (<a href="#R13" class="usa-link" aria-describedby="R13">Granja <em>et al</em>., 2021</a>), and SnapATAC (<a href="#R9" class="usa-link" aria-describedby="R9">Fang <em>et al</em>., 2021</a>) are comprehensive toolkits for scATAC-seq analysis that include linkage inference methods. ArchR computes the Pearson correlation between accessible regions represented in a low-dimensional embedding of aggregated cells and derives a <em>p</em>-value from it. Signac also computes Pearson correlation <em>p</em>-values, but instead does so using a random background of enhancers. Finally, SnapATAC fits univariate logistic regression models to chromatin accessibility using gene expression as features. SnapATAC and Signac are designed to associate enhancer accessibilities with gene expression from either a multi-omic dataset or a matching scRNA-seq dataset which is combined with the scATAC-seq using a label transfer procedure (<a href="#R9" class="usa-link" aria-describedby="R9">Fang <em>et al</em>., 2021</a>). In contrast, ArchR has the ability to process scATAC-seq alone or in combination with scRNA-seq. To summarize, these approaches leverage correlations between enhancers and promoter accessibility or gene expression at the single-cell level to deduce enhancer-gene links.</p>
<p id="P9">However, single-cell experiments have continued to grow in size and complexity since these methods were developed, leading to exquisite contextual specificity for inference on enhancer-promoter interactions, but also producing additional difficulties that are not adequately addressed by existing computational methods. For example, our recent murine study made use of a factorial and hierarchical experimental design to characterize the contribution of genetics, sex, and diet to cellular heterogeneity in two metabolism-related tissues (<a href="#R49" class="usa-link" aria-describedby="R49">Poirion <em>et al</em>., 2023</a>), by performing large-scale, single-cell sequencing across technical batches. Existing methods can not directly model the impact of biological covariates, nor can cell-binning approaches control for technical covariates that differ across cells <em>within</em> a bin.</p>
<p id="P10">To address the challenges of studies with complex experimental designs, we developed Enhlink, a novel approach for inferring enhancer-promoter co-accessibility. It detects biological effects and controls technical effects by incorporating appropriate covariates into a nonlinear modeling framework involving single cells, rather than aggregates. It selects a parsimonious set of enhancers associated with a promoter to smooth the sparse representation of any individual enhancer while prioritizing those with the largest effect. To do so, Enhlink uses a random forest-like approach, where cell-level (binary) accessibilities of enhancers and biological and technical factors are features and the cell-level accessibility of a promoter is the response variable. If multi-omic chromatin accessibility and gene expression measurements are simultaneously available for each cell, Enhlink can further prioritize enhancers by associating them with the expression of the promoter’s target gene. Unlike existing methods, Enhlink has the ability to predict both proximal and distal enhancer-gene linkages and identify linkage specific to biological covariates, while also integrating a simulation workflow that utilizes experimentally validated enhancer-promoter signals to optionally estimate prediction accuracy.</p>
<p id="P11">Using simulation parameterized by experimentally-validated enhancer-promoter pairs, we show that Enhlink minimizes false positives and negatives relative to other approaches. We further demonstrate that Enhlink results are resilient to technical batches in our T2D study and that it has superior precision evaluated using enhancer-promoter interactions detected from paired promoter capture (PC)Hi-C data. Finally, we generated a multi-ome single-nuclei (sn)ATAC- and RNA-seq dataset from a study of sex and strain differences in the mouse striatum, a brain region involved in motivated learning and associated with acute and chronic effects of drug addiction (<a href="#R24" class="usa-link" aria-describedby="R24">Lobo and Nestler, 2011</a>; <a href="#R45" class="usa-link" aria-describedby="R45">Yager <em>et al</em>., 2015</a>). After identifying the two main neuron populations defined by their expression of dopamine receptor 1 (<em>Drd1</em>) or 2 (<em>Drd2</em>), we inferred neuron-specific enhancer-promoter links using both promoter accessibility and gene expression. We identified strong putative <em>cis</em> and <em>trans</em> regulatory regions amongst the two classes of neurons that we also intersected with a set of genetic variants. Notably, we identified several enhancers 500kb downstream of the <em>Drd1</em> promoter that were directly correlated with the regulation of multiple distal genes involved in the Drd1/Drd2 genetic program and may act as a super-enhancer. Enhlink should similarly enable discovery of enhancer-promoter co-accessibility in other complex scATAC-seq and multi-omic snATAC/snRNA-seq datasets.</p>
<section id="S2"><h3 class="pmc_sec_title">Inferring biologically meaningful co-accessibilities from sc/snATAC-seq data</h3>
<p id="P12">To assess enhancer-promoter co-accessibility inference from snATAC-seq data, we used the results of a previously published human heart study that generated snATAC-seq data and experimentally validated enhancer-promoter pairs (<a href="#R17" class="usa-link" aria-describedby="R17">Hocker <em>et al</em>., 2021</a>). We focused on the <em>KCNH2</em> promoter, for which the study identified an enhancer with a nearby risk variant (rs7789146) (<a href="#F1" class="usa-link">Figure 1A</a>) linked to atrial fibrillation. That study validated the role of this variant on enhancer function via CRISPR-Cas9 genome editing of a human pluripotent stem cell-derived cardiomyocyte (CM) cell line (<a href="#R17" class="usa-link" aria-describedby="R17">Hocker <em>et al</em>., 2021</a>). Here, we determined whether the accessibilities of the rs7789146 enhancer and <em>KCNH2</em> promoter correlated across cells, by representing each as a Boolean vector whose entries reflect whether at least one snATAC-seq read was present within the respective region and cell. We then computed the accuracy, recall, and f1-score between the promoter and the enhancer vectors, separately for atrial (aCM) and ventricular (vCM) cardiomyocytes, and compared them to null score distributions (<a href="#F1" class="usa-link">Figures 1B</a> and <a href="#SD4" class="usa-link">S1</a>; see <a href="#S12" class="usa-link">Methods</a>). We expanded this analysis to the promoter of <em>MYL2</em> and three of its putative enhancers, also highlighted by the original study (<a href="#R17" class="usa-link" aria-describedby="R17">Hocker <em>et al</em>., 2021</a>) (<a href="#SD4" class="usa-link">Figure S1</a>). In all cases, the f1-score and recall values were significantly higher than random (<em>p</em> &lt; 0.05; <a href="#F1" class="usa-link">Figures 1B</a> and <a href="#SD4" class="usa-link">S1</a>). These results further justify computational methods that infer enhancer-promoter links from their co-accessibility in snATAC-seq data, while the enhancers associated with the <em>KCNH2</em> and <em>MYL2</em> promoters provide a means of evaluating such methods.</p>
<figure class="fig xbox font-sm" id="F1"><h4 class="obj_head">Figure 1.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=10197707_nihpp-2023.05.11.540453v1-f0001.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/25ec/10197707/64944ff188d6/nihpp-2023.05.11.540453v1-f0001.jpg" loading="lazy" height="565" width="756" alt="Figure 1"></a></p>
<div class="p text-right font-secondary"><a href="figure/F1/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p id="P85">Enhlink infers linkage by modeling covariates, clusters and the surrounding enhancers. <strong>A</strong> Chromatin accessibility tracks with enhancer-promoter co-accessibility links inferred with Enhlink from human atrial (aCM) and ventricular (vCM) cardiomyocytes. The enhancer highlighted in blue was previously experimentally validated. <strong>B</strong> Accuracy scores computed from validated vCM enhancer/promoter pair for the promoter of <em>KCNH2</em> using scATAC-seq data and compared to their random score distribution. <strong>C</strong> Enhlink models a target region as a function of its surrounding genomic regions (i.e., enhancers) and biological and technical covariates. Artificial regions are added to reach a sufficient number of variables for computing feature scores and <em>p</em>-values. Enhlink can optionally perform a second-order analysis to identify covariates associated with links. <strong>D</strong> Enhlink can leverage multi-omics datasets by modelling a target region by either its accessibility or its expression and by intersecting the two resulting sets to identify links shared across both modalities. <strong>E</strong> Processing time for detecting associations (scenario I) for 200 promoters and their cis (+/− 250kb) OCR features from the islet dataset using four processes and (scenario II) between one promoter and 260,344 <em>cis</em> and <em>trans</em> OCR features using one process. Processing time (left axis for I and right for II) as a function of number of threads per process (bottom axis for I and top for II).</p></figcaption></figure></section><section id="S3"><h3 class="pmc_sec_title">Multi-omic inference of condition-specific enhancer-promoter links with Enhlink</h3>
<p id="P13">Enhlink is a new approach that has been designed as an efficient computational framework for inferring co-accessibilities between OCRs, such as enhancers and promoters, from snATAC-seq data that are robust to technical batch effects. Enhlink parsimoniously identifies enhancer-promoter links across genome-wide candidates and can further prioritize associations that are supported by paired (multi-omic) expression data, where available (<a href="#F1" class="usa-link">Figures 1C</a> and <a href="#SD5" class="usa-link">S2</a>). Enlink identifies OCRs and biological factors that “explain” a promoter, independent of technical factors (see <a href="#S12" class="usa-link">Methods</a>). It does so by using single-cell representations of features – promoters, enhancers, and biological and technical factors – where each is a binary vector with an element corresponding to the accessibility (or factor label) of each cell. The candidate set of enhancers may be limited to a genomic range surrounding the promoter (+/− 250kb, by default), to approximate the promoter’s topologically associating domain (TAD) – i.e., a three-dimensional subregion of the genome that sequesters self-interacting regions (<a href="#R26" class="usa-link" aria-describedby="R26">McArthur and Capra, 2021</a>), or may include all peaks genome-wide to model distal (<a href="#R28" class="usa-link" aria-describedby="R28">Panigrahi and O’Malley, 2021</a>) and indirect links. Biological and technical factors such as batch, lineage, and genotype, and categorical factors can be represented in full generality through “one-hot encoding.” Enhlink uses a binary decision tree to iteratively select features that maximize a modified information gain (see <a href="#S12" class="usa-link">Methods</a>). It computes an ensemble of such trees, bootstrapping the cells and selecting a random subset of features in each tree, in a manner similar to random forests. Bootstrapping accounts for heterogeneity across datasets and enables calculation of <em>p</em>-values for each enhancer or biological factor. The depth of each tree is controlled by an intuitive hyperparameter, which effectively sets the expected number of enhancers per promoter (four, by default). This depth and random feature subsetting prioritize a reduced set of enhancers (or biological factors) having the strongest, independent association with the promoter.</p>
<p id="P14">Enhlink can further prioritize these snATAC-seq-derived enhancers by integrating mRNA measurements simultaneously assayed along with chromatin accessibility on each cell (<a href="#R40" class="usa-link" aria-describedby="R40">Vandereyken <em>et al</em>., 2023</a>). When such data are available, Enhlink identifies enhancers using both the promoter accessibility profiles and their associated gene expressions. By retaining enhancers that are concordant in both modalities, Enhlink enhances the likelihood of association between the identified enhancers and their target genes (<a href="#F1" class="usa-link">Figure 1D</a>). Enhlink then refines the snATAC-seq-derived set of promoter-associated enhancers by intersecting them with those derived from snRNA-seq.</p>
<p id="P15">Finally, Enhlink can identify enhancers active in a context-specific manner, e.g., those associated with a promoter in a specific biological condition or those cooperating with another promoter-linked enhancer. This is done via a second-order analysis in which the intersection (i.e., product of binary vectors) of a promoter and a biological factor (in the first case) or of a promoter and enhancer (in the second) are substituted for the accessibility profile of a promoter in the above framework (<a href="#F1" class="usa-link">Figure 1C</a>).</p></section><section id="S4"><h3 class="pmc_sec_title">Enhlink implementation and speed</h3>
<p id="P16">Enhlink achieves its computational efficiency through its implementation in Go (<a href="https://go.dev/" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://go.dev/</a>), a programming language optimized for CPU and memory usage (<a href="#R8" class="usa-link" aria-describedby="R8">Dymora and Paszkiewicz, 2020</a>). It computes each decision tree within a distinct thread, allowing computational speed to scale with the number of threads used (<a href="#F1" class="usa-link">Figure 1E</a>). Additionally, it can distribute the computation of a set of promoters or a grid of hyperparameters over multiple “processes”, improving the computational time while preserving the amount of memory needed on High-Performance Computing (HPC) clusters. Enhlink processed 200 promoters over 100,720 cells in 55 seconds using ten threads in each of four processes on a cluster of 52 CPUs and in 167 seconds with two threads in each of four processes (<a href="#F1" class="usa-link">Figure 1E</a>). Analysis of a single promoter using all 295,089 genome-wide peaks took approximately 700 seconds (<a href="#F1" class="usa-link">Figure 1E</a>). These processing times could have been further reduced with little impact on performance by randomly downsampling cells or peaks (see results section below). Memory usage only increased marginally with the number of threads and processes. Overall, Enhlink’s execution time for each promoter is linearly proportional to the number of trees in the ensemble, the number of enhancer peaks considered as features, and the number of cells, while it is exponentially dependent on the depth of each tree, and inversely proportional to the total number of threads used (across all processes). Enhlink takes as input sparse matrices in an MTX format compatible with Cell Ranger and easily generated from Python R workflows. Enhlink open-source code is freely available and accompanied by in-depth tutorials (<a href="https://gitlab.com/Grouumf/enhlinktools" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://gitlab.com/Grouumf/enhlinktools</a>).</p></section><section id="S5"><h3 class="pmc_sec_title">Estimating accuracy and power analysis from simulated data</h3>
<p id="P17">Inspired by the signal detected from snATAC-seq data for observed enhancer-promoter interactions (<a href="#F1" class="usa-link">Figure 1B</a>), we designed a strategy to simulate enhancer-promoter co-accessibilities with characteristics similar to those previously validated or well characterized. Briefly, we simulated a promoter accessibility vector by randomly shuffling one of the <em>MYL2</em> or <em>KCNH2</em> promoters observed within vCMs or aCMs and described above. We then simulated enhancer vectors by introducing random noise into the simulated promoter vector (<a href="#F2" class="usa-link">Figure 2A</a>). To model noise in the simulated enhancers, we defined the probability of a cell having a read at the promoter and not at the enhancer (λ<sub>close</sub>) or, conversely, at the enhancer and not at the promoter (λ<sub>open</sub>; see <a href="#S12" class="usa-link">Methods</a>). We estimated λ<sub>close</sub> and λ<sub>open</sub> from the observed, cell type-specific <em>MYL2</em> and <em>KCNH2</em> enhancers and found similar values for λ<sub>close</sub> (1.9 +/− 0.2) and λ<sub>open</sub> (0.08 +/− 0.3) (<a href="#F2" class="usa-link">Figure 2B</a>). We extended this analysis using all the cells and found slightly higher λ<sub>close</sub> (2.0 +/− 0.2) and lower λ<sub>open</sub> (0.02 +/−0.05) values. We then estimated Enhlink precision, recall, and f1-score using the simulated enhancer-promoter associations as ground truth. Simulation across three datasets, for a large number of promoters, and with multiple λ<sub>close</sub> and λ<sub>open</sub> parameters (see <a href="#S12" class="usa-link">Methods</a>) highlighted that accuracy was mostly dependent on average promoter accessibility across cells and number of cells in the dataset (<a href="#F2" class="usa-link">Figures 2C</a> and <a href="#SD6" class="usa-link">S3</a>). Most importantly, it underscored the very high accuracy of Enhlink (f1-score &gt; 0.8) when enough cells were used (&gt; 5000) or when a promoter was widely accessible (average accessibility &gt; 0.2; <a href="#F2" class="usa-link">Figure 2C</a>).</p>
<figure class="fig xbox font-sm" id="F2"><h4 class="obj_head">Figure 2.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=10197707_nihpp-2023.05.11.540453v1-f0002.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/25ec/10197707/e438a035fa58/nihpp-2023.05.11.540453v1-f0002.jpg" loading="lazy" height="608" width="768" alt="Figure 2"></a></p>
<div class="p text-right font-secondary"><a href="figure/F2/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p id="P86">Empirically-parameterized simulation demonstrates Enhlink’s high accuracy. <strong>A</strong> Workflow to simulate promoter-enhancer associations parameterized by experimental data. The accessibilities of a promoter and its associated enhancers across cells are simulated from a single promoter-enhancer pair having a validated association. The simulated promoter accessibilities are derived by randomly shuffling the binary, scATAC-seq-derived accessibilities of the validated promoter across cells. Each simulated enhancer accessibility for a given cell is generated from the simulated promoter accessibility for that cell via a process that probabilistically flips the cell’s chromatin state: from closed to open (parameterized by λ<sub>open</sub>) or from open to closed (λ<sub>close</sub>). λ<sub>open</sub> and λ<sub>close</sub> are determined from the validated promoter-enhancer pair. The simulated enhancers are then integrated with the surrounding regions used as background. <strong>B</strong> λ<sub>open</sub> and λ<sub>close</sub> distribution parameters inferred from chromatin accessibility of enhancer-promoter pairs previously validated in human scATAC-seq cardiomyocyte cells (<a href="#R17" class="usa-link" aria-describedby="R17">Hocker et. al 2021</a>). Pairs involve the promoter <em>KCNH2</em> or <em>MYL2</em> as determined in all cells or in the subset of aCM or vCM cells. <strong>C</strong> f1-score (y axis) of simulated promoter-enhancer pairs as a function of average promoter accessibility and number of cells. Error bars summarize 20 simulated promoters. Each simulated promoter has between two and seven associated simulated enhancers.</p></figcaption></figure></section><section id="S6"><h3 class="pmc_sec_title">Enhlink outperforms other methods on simulated datasets</h3>
<p id="P18">We compared Enhlink performance with that of other popular co-accessibility approaches implemented in Cicero (<a href="#R30" class="usa-link" aria-describedby="R30">Pliner <em>et al</em>., 2018</a>; <a href="#R9" class="usa-link" aria-describedby="R9">Fang <em>et al</em>., 2021</a>), SnapATAC (<a href="#R9" class="usa-link" aria-describedby="R9">Fang <em>et al</em>., 2021</a>), Signac (<a href="#R38" class="usa-link" aria-describedby="R38">Stuart <em>et al</em>., 2021</a>), and ArchR (<a href="#R13" class="usa-link" aria-describedby="R13">Granja <em>et al</em>., 2021</a>) (<a href="#F3" class="usa-link">Figure 3A</a>). We also performed a contingency table analysis relating a promoter and enhancer (Chi2) and, optionally, corrected the resulting <em>p</em>-value for genome-wide multiple hypothesis testing using the method of Benjamini and Hochberg (<a href="#R42" class="usa-link" aria-describedby="R42"><em>Website</em>, no date a</a>) (Chi2+FDR). Cicero and the Chi2 approaches are applicable to snATAC-seq data only, while SnapATAC (<a href="#R9" class="usa-link" aria-describedby="R9">Fang <em>et al</em>., 2021</a>) and Signac (<a href="#R9" class="usa-link" aria-describedby="R9">Fang <em>et al</em>., 2021</a>; <a href="#R38" class="usa-link" aria-describedby="R38">Stuart <em>et al</em>., 2021</a>) were applied to correlate enhancers with gene expression. ArchR was applied to both snATAC-seq data only and to correlate genes (continuous values) with enhancers (binary). We simulated one dataset of promoter and associated enhancer accessibilities, using the framework described above, and a second dataset of gene expression and associated enhancer accessibilities, using a similar framework (see <a href="#S12" class="usa-link">Methods</a>). Both datasets were derived from cell type (i.e., aCM or vCM)-specific λ<sub>close</sub> and λ<sub>open</sub> parameters and, thus, effectively simulate cells of a single cell type. We applied each method to the same set of query promoters and enhancers (see <a href="#S12" class="usa-link">Methods</a>). Enhlink outperformed other methods in terms of f1-score and precision computed for each gene/promoter (<a href="#F3" class="usa-link">Figures 3B</a>–<a href="#F3" class="usa-link">C</a>), with Chi2+FDR and Cicero (with a score cutoff of 0.2) matching Enhlink performance only for more accessible promoters (average accessibility &gt; 0.025; <a href="#F3" class="usa-link">Figure 3D</a>). In the experiment with simulated gene expression, Enhlink performance (f1-scores ~ 0.88) greatly exceeded those of Signac and SnapATAC (f1-scores ~ 0.50) (<a href="#F3" class="usa-link">Figure 3E</a>). We considered modifications to ArchR, including changing parameters for the embedding step and replacing its <em>p</em>-value calculation with the one used by Signac. The results showed that using fewer neighbors (see <a href="#S12" class="usa-link">Methods</a>) increased the accuracy of ArchR with simulated genes (<a href="#SD7" class="usa-link">Figure S4</a>), and suggested that the first embedding step of ArchR was actually detrimental to its accuracy.</p>
<figure class="fig xbox font-sm" id="F3"><h4 class="obj_head">Figure 3.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=10197707_nihpp-2023.05.11.540453v1-f0003.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/25ec/10197707/21266ec98d3c/nihpp-2023.05.11.540453v1-f0003.jpg" loading="lazy" height="755" width="642" alt="Figure 3"></a></p>
<div class="p text-right font-secondary"><a href="figure/F3/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p id="P87">Enhlink outperforms other strategies for inferring linkage on simulated data. <strong>A</strong> Summary of existing enhancer-promoter method workflows. Some methods use scATAC-seq only as input (Cicero, Chi2 + FDR), others use scATAC-seq combined with scRNA-seq (Signac, SnapATAC). ArchR has a mechanism for both cases. <strong>B</strong> Enhlink outperforms ATAC-only methods on 400 simulated promoters and 1800 simulated enhancers generated from scATAC-seq data. The scores are computed from the average performance from each simulated promoter (see <a href="#S12" class="usa-link">Methods</a>). <strong>C</strong> Enhlink outperforms other ATAC-only methods independently of the promoter accessibility. Accuracy is dependent on the promoter accessibility (x axis) with more accessible promoters leading to better f1-scores. <strong>D</strong> Enhlink outperforms ATAC + RNA methods on 897 simulated genes and 4090 simulated enhancers inferred from the multiome snRNA-/snATAC-seq data. <strong>E</strong> Enhlink outperforms other ATAC + RNA methods across average gene expression values. Accuracy is dependent on the gene expression (x axis) with more expressed genes leading to better f1-scores (y axis).</p></figcaption></figure></section><section id="S7"><h3 class="pmc_sec_title">Enhlink enhancer-promoter associations are enriched for physical interactions</h3>
<p id="P19">We next applied Enhlink to scATAC-seq and (promoter capture) PCHi-C data generated across two tissues – pancreatic islets and adipose – in our previous T2D study (<a href="#R49" class="usa-link" aria-describedby="R49">Poirion <em>et al</em>., 2023</a>). This study examined the effect of mouse genotype (i.e., strain), sex, and diet on the cellular heterogeneity of these metabolic tissues in mice fed an obesogenic or laboratory diet. In both tissues, accessibility profiles clearly separated major cell types (<a href="#F4" class="usa-link">Figures 4A</a> and <a href="#F4" class="usa-link">4C</a>), and we previously reported differences between genotypes and diets (<a href="#R49" class="usa-link" aria-describedby="R49">Poirion <em>et al</em>., 2023</a>). Here, we applied Enhlink, Chi2 + FDR, and Cicero independently to each tissue and cell type to identify OCRs co-accessible with promoters. PCHi-C was previously performed on these same tissues to identify physical enhancer-promoter interactions (<strong>see Availability of data and materials</strong>). In both tissues, we observed higher recalls, precisions, and f1-scores (see <a href="#S12" class="usa-link">Methods</a>) for Enhlink compared to Cicero, and much higher numbers of links leading to higher recalls but lower precision for Chi2 + FDR compared to Enhlink (<a href="#F4" class="usa-link">Figures 4B</a> and <a href="#F4" class="usa-link">4D</a>). Here, we did not apply a cutoff to filter Cicero links, so as to obtain a number of links similar to that resulting from Enhlink. Further, we found that Enhlink-inferred links were more likely to be shared across sequencing batches (as measured by entropy computed across batches, see <a href="#S12" class="usa-link">Methods</a>), and hence less likely to be induced by technical artifacts, than were those inferred by Cicero or Chi2 + FDR (<a href="#F4" class="usa-link">Figure 4F</a>). Indeed, the proportion of links with <em>zero</em> or close to zero entropy, indicating a batch-specific link and a possible batch effect, was lower amongst those inferred from Enhlink relative to the other two methods (<a href="#SD8" class="usa-link">Figure S5</a>). Finally, we found that Enhlink-inferred links present in the PCHi-C data had lower <em>p</em>-values than those that did not, across all cell types (<a href="#F4" class="usa-link">Figure 4E</a>). This suggests that Enhlink <em>p</em>-values are a good indicator of the biological meaningfulness of a given link. As such, we generated an atlas of enhancer-promoter co-accessibilities for both tissues and each cell type (<a href="#SD9" class="usa-link">Figure S6</a>), indicating genotype, sex, and diet-specific effects and annotated these links with PCHi-C interactions (<strong>see Availability of data and materials</strong>).</p>
<figure class="fig xbox font-sm" id="F4"><h4 class="obj_head">Figure 4.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=10197707_nihpp-2023.05.11.540453v1-f0004.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/25ec/10197707/e88479e5370e/nihpp-2023.05.11.540453v1-f0004.jpg" loading="lazy" height="429" width="756" alt="Figure 4"></a></p>
<div class="p text-right font-secondary"><a href="figure/F4/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p id="P88">Enhlink outperforms other approaches in retrieving PCHi-C links and mitigates batch effects. <strong>A</strong> UMAP embedding and cell types of the islet dataset. <strong>B</strong> Enlink, Cicero, and Chi2 performance of promoter-enhancer inference in islet snATAC-seq relative to islet PCHi-C. <strong>C</strong> UMAP embedding and cell types of the adipose dataset. <strong>D</strong> Enlink, Cicero, and Chi2 performance of promoter-enhancer inference in adipose snATAC-seq relative to adipose PCHi-C. <strong>E</strong> Comparison (Mann-Whitney test) of the Enhlink <em>p</em>-value distributions from links intersecting PCHi-C and those not intersecting (control). <strong>F</strong> Distribution of the <em>batch × link</em> entropy for Cicero, Chi2 and Enhlink from a subset of cells from the islet dataset. Low entropy close to zero indicates links that exist only in a few or a single batch while high entropy indicates links widespread amongst the batches.</p></figcaption></figure></section><section id="S8"><h3 class="pmc_sec_title">Prioritizing neuronal enhancer-promoter links through multi-omic integration</h3>
<p id="P20">To characterize epigenomic regulation within another heterogeneous tissue, we generated a multi-omic snATAC-/snRNA-seq dataset from the striatum region of the brain. Striata were collected from eight genetically diverse inbred mouse strains, representing the founders of the Diversity Outbred (DO) and Collaborative Cross populations used for genetic analysis of complex traits (<a href="#R34" class="usa-link" aria-describedby="R34">Saul <em>et al</em>., 2019</a>). Of particular interest in the striatum are a subset of striatonigral and striatopallidal neurons that are defined by expressing either the dopamine receptor 1 (<em>Drd1</em>) or 2 (<em>Drd2</em>), respectively (<a href="#R12" class="usa-link" aria-describedby="R12">Gerfen <em>et al</em>., 1990</a>). Clustering of gene expression identified eight major cell types and mixed populations of neurons, including the <em>Drd1</em>/<em>Drd2</em> neurons and all other previously identified major cell types (<a href="#SD10" class="usa-link">Figure S7A</a>.</p>
<p id="P21">We sought to prioritize links between enhancers and promoters/genes based on both chromatin accessibility and gene expression data. Focusing first on <em>Drd1</em> neurons, we used Enhlink to identify 47,682 enhancer-promoter links within scATAC-seq data and 44,101 enhancer-gene links within scRNA-seq data. A subset of 16,431 links were concordant (i.e., shared and in the same direction), and these had higher scores and lower <em>p</em>-values than those uniquely identified from co-accessibility alone (snATAC-seq only; Mann-Withney <em>p</em>-value=0; <a href="#SD10" class="usa-link">Figures S7B</a>–<a href="#SD10" class="usa-link">C</a>). Similarly, enhancers within <em>Drd2</em> neurons with concordant (<em>n</em>=17,098) associations with a promoter’s accessibility (<em>n</em>=45,424) and its gene’s expression (<em>n</em>=47,023) had higher scores and lower <em>p</em>-values than those supported by co-accessibility alone (<a href="#SD10" class="usa-link">Figures S7B</a>–<a href="#SD10" class="usa-link">C</a>). Collectively, these results suggest that joint multi-omic analysis further refines enhancer identification.</p>
<p id="P22">We next used the expected association between a gene’s expression and its enhancers’ accessibility in the multi-omic data to evaluate computationally inferred co-accessibility between the gene’s promoter and those enhancers. For each marker gene of the Drd1 or Drd2 neurons, we inferred enhancer links with the associated promoter. We then evaluated the links according to whether they exhibited the expected correlation with the gene’s expression, as assessed with logistic regression (see <a href="#S12" class="usa-link">Methods</a>). Both Cicero (without cutoff) and Enhlink identified enhancer associations for 162 of the 172 marker genes. However, Enhlink identified a more focused set of links (<em>n</em>=802) relative to Cicero (<em>n</em>=6,997), having significantly stronger associations with gene expression (Mann-Whitney <em>p</em>-value&lt;0.05) (<a href="#SD11" class="usa-link">Figure S8</a>). This suggests Enhlink associations are enriched for true positives. Increasing Cicero’s cutoff resulted in smaller sets of links having increased correlation with gene expression relative to results without a cutoff, yet still inferior or similar to correlation inferred by Enhlink (Mann-Whitney <em>p</em>-value&lt;0.05). Further, this came at the expense of <em>fewer</em> linked genes – 92 for the often used (<a href="#R41" class="usa-link" aria-describedby="R41">Wang <em>et al</em>., 2020</a>; <a href="#R17" class="usa-link" aria-describedby="R17">Hocker <em>et al</em>., 2021</a>) cutoff of 0.2 and 55 for the cutoff of 0.28 yielding the number of links (<em>n</em>=700) most similar to those obtained with Enhlink. Overall, these results show the strength of Enhlink in identifying putative enhancers more strongly associated with target gene expression relative to those identified by Cicero.</p></section><section id="S9"><h3 class="pmc_sec_title">Validating neuronal enhancer-promoter links with eQTL</h3>
<p id="P23">One method to validate putative enhancers is through direct genome editing to test the downstream effect on gene expression. As an alternative approach, genetic variation among individuals provides a natural source of variation within enhancer sequences. The Diversity Outbred mouse population, segregates greater than 50 million variants with extremely high precision for genetic mapping (<a href="#R43" class="usa-link" aria-describedby="R43"><em>Website</em>, no date b</a>; <a href="#R4" class="usa-link" aria-describedby="R4">Churchill <em>et al</em>., 2012</a>; <a href="#R34" class="usa-link" aria-describedby="R34">Saul <em>et al</em>., 2019</a>). To explore the ability of Enhlink to identify biologically-relevant enhancers, we integrated previously collected (see <a href="#S12" class="usa-link">Methods</a>) expression quantitative trait loci (eQTL) data from bulk striatum RNA-seq experiments with enhancer links identified here. Genes with local (or <em>cis</em>-) acting eQTL are abundant in the DO population. Further, these <em>cis</em>-eQTLs are likely driven by variants within an enhancer proximal to the regulated gene that impacts expression (<a href="#R41" class="usa-link" aria-describedby="R41">Wang <em>et al</em>., 2020</a>), which we hypothesize would alter cell-type specific OCRs identified through snATAC-seq. Because the snATAC-seq data collected here represent replicates from the eight parental strains of the DO, we can further estimate OCR accessibility within each strain and see which accessibility patterns match the eQTL results. We identified 1,731 and 429 links from joint analysis of the snRNA- and snATAC-seq that were significantly (Enhlink <em>p</em>-value &lt; 0.01) associated with Drd1 or Drd2 in both modalities, respectively (see <a href="#S12" class="usa-link">Methods</a>). To look for enhancers that drive differential expression between these two sub-classes of neurons we compared these links with the set of marker genes from Drd1/Drd2 neuron gene expression clusters (see <a href="#S12" class="usa-link">Methods</a>). Doing so identified 159 links for 66 genes for <em>Drd1</em> neurons and 32 links for 17 genes for <em>Drd2</em> neurons. Of the enhancers identified with Enhlink and associated with marker genes of <em>Drd1</em> or <em>Drd2</em> neurons, 68 are linked to genes with <em>cis</em>-acting eQTL. We performed a SNP association analysis using a logarithm of the odds (LOD) regression approach to identify variants that show an association between the genotype at the OCR and gene expression (see <a href="#S12" class="usa-link">Methods</a>). Candidate enhancers driving variation in expression were identified as those with matching correlations between their genotype at the variant, gene expression, and accessibility of the promoter and enhancers across inbred strains. Of the identified correlations, three enhancer-promoter links for marker genes <em>Gulp1</em>, <em>Kcnb2</em>, and <em>Col25a1</em> (<a href="#F5" class="usa-link">Figures 5A</a>–<a href="#F5" class="usa-link">B</a>) serve as proof of principle. In each case the strains with the genotype identified as having the largest effect on the eQTL from bulk data (alternative genotype, <a href="#F5" class="usa-link">Figure 5C</a>), presented differential accessibility and expression in the single-nuclei data compared to the other strains (<a href="#F5" class="usa-link">Figure 5B</a>). Together these data show that Enhlink identifies biologically relevant enhancers that play an active role in cell-type- and strain-specific gene regulation.</p>
<figure class="fig xbox font-sm" id="F5"><h4 class="obj_head">Figure 5.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=10197707_nihpp-2023.05.11.540453v1-f0005.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/25ec/10197707/2009bbdee8d3/nihpp-2023.05.11.540453v1-f0005.jpg" loading="lazy" height="428" width="756" alt="Figure 5"></a></p>
<div class="p text-right font-secondary"><a href="figure/F5/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p id="P89">Enhlink reveals chromatin regulation mechanisms of striatum Drd1/Drd2 neurons. <strong>A</strong> Chromatin accessibility (y axis) with Enhlink-inferred links between the promoters and enhancers for <em>Kcnb2</em>, <em>Gulp1</em>, and <em>Col25a1</em>, three marker genes of Drd1 neurons. <strong>B</strong> Chromatin accessibility and gene expression profiles per genotype for three enhancers (<em>Kcnb2</em>, <em>Gulp1</em>, and <em>Col25a1</em>). <strong>C</strong> eQTL logarithm of odds (LOD) scores for SNPs within the boundaries of the three enhancers across the eight DO genotypes. Stars indicate genotype harboring an alternative allele within an enhancer of <em>Kcnb2</em>, <em>Gulp1</em>, or <em>Col25a1</em>. Star subscript associates LOD scores in panel C with chromatin accessibility and gene expression in panel B. <strong>D</strong> Distal Enhlink analysis unveils multiple enhancers from the region 500kb downstream of the <em>Drd1</em> promoter and linked to the top 10 marker genes of <em>Drd1</em> neurons (yellow arrows). These genes are also linked to an intronic region of <em>Isl1</em> (blue arrows), a key gene regulating Drd1/Drd2 genetic programs.</p></figcaption></figure></section><section id="S10"><h3 class="pmc_sec_title">Identifying distal <em>Drd1</em>-specific enhancers</h3>
<p id="P24">While the above analysis focused on identifying how local genetic variation impacts gene expression, Enhlink can also be used to identify cell-type-specific <em>distal</em> enhancer networks. To do so we extended our analysis by finding distal common enhancers for the top 10 <em>Drd1</em>-specific upregulated marker genes (<em>Adarb2</em>, <em>Cntnap3</em>, <em>Lingo2</em>, <em>Drd1</em>, <em>Il1rapl2</em>, <em>Cntnap5c</em>, <em>Erbb4</em>, <em>Nrg3</em>, <em>Tac1</em>, <em>Ebf1</em>) and top 10 <em>Drd2</em> specific marker genes (<em>Drd2</em>, <em>Nell1</em>, <em>Necab1</em>, <em>Unc5d</em>, <em>Grik3</em>, <em>Ptprm</em>, <em>Fam155a</em>, <em>Chrm3</em>, <em>Penk</em>, <em>Adk</em>) across <em>all</em> (259,720) OCRs, rather than those within +/−250kb of their respective promoters. We identified 110 links from snATAC-seq data alone. To mitigate potential false positives over this genome-wide set of OCRs, we further applied Enhlink to the multi-omic snATAC-/snRNA-seq data as above and inferred 70 links. We prioritized the 33 links shared across both analyses for further analysis. Remarkably, 22 of these 33 links were associated with just four enhancers, all arising from a region 500 kb downstream of the <em>Drd1</em> promoter and surrounded by the predicted pseudo-genes: <em>Gm34439</em>, <em>Gm40954</em>, and <em>Gm34557</em> (<a href="#F5" class="usa-link">Figures 5D</a> and <a href="#SD12" class="usa-link">S9A</a>). Further, all 10 of the <em>Drd1</em>-specific genes have at least a distal enhancer within the four <em>Drd1</em> proximal enhancers (<a href="#F5" class="usa-link">Figures 5D</a> and <a href="#SD12" class="usa-link">S9A</a>). Additionally, nine out of the remaining 11 links matched an intergenic OCR from the Islet-1 (<em>Isl1</em>) gene that was previously characterized for regulating striatonigral and striatopallidal genetic programs (<a href="#R25" class="usa-link" aria-describedby="R25">Lu <em>et al</em>., 2014</a>) (<a href="#F5" class="usa-link">Figures 5E</a> and <a href="#SD12" class="usa-link">S9B</a>). Notably, neurons from an <em>Isl1</em> knockout mouse showed an increase in <em>Drd2</em> expression and promoted striatopallidal (<em>Drd2</em>) neuron differentiation while repressing striatopallidal (<em>Drd1</em>) genes. Together these data show that Enhlink can identify coordinated chromatin regulation at distal loci with biologically meaningful connections, perhaps indicating coordinated transcription factor activity (<a href="#R46" class="usa-link" aria-describedby="R46">Yang <em>et al</em>., 2017</a>).</p></section></section><section id="S11"><h2 class="pmc_sec_title">Discussion</h2>
<p id="P25">In this study, we introduce Enhlink, a novel computational method that efficiently infers genomic linkages from single-cell datasets and is suitable for complex experimental designs. Enhlink infers enhancer-promoter co-accessibility from chromatin accessibility profiles in scATAC-seq data. It can also infer enhancer-promoter links supported by both their co-accessibility and concordant enhancer accessibility and target gene expression within multi-omic snATAC-/snRNA-seq datasets. More generally, Enhlink could be applied to other single-cell modalities containing sparse high-dimensional data, such as single-cell DNA methylation (<a href="#R22" class="usa-link" aria-describedby="R22">Liu <em>et al</em>., 2021</a>), single-cell ChIP-seq (<a href="#R14" class="usa-link" aria-describedby="R14">Grosselin <em>et al</em>., 2019</a>), or multi-omic datasets combining epigenome, methylome, and/or transcriptome (<a href="#R7" class="usa-link" aria-describedby="R7">Dimitriu <em>et al</em>., 2022</a>).</p>
<p id="P26">Enhlink leverages an original procedure derived from random forests (<a href="#R2" class="usa-link" aria-describedby="R2">Breiman, 2001</a>) to extend the capabilities of existing methods. First, Enhlink adjusts for technical covariates, such as sequencing library ID, to minimize batch effects at the level of <em>individual</em> cells. Methods that instead apply batch correction to aggregates of similar cells do not readily accommodate technical effects <em>within</em> the aggregate. This would pose a problem in studies, such as our T2D study, where cells of similar genotype are partitioned across batches (see <a href="#S12" class="usa-link">Methods</a>). Second, Enhlink can infer enhancers linked to a promoter within specific contexts, such as sex, genotype, or disease, by including each as a biological covariate. Third, for each enhancer-promoter link, Enhlink infers a <em>p</em>-value that is adjusted for multiple hypothesis testing <em>relative to all and only those enhancers tested for association with that promoter</em>. In this way, the strength (i.e., adjusted <em>p</em>-value) of each inferred association is scaled according to the genomic context of each promoter. Hence, two enhancers may have different inferred associations, even if their correlations with their respective promoters are similar, for example, if one enhancer has a much higher correlation with other enhancers it is compared against than the other enhancer. Fourth, Enhlink can infer linkages from distal regions beyond the neighboring OCRs. Finally, Enhlink can perform power analyses to estimate expected accuracies based on a simulation workflow developed from experimentally validated enhancer-promoter linkages. This simulation framework can be applied independently of Enhlink and can aid others in diagnosing the impact of hyperparameter tuning, preprocessing steps, or other methodological choices.</p>
<p id="P27">Enhlink employs several regularization mechanisms to reduce false positives. One hyperparameter, the maximum number of explanatory features of each tree, is biologically interpretable as the <em>expected</em> number of enhancers at each target region. While the actual number of enhancers is a property of the entire <em>ensemble</em> of trees, we expect that it is of the same order of magnitude as the number of features considered at each <em>tree</em>. As such, the hyperparameter can be set according to biological expectations or tractability of downstream experimental validation. Enhlink sensitivity and specificity can also be fine-tuned by adjusting the number of trees used and the minimum number of features required for each tree. Thus, weak but significant enhancer-promoter associations could be inferred by using a larger forest and feature size at the expense of increased computation. We implemented Enhlink in Go which allows it to be extensively distributed amongst a cluster of CPUs and makes it well-suited for analyzing current (<a href="#R47" class="usa-link" aria-describedby="R47">Zhang <em>et al</em>., 2021</a>) and future (<a href="#R40" class="usa-link" aria-describedby="R40">Vandereyken <em>et al</em>., 2023</a>) large-scale multi-omic single-cell datasets.</p>
<p id="P28">Through extensive benchmarking of both simulated and real data, our study demonstrates that Enhlink significantly outperforms other existing approaches in terms of accuracy while also limiting artifactual, batch-specific linkages. We took advantage of multi-omic data to show that enhancers identified from scATAC-seq were better correlated with gene expression when inferred with Enhlink than with the popular Cicero framework. In addition, simulation and intersection with two reference PCHi-C datasets showed that Cicero was also outperformed by a Chi2 procedure followed by FDR correction. We also showed that aggregating cells into pseudo-bulk, a preprocessing step followed by ArchR and inspired by the Cicero workflow, was actually detrimental to accuracy. This occurs when the binning, aimed to group cells with similar characteristics, is too coarse and results in the grouping of heterogeneous cells. We evaluated Enhlink using three datasets, including two snATAC-seq datasets previously generated from mouse islet and adipose tissues and a novel multi-omic snATAC-/snRNA-seq dataset from the mouse striatum. The single-cell islet and adipose studies aimed to characterize cellular heterogeneity in these tissues and uncover genes and regulatory elements perturbed by diet and genetic mechanisms. To aid this investigation, we developed cell-type-specific enhancer-promoter atlases of the islet and adipose tissues (see <strong>Availability of data and materials</strong>). These include genotype-, diet-, and sex-specific linkages that are annotated according to whether the corresponding promoter and enhancer physically interact based on PCHi-C data generated from the same tissues. Links supported by PCHi-C data, and those with concordant promoter chromatin accessibility and target gene expression in the striatum dataset, have significantly lower Enhlink <em>p</em>-values than their counterparts. This suggests that Enhlink <em>p</em>-values robustly reflect the biological meaningfulness of their associated links.</p>
<p id="P29">We generated the multi-omic mouse striatum dataset to investigate epigenomic regulations underlying the differentiation and gene regulation of striatonigral neurons expressing the dopamine receptor <em>Drd1</em> and striatopallidal neurons expressing <em>Drd2</em>. Our goal was to identify strong candidate regulatory regions involved in these processes. To achieve this, we utilized Enhlink to identify concordant links between promoter accessibility and gene expression. We then examined the relationship between naturally occurring regulatory variation, chromatin accessibility, and gene expression amongst eight parental haplotypes with associated eQTL and SNP data. Through this analysis, we identified three enhancers associated with the expression of <em>Gulp1</em>, <em>Col25a1</em>, and <em>Kcnb2</em>. The contribution of the different haplotypes to the expression pattern indicated that the variants located within the Enhlink-identified enhancers were likely to be the causal factors for the observed changes in accessibility and expression. This finding strengthens the hypothesis that the regions identified by Enhlink play a crucial role as enhancers. Given that the majority of disease-associated variants within the human population occur within OCRs, this approach is extendable to prioritizing variants related to complex traits and might palliate some of the theoretical limits of eQTL analysis (<a href="#R39" class="usa-link" aria-describedby="R39">Umans, Battle and Gilad, 2021</a>).</p>
<p id="P30">We further demonstrated the power of Enhlink to detect links between a target promoter and its distal enhancers (&gt; +/−250kb). We hypothesized that key enhancers should be detected as hubs correlating with the expression of multiple genes, similar to other studies modelling gene expression with SNPs (<a href="#R11" class="usa-link" aria-describedby="R11">Gamazon <em>et al</em>., 2015</a>; <a href="#R31" class="usa-link" aria-describedby="R31">Poirion <em>et al</em>., 2018</a>). Strikingly, we found that most of the distal links inferred from the top marker genes of the striatonigral neurons came from a region located 500kb downstream of the <em>Drd1</em> promoter. This region exhibits many characteristics of a super-enhancer region (<a href="#R16" class="usa-link" aria-describedby="R16">Heinz <em>et al</em>., 2015</a>), as it contains a cluster of enhancers associated with several marker genes of the striatonigral neurons. Super-enhancers have been shown to determine cell fate and to maintain cell identity (<a href="#R44" class="usa-link" aria-describedby="R44"><em>Website</em>, no date c</a>), stressing the possible role played by the downstream region of <em>Drd1</em>. Also, we found that all top ten markers of <em>Drd1</em> neurons were linked with an intronic region of the <em>Isl1</em> gene, a key gene in the striatopallidal/striatonigral differentiation (<a href="#R25" class="usa-link" aria-describedby="R25">Lu <em>et al</em>., 2014</a>). While these results are novel, they need to be confirmed through further experimental validation.</p>
<p id="P31">Enhlink is a powerful and robust method for inferring genomic linkages from sparse, high-dimensional, single-cell ‘omic or multi-omic datasets. Enhlink outperforms other tested approaches, in part, by introducing cellular level covariates that ameliorate technical effects and capture biological effects. Enhlink’s efficient implementation is tailored to large-scale single-cell analyses, including those aimed at deciphering complex regulatory networks.</p></section><section id="S12"><h2 class="pmc_sec_title">Methods</h2>
<section id="S13"><h3 class="pmc_sec_title">Human heart snATAC-seq dataset processing</h3>
<p id="P32">We downloaded the Human Heart snATAC-seq dataset from the portal (<a href="http://ns104190.ip-147-135-44.us/CARE_portal/ATAC_data_and_download.html" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">http://ns104190.ip-147-135-44.us/CARE_portal/ATAC_data_and_download.html</a>) described in the publication (<a href="#R17" class="usa-link" aria-describedby="R17">Hocker <em>et al</em>., 2021</a>). From the portal, we downloaded the matrix file (<em>all.npz</em>), the cell index file (<em>all.index</em>), the OCR features index file (<em>all.merged.ygi</em>), the genome reference (Homo_sapiens.GRCh38.99.TSS.2K.bed) the cluster file (<em>all.cluster</em>), and the <em>all.group</em> file with the library ID of each cell. The matrix from the <em>all.npz</em> file is a scipy sparse matrix with <em>79515</em> cells and <em>287415</em> OCRs with boolean values indicating if at least one read mapped to the cell is found within the boundaries of the corresponding OCR. From the genome reference and features index files, we defined the <em>KCNH2</em> promoter regions by the following OCRs: “chr7:150976584–150977120”, “chr7:150978193–150978805”, and “chr7:150978915–150979661”. The <em>KCNH2</em> enhancer was defined as the following genomic region: “chr7:150955147–150956502”. We also defined the <em>MYL2</em> promoter regions by “chr12:110920282–110920944” and “chr12:110921386–110921633”. We defined three enhancer regions of <em>MYL2</em> by “chr12:110931149–110931877”, “chr12:110928658–110929096”, and “chr12:110907461–110909456”. We then focused on the atrial (aCM) and ventricular (vCM) cardiomyocyte cell types, since <em>KCNH2</em> is only expressed in these cell types, and defined a <em>KCNH2</em> promoter boolean vector for either aCM or vCM by merging (using a <em>logical or</em> operand) the three promoter region vectors from the feature matrix using either the cell index of aCM or vCM. We followed the same strategy for the promoter of <em>MYL2</em>, but restricted to the vCM cell type since <em>MYL2</em> is only expressed in vCM. We also downloaded the bigwig tracks from the same portal for the aCM and vCM cell types from the same portal. Finally, we computed the Enhlink co-accessibilities for these two promoters and for aCM and vCM based on the workflow described below.</p></section><section id="S14"><h3 class="pmc_sec_title">Co-accessibility signals from <em>KCNH2</em> and <em>MYL2</em>
</h3>
<p id="P33">We used the <em>KCNH2</em> promoter vectors of aCM and vCM as ground truth labels (either accessible or not for a given cell) and the <em>KCNH2</em> enhancer vectors as estimated labels to compute the precision, recall, and f1-scores. We then drew a random subset of 500 enhancers amongst the 287415 features of the feature matrix to compute the baseline distributions for the precision, recall, and f1-score. We then derived a <em>p</em>-value for the computed precision, recall, and f1-score with regard to the baseline distributions. We followed the same strategy for the <em>MYL2</em> promoter and its associated enhancers.</p></section><section id="S15"><h3 class="pmc_sec_title">Mouse islet and adipose scATAC-seq</h3>
<p id="P34">We used two scATAC-seq datasets from the mouse islet and adipose tissues whose generation and processing we previously described (<a href="#R49" class="usa-link" aria-describedby="R49">Poirion <em>et al</em>., 2023</a>). The islet dataset gathered 100,720 cells, 295,089 OCR features, ten cell populations including alpha, beta, and delta cells, and was processed using 18 10X Genomics sequencing libraries. The adipose dataset gathered 60,229 cells, 311,645 OCR features, nine cell populations including adipocytes and macrophages, and was processed using 24 10X Genomics sequencing libraries. Cells from both datasets were labeled with their mouse strain/genotype ID (CAST, NZO, B6), diet (10% or 44% fat), and sex (M/F).</p></section><section id="S16"><h3 class="pmc_sec_title">Mouse (RNA/ATAC) multi-omic single-cell collection</h3>
<p id="P35">Mouse striatum were dissected from 12-week-old mice from eight inbred strains: A/J (The Jackson Laboratory Stock 000646), C57BL/6J (000664), 129S1/SvImJ (002448), NOD/ShiLtJ (001976), NZO/H1LtJ (002105), CAST/EiJ (000928), PWK/PhJ (003715), and WSB/EiJ (001145). Striatum were collected from two males and two females for each strain. Striatum samples were flash frozen in liquid nitrogen and stored at −80 °C until processing. After collection, the striatum samples were processed in four batches of eight over two days. Each batch consisted of four male and four female samples, and each strain was represented in each batch.</p></section><section id="S17"><h3 class="pmc_sec_title">Multi-omic library generation</h3>
<p id="P36">For single nuclei preparation, frozen striatum were placed into 500 μl Miltenyi Nuclei Extraction Buffer (Miltenyi 130-128-024) plus 0.8 U/μl RiboLock RNase Inhibitor (ThermoFisher EO0382) in a gentleMACS C tube (Miltenyi 130-093-237) on ice, and then nuclei were immediately extracted in batches of 4 through the “4C_nuclei_1” program on the MACS Dissociator. Nuclei were placed on ice and filtered through a 70 μm pluriStrainer Mini into a pre-chilled 2 ml tube, and the C tube was washed with an additional 500 μl cold Miltenyi Nuclei Extraction Buffer and filtered. Nuclei were spun down at 350 rcf at 4 °C for 5 minutes and resuspended in 80 μl cold PBS with 2% BSA and 1 U/μl RiboLock. Nuclei were counted (~4,000 nuclei/μl) and 60,000 nuclei from each of the 8 samples were mixed in a chilled 1.5 ml Eppendorf tube. The pooled nuclei were spun at 300 rcf at 4 °C for 3 minutes and resuspended in 30 μl 10x Genomics Nuclei Buffer with 1 U/μl RNase inhibitor. The pooled nuclei were counted once more to confirm counts (~10,000 nuclei/ul), single-cell suspension, and lack of debris.</p>
<p id="P37">Nuclei viability was assessed on a LUNA-FX7 automated cell counter (Logos Biosystems), and up to 40,000 nuclei (~5,000 from each sample) were loaded onto each of 4 lanes of a 10X Chromium microfluidic chip. Single nuclei capture and library preparation were performed using the 10X Chromium platform and according to the manufacturer’s protocol (#<a href="https://www.ncbi.nlm.nih.gov/nuccore/CG000388" class="usa-link" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">CG000388</a> Chromium Next GEM Single Cell Multiome ATAC + Gene Expression). Because the 10X chip was superloaded, to reduce duplicate reads arising from multiple PCR steps, the number of cycles was adjusted from the 10X protocol. After GEM generation, barcoded cDNA and transposed DNA fragments were pre-amplified using 6 cycles. The pre-amplified sample was divided and used for two separate steps. An additional 6 cycles were used for adding a sample index for ATAC library construction and 12 PCR cycles for the gene expression library construction. cDNA and ATAC libraries were checked for quality on Agilent 4200 Tapestation and ThermoFisher Qubit Fluorometer, and quantified by KAPA qPCR, before sequencing; each gene expression library was sequenced using NovaSeq 6000 S4 v1.5 200 cycle flow cell lane, dual index scRNAseq asymmetric read configuration 28-10-10-90, targeting 20,000 nuclei with an average sequencing depth of 50,000 read pairs per nucleus. Each ATAC library was sequenced using Illumina NovaSeq 6000 S2 v1.5 100 cycle flow cell lane, with a 50–8-24-49 read configuration, also targeting 20,000 nuclei with an average sequencing depth of 50,000 reads per cell.</p></section><section id="S18"><h3 class="pmc_sec_title">Multi-omic library sequencing</h3>
<p id="P38">Illumina base call files for all libraries were demultiplexed and converted to FASTQ files using bcl2fastq 2.20.0.422 (Illumina). A filtered joint digital gene expression and chromatin accessibility matrix was generated against the 10x Genomics mm10–2020-A reference build (version 2020-A, Assembly: GRCm38, ENSEMBL release 98; Annotations: Gencode vM23) using a modified 10x Genomics CellRanger-ARC count pipeline (v2.0.0), which had the 20,000 cell limit of cell calling removed.</p></section><section id="S19"><h3 class="pmc_sec_title">scRNA-seq analysis for the striatum dataset</h3>
<p id="P39">For each batch of the libraries, the output from Cell Ranger ARC consisted of both ATAC and gene expression BAM files. These two BAM files were used as inputs for Demuxlet (<a href="#R19" class="usa-link" aria-describedby="R19">Kang <em>et al</em>., 2020</a>) to determine the mouse strain identities of individual cells and to detect doublets. Only cells that were identified as singlets with consistent mouse strain identities in both assays were retained for further analysis.</p>
<p id="P40">To annotate and visualize the retained single cells, we performed downstream gene expression analysis on them using Seurat (version 4.0.3, (<a href="#R15" class="usa-link" aria-describedby="R15">Hao <em>et al</em>., 2021</a>)). For each batch, we removed low-quality cells and multiplets by filtering out cells with fewer than 200 or more than 7,500 detected genes and those with greater than 15% mitochondrial counts. We then used DoubletFinder (<a href="#R27" class="usa-link" aria-describedby="R27">McGinnis, Murrow and Gartner, 2019</a>) to further exclude any remaining doublets. Next, we merged the Seurat objects from the four batches and performed normalization, highly variable feature identification, scaling, and linear dimensionality reduction using the NormalizeData(), FindVariableFeatures(), ScaleData(), and RunPCA() commands, respectively, with default parameters. To remove batch effects, we integrated the single-cell datasets from the four batches using Harmony (<a href="#R20" class="usa-link" aria-describedby="R20">Korsunsky <em>et al</em>., 2019</a>). Using the first 40 principal components determined manually by the Elbow plot, we conducted unsupervised cell clustering through the Louvain algorithm on the K-nearest neighbor (KNN) graph with resolution set to 0.2, which resulted in 22 cell clusters. We visualized the output in a 2D Uniform Manifold Approximation and Projection (UMAP) embedding using the same PCs used for cell clustering. We excluded four cell clusters that (1) co-expressed neuron markers <em>Drd1/Drd2</em> and oligodendrocyte marker <em>Aspa</em>; (2) co-expressed neuron markers <em>Drd1/Drd2</em> and astrocyte marker <em>Gja1</em>; (3) co-expressed neuron markers <em>Drd1/Drd2</em> and macrophage marker <em>C1qa</em>; or (4) highly expressed mitochondrial genes. We then re-processed and integrated the remaining cells using the same steps as before, yielding 18 cell clusters. We annotated these 18 cell clusters using marker genes identified through the FindAllMarkers() command through DropViz (<a href="#R35" class="usa-link" aria-describedby="R35">Saunders <em>et al</em>., 2018</a>).</p>
<p id="P41">We processed the snATAC-seq data separately from the scRNA-seq data and followed the same preprocessing procedure as the one described for the mouse islet and adipose snATAC-seq dataset (<a href="#R49" class="usa-link" aria-describedby="R49">Poirion <em>et al</em>., 2023</a>). Briefly, we aligned the reads to the mm10 genome with Cell Ranger V6 with default parameters. We inferred the peaks fusing MAC2 (<a href="#R48" class="usa-link" aria-describedby="R48">Zhang <em>et al</em>., 2008</a>).</p></section><section id="S20"><h3 class="pmc_sec_title">Enhlink analytical workflow</h3>
<p id="P42">The analytical procedure carried out by Enhlink involves multiple steps illustrated in <a href="#SD4" class="usa-link">Figure S1</a> and explained in greater detail in <a href="#SD1" class="usa-link">Additional File S1</a>. It can be summarized as follows: a) create a feature matrix (i.e., OCR × cell matrix) and a response vector (i.e., single-cell promoter accessibility or target gene expression) for each target genomic region, b) model the response vector as a function of the feature matrix and identify the significant features associated with the target region, and c) optionally perform a secondary analysis to detect biological covariates associated with the linkage.</p>
<p id="P43">At a minimum, Enhlink requires a boolean sparse matrix, indicating the OCRs of each cell and a list of genomic regions, typically the promoters, defining the linkage targets. In addition, Enhlink optionally takes a sparse matrix containing the values of the target regions (such as a single-cell expression matrix), a file containing the covariates of each cell, and the cluster IDs of each cell. Enhlink constructs a feature matrix <em>M</em><sub><em>n</em></sub> for each target region by iterating through the OCRs surrounding it (+/− 250kb by default). If the feature matrix contains fewer than 100 features by default, Enhlink supplements it with random features derived from the existing features. After constructing the feature matrix for each target region, Enhlink incorporates one-hot-encoded covariates and generates a response vector <em>v</em><sub><em>g</em></sub>, representing either the boolean accessibility or the expression of the gene/target region <em>g</em>. If <em>v</em><sub><em>g</em></sub> is continuous (e.g., representing gene expression), it is binarized using the mean of the non-null values as threshold. Then, Enhlink proceeds to model <em>v</em><sub><em>g</em></sub> = <em>f</em>(<em>M</em><sub><em>n</em></sub>) for each cluster (or for all cells if no clusters are provided) and identifies features from Mn that significantly predict Vg. Enhlink employs a strategy similar to that of a random forest classifier (<a href="#R2" class="usa-link" aria-describedby="R2">Breiman, 2001</a>), performing 100 iterations by default. In each iteration, a random sample of cells and features is selected, and a decision tree (<a href="#R32" class="usa-link" aria-describedby="R32">Quinlan, 1986</a>) is used to recursively reduce the number of samples and features based on the top feature selected at each level of the tree. The top features are selected using a modified score derived from the Information Gain (IG) (see <a href="#SD1" class="usa-link">Additional file S1</a>), which favors informative, positively correlated, and accessible features. For each feature, Enhlink calculates a <em>p</em>-value for its score to be different from zero across iterations using Student’s <em>t</em>-test from the disturb library (<a href="https://pkg.go.dev/gonum.org/v1/gonum/stat/distuv" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://pkg.go.dev/gonum.org/v1/gonum/stat/distuv</a>) and corrects the feature <em>p</em>-values using the Benjamini-Hochberg False Discovery Rate (FDR) procedure.</p></section><section id="S21"><h3 class="pmc_sec_title">Estimating the expected accuracy of inferred links through simulation</h3>
<p id="P44">Enhlink provides an option to estimate the expected accuracy of the inferred links for a given target region by generating simulated enhancers and target regions. This simulation procedure aims to replicate the observed correlations between experimentally validated enhancers and promoters. More detailed information on this procedure can be found in <a href="#SD1" class="usa-link">Additional file S1</a>. Briefly, Enhlink first simulates a promoter by shuffling a target region. Then, to simulate an associated enhancer, Enhlink duplicates the simulated promoter, and introduces two types of random noise. The noise is controlled by two hyperparameters, λ<sub>open</sub> and λ<sub>close</sub>, which model the scenario where the enhancer is not accessible in a given cell (λ<sub>open</sub>) or the target region is not accessible (λ<sub>close</sub>). The values of λ<sub>open</sub> and λ<sub>close</sub> are estimated from the heart snATAC data, using the experimentally validated enhancer of <em>KCNH2</em> and enhancers from <em>MYL2</em>, as described below.</p></section><section id="S22"><h3 class="pmc_sec_title">Inferring biological context-specific enhancer-promoter interactions</h3>
<p id="P45">Enhlink can optionally infer biological context-specific linkages with the details of the procedure found in <a href="#SD1" class="usa-link">Additional file S1</a> and summarized here. Each context is represented by a cell-level categorical covariate. Note that Enhlink one-hot encodes categorical variables into boolean features and cannot currently process continuous covariates. In this configuration. Briefly, Enhlink first infers the set of enhancers and covariates linked to a target region <em>g</em> then, for each of these enhancers <em>e</em> Enhlink computes <em>Veg</em> = <em>Ve</em> ∘ <em>Vg</em> as the Hadamard product between the target vector <em>Vg</em> and the enhancer vector <em>Ve. Veg</em> corresponds to a boolean vector indicating when both the enhancer <em>e</em> and the target region <em>g</em> are accessible within a cell. <em>Veg</em> is then used as a new target vector to find the covariates significantly associated with it.</p></section><section id="S23"><h3 class="pmc_sec_title">Addressing class imbalance in datasets with unequal covariate distributions</h3>
<p id="P46">Enhlink provides an option to mitigate class imbalance in datasets with varying covariate distributions, which is beneficial when one or more covariates are under- or over-represented. In such cases, the bootstrap samples may not adequately represent the covariate space. Enhlink addresses this issue by generating a more balanced distribution of covariates through an incremental process. Specifically, Enhlink iteratively selects subsets of cells according to their covariates to obtain a near-uniform distribution of the covariates. While this strategy can be helpful in achieving a more uniform distribution of covariates, it is important to note that it may produce biased results if one or more covariates are vastly underrepresented. Therefore, it is recommended to thoroughly assess the distribution of covariates, and to consider alternative approaches such as covariate removal if necessary to ensure more representative results. More details are given in <a href="#SD1" class="usa-link">Additional file S1</a>.</p></section><section id="S24"><h3 class="pmc_sec_title">Enhlink hyperparameters</h3>
<p id="P47">The Enhlink inference workflow is governed by multiple hyperparameters summarized in <a href="#SD2" class="usa-link">Table S1</a>. The main hyperparameters governing the regularization are <em>max_features</em>, which controls the maximum number of features that a tree can use, and <em>depth</em> which controls the maximum depth of each tree. <em>Depth</em> and <em>max_features</em> are intertwined since <em>depth</em> also indirectly controls the maximum number of features. However, <em>max_features</em> is a more intuitive hyperparameter to use than <em>depth</em>. The latter influences the speed of Enhlink and is set to 2 by default, but needs to be increased if <em>max_features</em> is set higher. <em>secondOrderMaxFeat</em> (set as 2 by default) is the equivalent of the <em>max_features</em> parameter for the inference of the biological context-specific enhancer-promoter interactions, triggered with the <em>secondOrder</em> hyperparameter. <em>N_boot</em> defines the number of trees to build and controls the false positive rate and influences the speed of Enhlink, similarly to <em>min_matsize</em>, controlling the minimum number of features of <em>Mn</em>. The hyperparameters <em>downsample</em> (the size of the bootstrap) and <em>maxFeatType</em> (the number of features to include) can be used to increase the speed of the procedure but lower values might lead to lower accuracies. Finally, <em>threshold</em> defines the <em>p</em>-value cutoff and can be used to regulate the precision and the recall.</p></section><section id="S25"><h3 class="pmc_sec_title">Enhlink software suite</h3>
<p id="P48">Enhlink is an analytical framework developed in Go (<a href="https://go.dev/" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://go.dev/</a>), and compiled into three executables: <em>enhlink</em>, <em>enhgrid</em>, and <em>enhtools</em>. The command line manual and arguments of each executable can be accessed using the -<em>h</em> flag, (e.g. <em>enhlink -h</em>). <em>enhlink</em> is the main executable that launches the Enhlink pipeline, while <em>enhgrid</em> allows launching Enhlink for a range of input values for all the hyperparameters accepting a numerical value. <em>enhgrid</em> is useful for, for example, automatizing a grid-search approach by trying a combination of multiple hyperparameters or for testing different noise levels. <em>enhtools</em> intersect results from multiple runs and output either the common or unique links of a particular run. It also computes the accuracy between two runs (f1-score, precision, recall). Finally, <em>enhtools</em> can filter links that are not within specific regions defined in an input BED file. This functionality can be used for example to filter links not inside topologically associated domains (TAD). The Go source code, the manual, and the tutorial are available here: (<a href="https://gitlab.com/Grouumf/enhlinktools" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://gitlab.com/Grouumf/enhlinktools</a>).</p></section><section id="S26"><h3 class="pmc_sec_title">Simulation studies of the performance impact of hyperparameters</h3>
<p id="P49">We conducted a simulation study to estimate the impact of the different hyperparameters using three scATAC-seq datasets: the mouse islet, the mouse adipose, and the snATAC-seq from the multi-omic striatum dataset mentioned earlier. We aimed to investigate the impact of various hyperparameters and experimental conditions, such as dataset origin and read depth, on Enhlink’s expected accuracy (see <a href="#F2" class="usa-link">Figure 2C</a>). To accomplish this, we first subset the datasets by selecting specific cell types, such as beta cells for the islet, adipocytes for the adipose, and Drd1 neurons for the striatum. We then utilized Enhlink’s simulation framework, described in <a href="#SD1" class="usa-link">Additional file S1</a>, to estimate the expected accuracy of Enhlink analysis at a given promoter. We used a consistent grid of hyperparameters, as detailed in <a href="#SD3" class="usa-link">Table S2</a>, for each dataset and applied the enhgrid tool to perform Enhlink on the hyperparameter grid for all three datasets. Furthermore, we conducted the Enhlink analysis on a random subset of 40 genes from the features list of the three datasets for each combination of hyperparameters in the grid.</p></section><section id="S27"><h3 class="pmc_sec_title">Estimating the hyperparameters importance from the simulation studies</h3>
<p id="P50">From the hyperparameters simulation study described above, we estimated the most significant hyperparameters by fitting a Random Forest regressor from the scikit-learn library (<a href="#R29" class="usa-link" aria-describedby="R29">Pedregosa <em>et al</em>., 2011</a>) using the f1-score as the dependant variable, and Enhlink’s hyperparameters as predictive variables (<a href="#F3" class="usa-link">Figure S3</a>). The simulation generated the true positive rate (TPR), false positive rate (FPR) and false negative rate (FNR) for each gene tested and for each hyperparameters combination. We then computed the f1-score as <span xmlns:mml="http://www.w3.org/1998/Math/MathML"><math id="M1" display="inline"><mrow><mi>f</mi><msub><mn>1</mn><mrow><mtext mathvariant="italic">score </mtext></mrow></msub><mo>=</mo><mfrac><mrow><mtext mathvariant="italic">TPR</mtext></mrow><mrow><mo stretchy="false">(</mo><mtext mathvariant="italic">TPR</mtext><mo>+</mo><mn>0.5.</mn><mo stretchy="false">(</mo><mtext mathvariant="italic">FPR</mtext><mo>+</mo><mtext mathvariant="italic">FNR</mtext><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow></math></span> and model it as a function of <em>f</em>1<sub><em>score</em></sub> = <em>f</em>(<em>ℎyperparameter</em>). We one-hot encoded all the hyperparameters and their values, removing the first value to avoid colinearity, and used them as binary variables. We also added the dataset ID as an additional variable. We then collected the feature importance of the model, computed as the Gini importance, an impurity-based measurement, using the <em>feature_importances_</em> attribute of the scikit-learn class. For each simulated promoter, we also computed the accessibility ratio as the ratio between the number of cells having the promoter accessible and the total number of cells. We then plotted the influence of the promoter accessibility ratio on the f1-score using the Python library <em>seaborn</em>.</p></section><section id="S28"><h3 class="pmc_sec_title">Generating reference datasets for methods comparison</h3>
<p id="P51">We generated two simulated datasets, using either snATAC-seq only from the mouse islet or the snATAC-seq + scRNA-seq from the striatum dataset, containing either simulated enhancer-promoter co-accessibilities (ATAC-seq only) or correlated enhancer-gene links (ATAC+RNA). From the mouse islet dataset, we used the delta cell subset and a random set of 400 genes to simulate 400 promoters and 1800 enhancers. For each random promoter, we generated a random number of simulated enhancers (between 2 and 7) with the noise parameters λ<sub>close</sub>=<em>1.25</em>, λ<sub>open</sub>=<em>0.25</em>. We created dummy genomic coordinates for these enhancers in order for them to be in the vicinity of their matching promoter. These simulated enhancers/promoters were injected in a matrix of 10100 cells (the delta cells) and 295089 peaks (the total number of peaks). From the striatum dataset, we used the Drd1 neuron cell types and a random set of 897 genes to simulate between 2 and 7 enhancers for each gene, for a total of 4090 enhancers. We used the same noise parameters: λ<sub>close</sub>=<em>1.25</em>, λ<sub>open</sub>=<em>0.25</em>, and binarised the randomized gene vectors using the mean of its non-null element before generating their associated enhancers (see above). The simulated enhancers were further injected into a matrix of 10000 cells and 259720 peaks.</p></section><section id="S29"><h3 class="pmc_sec_title">Methods comparison procedure</h3>
<p id="P52">We processed the ATAC simulated matrix with Enhlink, Chi2, Chi2 + FDR, Cicero, and ArchR workflows, and processed the ATAC+RNA simulated matrix with Enhlink, Signac, SnapATAC, and ArchR workflows. We used the same genomic window of +/− 250kb around the promoter for all workflows. We then computed the <span xmlns:mml="http://www.w3.org/1998/Math/MathML"><math id="M2" display="inline"><mrow><mtext mathvariant="italic"> Precision </mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></mrow></math></span>, <span xmlns:mml="http://www.w3.org/1998/Math/MathML"><math id="M3" display="inline"><mrow><mtext mathvariant="italic"> Recall </mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi><mo>'</mo></mrow></mfrac></mrow></math></span>, and the <span xmlns:mml="http://www.w3.org/1998/Math/MathML"><math id="M4" display="inline"><mrow><mi>f</mi><msub><mn>1</mn><mrow><mtext mathvariant="italic">score </mtext></mrow></msub><mo>=</mo><mn>2</mn><mfrac><mrow><mtext mathvariant="italic"> Precision</mtext><mspace width="1pt"></mspace><mtext mathvariant="italic">.Recall </mtext></mrow><mrow><mtext mathvariant="italic"> Precision </mtext><mo>+</mo><mtext mathvariant="italic"> Recall </mtext></mrow></mfrac></mrow></math></span> for each of the simulated promoters/genes using the set of simulated enhancers as the true positives. We computed for each workflow and dataset the overall accuracy scores with their standard deviation (sd) using the mean and the sd of the three metrics. Finally, we also plotted the correlation between the accuracy scores and the mean of each simulated gene or promoter using the <em>lmplot</em> function of the Python <em>seaborn</em> library.</p></section><section id="S30"><h3 class="pmc_sec_title">Alternative workflows implementation</h3>
<section id="S31"><h4 class="pmc_sec_title">Chi2</h4>
<p id="P53">A straightforward approach for inferring the co-accessibility of a promoter region <em>g</em> with the set <em>E</em> of its surrounding enhancers is to perform a Chi2 test between <em>g</em> and <em>e</em> for each <em>e</em> ∈ <em>E</em>. Since <em>v</em><sub><em>g</em></sub> and <em>v</em><sub><em>e</em></sub>, i.e. the accessibility vector of <em>g</em> and <em>e</em>, were binary, we constructed a <em>2 × 2</em> contingency table for each (<em>g</em>, <em>e)</em>, containing the occurrence for the following conditions: <em>v</em><sub><em>g</em></sub> == 1 ∩ <em>v</em><sub><em>e</em></sub> == 1, <em>v</em><sub><em>g</em></sub> == 0 ∩ <em>v</em><sub><em>e</em></sub> == 1, <em>v</em><sub><em>g</em></sub> == 0 ∩ <em>v</em><sub><em>e</em></sub> == 0, and <em>v</em><sub><em>g</em></sub> == 1 ∩ <em>v</em><sub><em>e</em></sub> == 0. We used the <em>chi2_contingency</em> function from the Python library <em>Scipy</em> (<a href="#R37" class="usa-link" aria-describedby="R37">Seabold and Perktold, 2010</a>) to infer the <em>p</em>-value.</p></section><section id="S32"><h4 class="pmc_sec_title">Chi2 + FDR</h4>
<p id="P54">A more refined approach to the Chi2 method described above is to correct for multiple hypothesis testing by applying the False Discovery Rate procedure from Benjamini-Hochberg (<a href="#R42" class="usa-link" aria-describedby="R42"><em>Website</em>, no date a</a>) on the set of <em>p</em>-values obtained when applying the Chi2 on <em>E</em>. The method consisted in computing an expected <em>p</em>-value (fdr), assuming a false positive, based on the rank of the feature and the corrected <em>p</em>-value was equal to <em>p-value × fdr</em>. We used the <em>fdrcorrection</em> method from the Python <em>Statsmodels</em> library (<a href="#R37" class="usa-link" aria-describedby="R37">Seabold and Perktold, 2010</a>) to perform the FDR corrections.</p></section><section id="S33"><h4 class="pmc_sec_title">Cicero</h4>
<p id="P55">We downloaded the latest version of the Cicero algorithm (<a href="#R30" class="usa-link" aria-describedby="R30">Pliner <em>et al</em>., 2018</a>) using the <em>R</em> library developed by the authors (<a href="https://cole-trapnell-lab.github.io/cicero-release/docs/" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://cole-trapnell-lab.github.io/cicero-release/docs/</a>). To parallelize the workflow and reduce the shared memory used, we processed each chromosome independently. For each chromosome, we created a UMAP embedding with the following steps: i) We performed a TF-IDF embedding using the <em>TfidfTransformer</em> class from Scikit-Learn. ii) We used the singular value decomposition (SVD) using the <em>TruncatedSVD</em> class to embed the data into 25 components. iii) We transformed the 25 components with the Harmony algorithm correcting for the library ID. iv) We used the UMAP class from the <em>umap</em> Python library with the ‘<em>correlation</em>’ as a metric, 2.0 as <em>repulsion_strength</em>, and 0.01 as <em>min_dist</em>. Our Cicero workflow consisted of the following steps: a) load the sparse matrix and creating a Cicero data object with <em>make_atac_cds</em> and <em>binarize</em> set as <em>TRUE</em>, b) aggregate the raw count data with <em>make_cicero_cds</em> and <em>k=50</em>, where cell similarity used to bin cells is determined in the harmony-transformed UMAP embedding, c) estimate the distance parameter with <em>estimate_distance_parameter</em> using <em>window=250000</em>, <em>maxit=100</em>, <em>sample_num=100</em>, and <em>distance_constraint=25000</em> and computed the mean of the distance parameters, d) generate the Cicero models with <em>generate_cicero_models</em> using the mean distance parameter and <em>window=250000</em>, and e) assemble the connections with <em>assemble_connections</em> and save all the Cicero connections.</p></section><section id="S34"><h4 class="pmc_sec_title">Signac</h4>
<p id="P56">The Signac methodology to identify enhancers significantly correlated with the expression of a given gene was described in the Method <em>Peak-to-gene</em> section of the published study (<a href="#R38" class="usa-link" aria-describedby="R38">Stuart <em>et al</em>., 2021</a>). The Signac methodology was described in four steps: i) Compute the Pearson correlation between the gene expression and the accessibility of each peak within 500kb. ii) For each peak, compute a background distribution using 200 random peaks matching the GC content, the accessibility, and the sequence length of the peak, and identified with the <em>MatchRegionStats</em> R function (<a href="https://github.com/stuart-lab/signac/blob/HEAD/R/utilities.R" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/stuart-lab/signac/blob/HEAD/R/utilities.R</a>). iii) Compute a z-test using the z-score obtained with the mean and variance of the background distribution. iv) Retain links with <em>p</em>-value &lt; 0.05 and |PearsonScore| &gt; 0.05. In order to process the same simulated matrix as the other methods, we reimplemented these four steps in a Python method: a) We first used a 250kb window instead of 500kb to be consistent with our chosen simulation setup and computed the Pearson correlation using the <em>correlation</em> function of the Python <em>NumPy</em> library. b) In order to randomly select a set of enhancers <em>E</em><sub><em>r</em></sub> with similar accessibility to a given enhancer <em>e</em><sub><em>ref</em></sub> and its accessibility <em>a</em><sub><em>ref</em></sub>. We then computed the probability <em>P</em>(<em>e</em>|<em>e</em><sub><em>ref</em></sub>) of each <em>e</em> ∈ <em>E</em> and their corresponding accessibility mean <em>a</em><sub><em>e</em></sub> to be in <em>E</em><sub><em>r</em></sub> using the normed kernel function and <em>sigma=50</em>:
</p>
<table class="disp-formula p" id="FD1"><tr><td class="formula"><math id="M5" display="block"><mrow><mi>P</mi><mrow><mo>(</mo><mrow><mi>e</mi><mo>∣</mo><msub><mi>e</mi><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mrow><mo>−</mo><mtext mathvariant="italic">sigma </mtext><mo>⋅</mo><msup><mrow><mrow><mo>(</mo><mrow><msub><mi>a</mi><mi>e</mi></msub><mo>−</mo><msub><mi>a</mi><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></msup></mrow><mrow><mstyle><msub><mo>∑</mo><mrow><msup><mi>e</mi><mo>′</mo></msup><mo>∈</mo><mi>E</mi></mrow></msub><mrow><msup><mi>e</mi><mrow><mo>−</mo><mtext mathvariant="italic">sigma </mtext><mo>⋅</mo><msup><mrow><mrow><mo>(</mo><mrow><msub><mi>a</mi><mrow><mi>e</mi><mi>r</mi></mrow></msub><mo>−</mo><msub><mi>a</mi><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></msup></mrow></mstyle></mrow></mfrac></mrow></math></td></tr></table>
<p>
We randomly selected 200 enhancers using these probabilities and computed the Pearson score of each <em>e</em> ∈ <em>E</em><sub><em>r</em></sub>. All the peaks used in the simulation had the same length. c) We transformed the Pearson correlations (of enhancers in the random set <em>Er</em> or the query enhancer <em>e</em> with the target gene expression) into a <em>p</em>-value using the cumulative distribution function <em>norm</em>.<em>cdf</em> from the <em>Scipy.stats</em> package, and excluded links with |Pearson| &lt; 0.05 or <em>p</em>-value &gt; 0.05.</p></section><section id="S35"><h4 class="pmc_sec_title">SnapATAC</h4>
<p id="P57">The SnapATAC methodology was described in the <a href="#S12" class="usa-link">methods section</a> of the SnapATAC paper (<a href="#R9" class="usa-link" aria-describedby="R9">Fang <em>et al</em>., 2021</a>). It consisted in considering the expression of a gene <em>g</em> as a variable in a univariate logistic regression model that predicted the binary accessibility status of each enhancer within a 1Mb window flanking <em>g</em>. For each enhancer <em>e</em> from the set of the flanking enhancers <em>E</em>, the method built a univariate logistic model <em>e</em> = <em>Logit(g)</em> using the <em>glm</em> function with <em>link=‘binomial’</em> from the <em>R</em> software and used a <em>p</em>-value cutoff of 5e-8. We reimplemented the workflow of SnapATAC in a Python function using the <em>Logit</em> class with its <em>fit</em> method from the <em>statsmodels</em> Python library (<a href="#R37" class="usa-link" aria-describedby="R37">Seabold and Perktold, 2010</a>). In the original study, a label-transfer procedure was conducted in order to identify the matching cells between two separate snATAC-seq and scRNA-seq datasets. However, this procedure was not necessary in our case because we derived the simulated matrices from a multi-omic snRNA-/snATAC-seq dataset for which we had a matching cell ID between the two modalities.</p></section><section id="S36"><h4 class="pmc_sec_title">ArchR</h4>
<p id="P58">The ArchR methodology to infer enhancer-promoter links from scATAC-seq and enhancer-gene correlations from single-cell multi-omic data was described in the <a href="#SD1" class="usa-link">supplementary methods</a> of the original study (<a href="#R13" class="usa-link" aria-describedby="R13">Granja <em>et al</em>., 2021</a>). The method first created a <em>low-overlapping aggregate of cells</em> which excludes any pair of cells within this aggregate that share more than 80% of accessible peaks. This was done by first computing a K-nearest neighbor clustering (<em>K=100</em> with the Euclidean distance) for a subset of 500 random reference cells and using a 2D embedding of the cells as input. The method iteratively removed cells having &gt;80% of similarities with regards to the KNN neighbors and aggregated the cell vectors of the remaining cells based on their KNN neighbors, with the values further scaled and log-transformed. The Pearson correlation was then computed between the target enhancer and promoter accessibilities, and a <em>p</em>-value was inferred by a) transforming the correlation score into a t-statistic: <span xmlns:mml="http://www.w3.org/1998/Math/MathML"><math id="M6" display="inline"><mrow><mtext mathvariant="italic"> tStat </mtext><mo>=</mo><mfrac><mrow><mo>∣</mo><mtext mathvariant="italic"> score </mtext><mo>∣</mo></mrow><mrow><msqrt><mrow><mn>1</mn><mo>−</mo><mtext mathvariant="italic">max</mtext><mrow><mo>(</mo><mrow><msup><mrow><mtext mathvariant="italic">score</mtext></mrow><mn>2</mn></msup><mo>,</mo><mfrac><mrow><mn>1</mn><msup><mi>e</mi><mrow><mo>−</mo><mn>17</mn></mrow></msup></mrow><mrow><mo stretchy="false">(</mo><mi>K</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></msqrt></mrow></mfrac></mrow></math></span> and using the cumulative distribution function of the Student’s <em>t</em> law to convert <em>tStat</em> into a <em>p</em>-value. Finally, an FDR correction was applied using the Benjamini-Hochberg procedure. The R source code of the peak<em>addCoaccessibility</em> method is available here: <a href="https://rdrr.io/github/GreenleafLab/ArchR/src/R/IntegrativeAnalysis.R" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://rdrr.io/github/GreenleafLab/ArchR/src/R/IntegrativeAnalysis.R</a> and the C++ source code of the iterative aggregation strategy is available here: <a href="https://github.com/GreenleafLab/ArchR/blob/master/src/KNN_Utils.cpp" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/GreenleafLab/ArchR/blob/master/src/KNN_Utils.cpp</a>. In order to process the same matrices in the same conditions as the other methods, we reimplemented the ArchR strategy in a Python script using the following modifications: a) We used a Harmony + UMAP embedding instead of the iterative LSI strategy used in the original ArchR workflow. The embedding process was the same as described for Cicero. b) We reimplemented the aggregate strategy from the R and the C++ scripts and used the <em>NearestNeighbors</em> from the <em>Scikit-Learn</em> Python library class with the <em>cosine</em> distance to compute the K-neighbors, and iteratively computed the Jaccard similarity to exclude cells from the aggregates. We used the <em>pairwise_distances</em> function from Scikit-learn to compute the Pearson scores and the <em>fdrcorrection</em> function from the <em>Statsmodels</em> library to compute the FDR.</p></section></section><section id="S37"><h3 class="pmc_sec_title">Intersecting the inferred links with the PCHi-C data</h3>
<p id="P59">The PCHi-C data are available on GEO (see <strong>Availability of data and materials</strong>) with a limited access using <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE214107" class="usa-link" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">GSE214107</a> as accession ID. We downloaded the <em>ibed</em> files, which are similar to <em>bedpe</em> files with the 6 first columns referring to two genomic locations, for each strain, merged them and retained only the unique links.</p></section><section id="S38"><h3 class="pmc_sec_title">Estimating accuracy with the PCHi-C data</h3>
<p id="P60">We used the physical enhancer-promoter interactions from the PCHi-C datasets from the islet and adipose tissues as references to compute the overall accuracy scores (precision, recall, f1-score) of the links inferred with the Enlink, Cicero, and Chi2+FDR workflows. For both the islet and adipose, we analyzed each cell population independently with each workflow. We then combined all the links obtained for a given dataset and workflow and estimated the overall precision, recall, and f1-score using the set of the PCHi-C links as true positives. We used the <em>enhtools</em> software with the <em>intersect3</em> option from the Enhlink software suite (see above) to find the intersecting links between the reference set and the results of the different workflows.</p></section><section id="S39"><h3 class="pmc_sec_title">Estimating batch effect with entropy measurements</h3>
<p id="P61">We quantified the impact of technical batch effects by first reasoning that a true link should be distributed over sequencing batches (that are otherwise biologically similar). We used the information theory principle and computed the Shannon entropy of the link with regard to the sequencing library ID of the dataset. The library ID of the islet and adipose datasets were the ID of the 10X Genomics sequencing runs and were regarded as variables associated with the batch effect. We first computed for each inferred link from an enhancer <em>e</em> to a gene <em>g</em> the link vector <em>v</em><sub><em>l</em></sub> such as
</p>
<table class="disp-formula p" id="FD2"><tr><td class="formula"><math id="M7" display="block"><mrow><msub><mi>v</mi><mi>l</mi></msub><mo>=</mo><mi>v</mi><mo stretchy="false">(</mo><mi>e</mi><mo>∩</mo><mi>g</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>v</mi><mi>e</mi></msub><mo>°</mo><msub><mi>v</mi><mi>g</mi></msub></mrow></math></td></tr></table>
<p>
We then computed the Shanon entropy of <em>v</em><sub><em>l</em></sub> with regard to the set of library IDs <em>B</em>:
</p>
<table class="disp-formula p" id="FD3"><tr><td class="formula"><math id="M8" display="block"><mrow><mi>E</mi><mrow><mo>(</mo><mrow><msub><mi>v</mi><mi>l</mi></msub><mo>∣</mo><mi>B</mi></mrow><mo>)</mo></mrow><mo>=</mo><mo>−</mo><mstyle><munder><mo>∑</mo><mrow><mi>b</mi><mo>∈</mo><mi>B</mi></mrow></munder><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>v</mi><mi>l</mi></msub><mo>⋅</mo><msub><mi>v</mi><mi>b</mi></msub></mrow><mrow><mstyle><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>v</mi><mi>l</mi></msub></mrow></msub><mi>i</mi></mstyle></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></mstyle><mo>⋅</mo><mtext mathvariant="italic">log</mtext><mrow><mo>(</mo><mrow><mstyle><munder><mo>∑</mo><mrow><mi>b</mi><mo>∈</mo><mi>B</mi></mrow></munder><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>v</mi><mi>l</mi></msub><mo>⋅</mo><msub><mi>v</mi><mi>b</mi></msub></mrow><mrow><mstyle><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>v</mi><mi>l</mi></msub></mrow></msub><mi>i</mi></mstyle></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></mstyle></mrow><mo>)</mo></mrow></mrow></math></td></tr></table>
<p>
Here, <em>v</em><sub><em>b</em></sub> corresponds to a binary vector indicating which cells belong to <em>b</em>. Finally, we plotted the batch effect entropy distribution using the <em>seaborn</em> Python library.</p></section><section id="S40"><h3 class="pmc_sec_title">Inferring Enhlinks atlases for the islet and adipose tissues</h3>
<p id="P62">For each tissue, we processed each cell type independently using the library ID, sex, diet, and genotype/strain as covariates. We used 0.01 as the <em>p</em>-value cutoff, with the <em>secondOrder</em> and the <em>uniformSampling</em> options to infer the covariate-specific linkages from a uniform distribution of the covariates within each bootstrap sample. For each bootstrap sample, we used a random subset of 66% of the features, a maximum of 4 explanatory features, a depth of 2, and a downsampling size of 15,000 cells. We created a binary cell × promoter sparse matrix by considering all the promoter regions of each gene and give the value 1 for a given cell if at least one read is found, zero otherwise. This matrix is then used as <em>M</em><sub><em>target</em></sub> (see <a href="#SD1" class="usa-link">Additional file S1</a>). We used the <em>ATACMatUtils</em> command with the <em>-use_symbol</em> option from the <em>ATACdemultiplex</em> package (<a href="https://gitlab.com/Grouumf/ATACdemultiplex" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://gitlab.com/Grouumf/ATACdemultiplex</a>) to create the matrix from the BED file containing the reads and barcode IDs. We then intersected the obtained linkage of each cell type with the PCHi-C links of either the adipose or the islet tissues using the <em>enhtools</em> software with the <em>-intersect3</em> option</p></section><section id="S41"><h3 class="pmc_sec_title">Inferring Enhlinks for the striatum tissue</h3>
<p id="P63">We restricted the Enhlink analysis to the two neuron cell types expressing either <em>Drd1</em> or <em>Drd2</em>. We first performed two Enhlink analyses with the default parameters on the two neuron subtypes expressing either <em>Drd1</em> or <em>Drd2</em> using a) the scATAC-seq matrix alone and b) the scATAC-seq matrix for the enhancer features and the scRNA-seq matrix to infer enhancers linked to gene expression. We used the default parameters with the library ID as a covariate when using the scATAC-seq matrix only but extended the <em>max_features</em> and <em>depth</em> parameters to 6 and 4, respectively. We then intersected the ATAC and ATAC+RNA linkages of the <em>Drd1</em> and <em>Drd2</em> cell type using the <em>enhtools</em> executable with the <em>-intersect</em> option. In a second analysis aimed at identifying Drd1- or Drd2-specific linkages, we processed with Enhlink all the cells from either the <em>Drd1</em> or the <em>Drd2</em> neurons and used the library ID together with the cell type (Drd1 or Drd2) as covariates. We performed two processing steps using either the ATAC-seq data alone or the ATAC-seq data combined with the RNA-seq data that we further intersected with <em>enhtools</em>. We also processed the same ATAC-seqs dataset with Cicero using the protocol described above.</p></section><section id="S42"><h3 class="pmc_sec_title">Preparing eQTL collections</h3>
<p id="P64">Bulk RNA-sequencing for eQTL analysis was accessed and downloaded from the Churchill Lab QTL viewer (<a href="https://qtlviewer.jax.org/viewer/CheslerStriatum" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://qtlviewer.jax.org/viewer/CheslerStriatum</a> accessed 02/17/2023). This dataset represents striatum samples collected from individual mice (n = 368) from the Diversity Outbred genetic reference population (The Jackson Laboratory catalog #009376). The downloaded package includes a gene expression estimate matrix, genotype probabilities, kinship matrix and metadata including sex. We performed eQTL mapping restricted to the set of genes differentially expressed between <em>Drd1</em> and <em>Drd2</em> neurons (n = 96 and 103 respectively). eQTL mapping was performed using a linear mixed model to account for kinship on normalized, transformed gene-level expression values using the ‘scan1’ function in r/qtl2 (<a href="#R3" class="usa-link" aria-describedby="R3">Broman <em>et al</em>., 2019</a>), including sex as an additive covariate. Genes passing a filter requiring a local-eQTL with a LOD score greater than 8 (n = 162) were further included for SNP association using the ‘scan1snps’ function in r/qtl2. All variants within a 1.5 LOD confidence interval were included for association analysis. Resulting variants with LOD score drop of 1.5 from the maximum were retained, along with their strain distribution pattern, to intersect with Enlink significant links and compare to haplotype effect pattern for the linked eQTL gene. The haplotype effects of the QTL for the candidate genes <em>Kcnb2</em>, <em>Gulp1</em>, and <em>Col25a1</em> were estimated using ‘scan1blup’ from r/qtl2.</p></section><section id="S43"><h3 class="pmc_sec_title">Intersecting Enhlinks from the striatum with eQTL</h3>
<p id="P65">We formatted the results of the eQTL analysis described above as a BED file listing the genomic coordinates of the SNPs and intersected these regions with the enhancers for the Drd1 and Drd2 neuron subtypes that were correlated to both promoter accessibility and expression of their corresponding genes (see above). We then computed a <em>p</em>-value using the Mann-Withney procedure to test if the overlapping enhancer presented differential accessibility between the genotypes. We used the <em>p</em>-values and the LOD score to identify the enhancers of <em>Kcnb2</em>, <em>Gulp1</em>, and <em>Col25a1</em>. For each enhancer and their associated promoter and gene, we computed the barplot of accessibility (for the enhancer and promoter) or gene expression, using the four 10X Genomics libraries as individual measurements.</p></section><section id="S44"><h3 class="pmc_sec_title">Evaluating Enhlink and Cicero with the striatum dataset</h3>
<p id="P66">We intersected the linkages obtained from Cicero and Enlink for the Drd1/Drd2 neuron cell types from the ATAC-seq data with the 96 and 103 marker genes of the Drd1 and Drd2 neurons, respectively. For each gene and its inferred enhancer, we computed a univariate logistic regression: <em>Ve</em> = <em>f(Vg)</em>, with Ve the boolean vector of the enhancer <em>e</em> and of size <em>1 × cell</em>, indicating if <em>e</em> is accessible for each cell, and <em>Vg</em> the numerical vector indicating the scaled gene expression of <em>g</em> for each cell. We used the <em>Logit</em> class with its <em>fit</em> function from the Python <em>statsmodels</em> library to infer the <em>p</em>-value of each model. We then compared the <em>-log10(p-value)</em> distribution of the enhancer from Enhlink and from Cicero for different cutoffs: 0.0, 0.1, 0.2, and 0.28. We chose 0.28 as a cutoff to obtain a number of links (704) similar to the number obtained with Enhlink (802). We used the Mann-Whitney test to assess the difference of the <em>p</em>-value distributions between the links from Enhlink and with Cicero results. Since no difference was observed between Enhlink and Cicero with 0.28 as cutoff, we applied a t-test in this case, assuming normality of the distributions.</p></section></section><section id="SM1"><h2 class="pmc_sec_title">Supplementary Material</h2>
<section class="sm xbox font-sm" id="SD1"><div class="caption p">
<span>Supplement 1</span><p id="P84"><strong>Additional file S1</strong> Extended description of the Enhlink procedure</p>
</div>
<div class="media p" id="d64e2837"><div class="caption">
<a href="/articles/instance/10197707/bin/media-1.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-1.pdf</a><sup> (165KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD2"><div class="caption p">
<span>Supplement 2</span><p id="P82"><strong>Table S1</strong> Description of Enhlink’s hyperparameters</p>
</div>
<div class="media p" id="d64e2844"><div class="caption">
<a href="/articles/instance/10197707/bin/media-2.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-2.pdf</a><sup> (51.8KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD3"><div class="caption p">
<span>Supplement 3</span><p id="P83"><strong>Table S2</strong> Description of the hyperparameter values used for the simulation experiment</p>
</div>
<div class="media p" id="d64e2851"><div class="caption">
<a href="/articles/instance/10197707/bin/media-3.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-3.pdf</a><sup> (48.6KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD4"><div class="caption p">
<span>Supplement 4</span><p id="P73"><strong>Figure S1</strong> f1-score, precision, and recall computed from scATAC-seq data and compared to their corresponding random score distribution using the cell types aCM, vCM, or all the cells for one enhancer from <em>KCNH2</em> and three enhancers from <em>MYL2</em>.</p>
</div>
<div class="media p" id="d64e2864"><div class="caption">
<a href="/articles/instance/10197707/bin/media-4.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-4.pdf</a><sup> (464.6KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD5"><div class="caption p">
<span>Supplement 5</span><p id="P74"><strong>Figure S2</strong> Detailed Enhlink analytical workflow. Inputs are: <em>M</em><sub><em>peak</em></sub> the cell × peak matrix, <em>M</em><sub><em>target</em></sub> and <em>M</em><sub><em>cov</em></sub> (optional), the cell × target and cell × covariate matrices, <em>G</em> the list of target regions, and <em>Cl</em> (optional) a cell clustering. If <em>Cl</em> is not provided all the cells will be assigned to one cluster. <em>M</em><sub><em>i</em></sub> and <em>M</em>′<sub><em>i</em></sub> are the matrices from which the significant features associated with the target vectors are extracted. The random subsampling of the samples and features done on these matrices are not represented here for simplicity. <em>v</em><sub><em>feature</em></sub>, <em>v</em><sub><em>target</em></sub>, and <em>v</em><sub><em>eg</em></sub> are cell vectors indicating the accessibility of a region or the expression of a target. <em>Cov</em>′ is a set of significant covariates associated with <em>v</em><sub><em>target</em></sub>. The dashed procedures are optional.</p>
</div>
<div class="media p" id="d64e2941"><div class="caption">
<a href="/articles/instance/10197707/bin/media-5.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-5.pdf</a><sup> (111.1KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD6"><div class="caption p">
<span>Supplement 6</span><p id="P75"><strong>Figure S3</strong> Importance of hyperparameters on Enhlink accuracy. <em>dataset</em> refers to the type of dataset used, <em>downsample</em> refers to the number of cells randomly selected for each tree and is the most important hyperparameter with regards to accuracy (higher is more accurate), <em>max_features</em> refers to the maximum number of explanatory features used and has low importance with regards to accuracy, the other variable names in x axis refer to Enhlink hyperparameters described in <a href="#SD2" class="usa-link">Table S1</a>.</p>
</div>
<div class="media p" id="d64e2960"><div class="caption">
<a href="/articles/instance/10197707/bin/media-6.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-6.pdf</a><sup> (14.7KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD7"><div class="caption p">
<span>Supplement 7</span><p id="P76"><strong>Figure S4</strong> f1-score, precision and recall on 897 simulated genes and 4090 simulated enhancers when using different low-overlapping aggregate parameters of the ArchR method. <em>K</em> refers to the number of neighbors of the KNN steps (100 by default) and NS refers to the number of random samples used as references (500 by default). The result highlighted in purple refers to the default hyperparameter values used by ArchR. The Signac approach was used to infer a <em>p</em>-value from a random distribution.</p>
</div>
<div class="media p" id="d64e2973"><div class="caption">
<a href="/articles/instance/10197707/bin/media-7.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-7.pdf</a><sup> (211.9KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD8"><div class="caption p">
<span>Supplement 8</span><p id="P77"><strong>Figure S5</strong> Histogram distribution of the <em>batch × link</em> entropy for Cicero, Chi2 and Enhlink and Maximum entropy value according to the number of classes used. The entropy is maximum when all the classes are equiprobable. 18 classes corresponding to the 18 libraries were used to compute the covariates entropy.</p>
</div>
<div class="media p" id="d64e2983"><div class="caption">
<a href="/articles/instance/10197707/bin/media-8.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-8.pdf</a><sup> (234.5KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD9"><div class="caption p">
<span>Supplement 9</span><p id="P78"><strong>Figure S6</strong> Number of links per tissue (islet or adipose) and cell type, annotated according to overlap with PCHi-C and by biological covariate.</p>
</div>
<div class="media p" id="d64e2990"><div class="caption">
<a href="/articles/instance/10197707/bin/media-9.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-9.pdf</a><sup> (840.1KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD10"><div class="caption p">
<span>Supplement 10</span><p id="P79"><strong>Figure S7 A</strong> UMAP projection of the single-cells and clusters for the snRNA-seq Striatum dataset. Enhlink score (<strong>B</strong>) and <em>p</em>-value (<strong>C)</strong> distributions of links inferred from promoter accessibility in <em>Drd1</em> and <em>Drd2</em> neurons separated by whether they were concordant or not with links inferred from gene expression.</p>
</div>
<div class="media p" id="d64e3010"><div class="caption">
<a href="/articles/instance/10197707/bin/media-10.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-10.pdf</a><sup> (1MB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD11"><div class="caption p">
<span>Supplement 11</span><p id="P80"><strong>Figure S8</strong> Comparison of enhancer-gene expression association between Cicero and Enhlink links inferred from the multi-omic striatum dataset when using only the snATAC-seq data to infer enhancers. <strong>A</strong> Number of links inferred for the marker genes of <em>Drd1</em>/<em>Drd2</em> neurons by each method and for different Cicero cutoffs. <strong>B</strong> Number of genes inferred for each method and cutoff. <strong>C</strong> Distribution of the -log(<em>p</em>-value) of the univariate logistic regression using enhancer accessibility as dependent variable and gene expression as response.</p>
</div>
<div class="media p" id="d64e3034"><div class="caption">
<a href="/articles/instance/10197707/bin/media-11.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-11.pdf</a><sup> (251.6KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="SD12"><div class="caption p">
<span>Supplement 12</span><p id="P81"><strong>Figure S9</strong> Chromatin accessibility of distal <em>Drd1</em>-associated enhancers. <strong>A</strong> Four OCR regions linked to the top 10 striatonigral marker genes, including <em>Drd1</em> (grey). In addition, three <em>cis</em>-OCR regions are also linked to the <em>Drd1</em> promoter (green). <strong>B</strong> Exonic region (in grey) of <em>Isl1</em> correlated with both promoter accessibility and expression of nine out of the top 10 striatonigral (expressing <em>Drd1</em>) marker genes. A <em>cis</em>-OCR region linked to <em>Isl1</em> promoter is highlighted in green.</p>
</div>
<div class="media p" id="d64e3070"><div class="caption">
<a href="/articles/instance/10197707/bin/media-12.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-12.pdf</a><sup> (116.5KB, pdf) </sup>
</div></div></section></section><section id="S46" class="ack"><h2 class="pmc_sec_title">Acknowledgments</h2>
<p id="P68">We gratefully acknowledge the contribution of the Single Cell Biology service, the Genome Technologies service, and Cyberinfrastructure high performance computing resources at The Jackson Laboratory for expert assistance the work described herein. These shared services are supported in part by the JAX Cancer Center (P30 CA034196). We would like to also thank Dr. Mike Lloyd and Dr. Anuj Srivastava for their help in obtaining and processing the PCHi-C data, and Dr. Vivek M. Philip, Dr. Robyn Ball and Leona Gagnon for managing and executing experimental designs.</p>
<section id="S47"><h3 class="pmc_sec_title">Funding</h3>
<p id="P69">Research reported in this publication was supported by The Jackson Laboratory Cube Initiative and the Jackson Laboratory <em>Scientific Support Internal Fund</em> (SSIF) mechanism with the project id: 19005-21-05. Further funding was provided, in part, by the National Institute of General Medical Sciences grant R35GM133724 to CLB and the Jackson Laboratory Director’s Innovation Fund to CLB and EJC. P50 DA039841 supports the Center for Systems Neurogenetics of Addiction to EJC. Data generation through the Single Cell Biology service was supported in part by the JAX Cancer Center (P30 CA034196). Additional support was also provided by The Jackson Laboratory Cube Initiative.</p></section></section><section id="funding-statement1" lang="en"><h2 class="pmc_sec_title">Funding Statement</h2>
<p>Research reported in this publication was supported by The Jackson Laboratory Cube Initiative and the Jackson Laboratory <em>Scientific Support Internal Fund</em> (SSIF) mechanism with the project id: 19005-21-05. Further funding was provided, in part, by the National Institute of General Medical Sciences grant R35GM133724 to CLB and the Jackson Laboratory Director’s Innovation Fund to CLB and EJC. P50 DA039841 supports the Center for Systems Neurogenetics of Addiction to EJC. Data generation through the Single Cell Biology service was supported in part by the JAX Cancer Center (P30 CA034196). Additional support was also provided by The Jackson Laboratory Cube Initiative.</p></section><section id="fn-group1" class="fn-group"><h2 class="pmc_sec_title">Footnotes</h2>
<div class="fn-group p font-secondary-light font-sm"><div class="fn p" id="FN4">
<p id="P70">Competing interests</p>
<p id="P71">The author(s) declare(s) that they have no competing interests.</p>
</div></div></section><section id="S45"><h2 class="pmc_sec_title">Availability of data and materials</h2>
<p id="P67">The PCHi-C data used in this manuscript are currently available with limited access on request. The PCHI-C data are planned to be released to the public on December 31, 2023. In the meantime, these data will be available on request. The multi-omics striatum dataset is publicly accessible using the following accession number: <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE228530" class="usa-link" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">GSE228530</a>. The Linkage atlases for the islet and adipose datasets are available as Figshare datasets with the following DOIs: <a href="https://doi.org/10.6084/m9.figshare.22336033.v1" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://doi.org/10.6084/m9.figshare.22336033.v1</a> (adipose) and <a href="https://doi.org/10.6084/m9.figshare.22335919.v1" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://doi.org/10.6084/m9.figshare.22335919.v1</a> (islet).</p></section><section id="ref-list1" class="ref-list"><h2 class="pmc_sec_title">References</h2>
<section id="ref-list1_sec2"><ol class="ref-list font-sm">
<li id="R1">
<cite>‘A multimodal cell census and atlas of the mammalian primary motor cortex’ (2021) Nature, 598(7879), pp. 86–102.</cite> [<a href="https://doi.org/10.1038/s41586-021-03950-0" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8494634/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34616075/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=A%20multimodal%20cell%20census%20and%20atlas%20of%20the%20mammalian%20primary%20motor%20cortex&amp;volume=598&amp;issue=7879&amp;publication_year=2021&amp;pages=86-102&amp;pmid=34616075&amp;doi=10.1038/s41586-021-03950-0&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R2">
<cite>Breiman L. (2001) ‘Random Forests’, Machine learning, 45(1), pp. 5–32.</cite> [<a href="https://scholar.google.com/scholar_lookup?journal=Machine%20learning&amp;title=Random%20Forests&amp;author=L.%20Breiman&amp;volume=45&amp;issue=1&amp;publication_year=2001&amp;pages=5-32&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R3">
<cite>Broman K.W.
et al.  (2019) ‘R/qtl2: Software for Mapping Quantitative Trait Loci with High-Dimensional Data and Multiparent Populations’, Genetics, 211(2). Available at: 10.1534/genetics.118.301595.</cite> [<a href="https://doi.org/10.1534/genetics.118.301595" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC6366910/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/30591514/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Genetics&amp;title=R/qtl2:%20Software%20for%20Mapping%20Quantitative%20Trait%20Loci%20with%20High-Dimensional%20Data%20and%20Multiparent%20Populations&amp;author=K.W.%20Broman&amp;volume=211&amp;issue=2&amp;publication_year=2019&amp;pmid=30591514&amp;doi=10.1534/genetics.118.301595&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R4">
<cite>Churchill G.A.
et al.  (2012) ‘The Diversity Outbred Mouse Population’, Mammalian genome: official journal of the International Mammalian Genome Society, 23(9–10), p. 713.</cite> [<a href="https://doi.org/10.1007/s00335-012-9414-2" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC3524832/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/22892839/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Mammalian%20genome:%20official%20journal%20of%20the%20International%20Mammalian%20Genome%20Society&amp;title=The%20Diversity%20Outbred%20Mouse%20Population&amp;author=G.A.%20Churchill&amp;volume=23&amp;issue=9%E2%80%9310&amp;publication_year=2012&amp;pages=713&amp;pmid=22892839&amp;doi=10.1007/s00335-012-9414-2&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R5">
<cite>Claringbould A. and Zaugg J.B. (2021) ‘Enhancers in disease: molecular basis and emerging treatment strategies’, Trends in molecular medicine, 27(11), pp. 1060–1073.</cite> [<a href="https://doi.org/10.1016/j.molmed.2021.07.012" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34420874/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Trends%20in%20molecular%20medicine&amp;title=Enhancers%20in%20disease:%20molecular%20basis%20and%20emerging%20treatment%20strategies&amp;author=A.%20Claringbould&amp;author=J.B.%20Zaugg&amp;volume=27&amp;issue=11&amp;publication_year=2021&amp;pages=1060-1073&amp;pmid=34420874&amp;doi=10.1016/j.molmed.2021.07.012&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R6">
<cite>Corradin O. and Scacheri P.C. (2014) ‘Enhancer variants: evaluating functions in common disease’, Genome medicine, 6(10), pp. 1–14.</cite> [<a href="https://doi.org/10.1186/s13073-014-0085-3" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC4254432/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/25473424/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Genome%20medicine&amp;title=Enhancer%20variants:%20evaluating%20functions%20in%20common%20disease&amp;author=O.%20Corradin&amp;author=P.C.%20Scacheri&amp;volume=6&amp;issue=10&amp;publication_year=2014&amp;pages=1-14&amp;pmid=25473424&amp;doi=10.1186/s13073-014-0085-3&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R7">
<cite>Dimitriu M.A.
et al.  (2022) ‘Single-Cell Multiomics Techniques: From Conception to Applications‘, Frontiers in cell and developmental biology, 10, p. 854317.</cite> [<a href="https://doi.org/10.3389/fcell.2022.854317" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8979110/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/35386194/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Frontiers%20in%20cell%20and%20developmental%20biology&amp;title=Single-Cell%20Multiomics%20Techniques:%20From%20Conception%20to%20Applications&amp;author=M.A.%20Dimitriu&amp;volume=10&amp;publication_year=2022&amp;pages=854317&amp;pmid=35386194&amp;doi=10.3389/fcell.2022.854317&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R8">
<cite>Dymora P. and Paszkiewicz A. (2020) ‘Performance Analysis of Selected Programming Languages in the Context of Supporting Decision-Making Processes for Industry 4.0’, NATO Advanced Science Institutes series E: Applied sciences, 10(23), p. 8521.</cite> [<a href="https://scholar.google.com/scholar_lookup?journal=NATO%20Advanced%20Science%20Institutes%20series%20E:%20Applied%20sciences&amp;title=Performance%20Analysis%20of%20Selected%20Programming%20Languages%20in%20the%20Context%20of%20Supporting%20Decision-Making%20Processes%20for%20Industry%204.0&amp;author=P.%20Dymora&amp;author=A.%20Paszkiewicz&amp;volume=10&amp;issue=23&amp;publication_year=2020&amp;pages=8521&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R9">
<cite>Fang R.
et al.  (2021) ‘Comprehensive analysis of single cell ATAC-seq data with SnapATAC’, Nature communications, 12(1), pp. 1–15.</cite> [<a href="https://doi.org/10.1038/s41467-021-21583-9" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC7910485/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33637727/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20communications&amp;title=Comprehensive%20analysis%20of%20single%20cell%20ATAC-seq%20data%20with%20SnapATAC&amp;author=R.%20Fang&amp;volume=12&amp;issue=1&amp;publication_year=2021&amp;pages=1-15&amp;pmid=33637727&amp;doi=10.1038/s41467-021-21583-9&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R10">
<cite>Galitsyna A.A. and Gelfand M.S. (2021) ‘Single-cell Hi-C data analysis: safety in numbers’, Briefings in bioinformatics, 22(6), p. bbab316.</cite> [<a href="https://doi.org/10.1093/bib/bbab316" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8575028/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34406348/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Briefings%20in%20bioinformatics&amp;title=Single-cell%20Hi-C%20data%20analysis:%20safety%20in%20numbers&amp;author=A.A.%20Galitsyna&amp;author=M.S.%20Gelfand&amp;volume=22&amp;issue=6&amp;publication_year=2021&amp;pages=bbab316&amp;pmid=34406348&amp;doi=10.1093/bib/bbab316&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R11">
<cite>Gamazon E.R.
et al.  (2015) ‘A gene-based association method for mapping traits using reference transcriptome data’, Nature genetics, 47(9), pp. 1091–1098.</cite> [<a href="https://doi.org/10.1038/ng.3367" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC4552594/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/26258848/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20genetics&amp;title=A%20gene-based%20association%20method%20for%20mapping%20traits%20using%20reference%20transcriptome%20data&amp;author=E.R.%20Gamazon&amp;volume=47&amp;issue=9&amp;publication_year=2015&amp;pages=1091-1098&amp;pmid=26258848&amp;doi=10.1038/ng.3367&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R12">
<cite>Gerfen C.R.
et al.  (1990) ‘D1 and D2 dopamine receptor-regulated gene expression of striatonigral and striatopallidal neurons’, Science, 250(4986), pp. 1429–1432.</cite> [<a href="https://doi.org/10.1126/science.2147780" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/2147780/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=D1%20and%20D2%20dopamine%20receptor-regulated%20gene%20expression%20of%20striatonigral%20and%20striatopallidal%20neurons&amp;author=C.R.%20Gerfen&amp;volume=250&amp;issue=4986&amp;publication_year=1990&amp;pages=1429-1432&amp;pmid=2147780&amp;doi=10.1126/science.2147780&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R13">
<cite>Granja J.M.
et al.  (2021) ‘ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis’, Nature genetics, 53(3), pp. 403–411.</cite> [<a href="https://doi.org/10.1038/s41588-021-00790-6" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8012210/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33633365/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20genetics&amp;title=ArchR%20is%20a%20scalable%20software%20package%20for%20integrative%20single-cell%20chromatin%20accessibility%20analysis&amp;author=J.M.%20Granja&amp;volume=53&amp;issue=3&amp;publication_year=2021&amp;pages=403-411&amp;pmid=33633365&amp;doi=10.1038/s41588-021-00790-6&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R14">
<cite>Grosselin K.
et al.  (2019) ‘High-throughput single-cell ChIP-seq identifies heterogeneity of chromatin states in breast cancer’, Nature genetics, 51(6), pp. 1060–1066.</cite> [<a href="https://doi.org/10.1038/s41588-019-0424-9" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/31152164/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20genetics&amp;title=High-throughput%20single-cell%20ChIP-seq%20identifies%20heterogeneity%20of%20chromatin%20states%20in%20breast%20cancer&amp;author=K.%20Grosselin&amp;volume=51&amp;issue=6&amp;publication_year=2019&amp;pages=1060-1066&amp;pmid=31152164&amp;doi=10.1038/s41588-019-0424-9&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R15">
<cite>Hao Y.
et al.  (2021) ‘Integrated analysis of multimodal single-cell data’, Cell, 184(13), pp. 3573–3587.e29.</cite> [<a href="https://doi.org/10.1016/j.cell.2021.04.048" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8238499/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34062119/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Cell&amp;title=Integrated%20analysis%20of%20multimodal%20single-cell%20data&amp;author=Y.%20Hao&amp;volume=184&amp;issue=13&amp;publication_year=2021&amp;pages=3573-3587.e29&amp;pmid=34062119&amp;doi=10.1016/j.cell.2021.04.048&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R16">
<cite>Heinz S.
et al.  (2015) ‘The selection and function of cell type-specific enhancers’, Nature reviews. Molecular cell biology, 16(3), pp. 144–154.</cite> [<a href="https://doi.org/10.1038/nrm3949" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC4517609/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/25650801/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20reviews.%20Molecular%20cell%20biology&amp;title=The%20selection%20and%20function%20of%20cell%20type-specific%20enhancers&amp;author=S.%20Heinz&amp;volume=16&amp;issue=3&amp;publication_year=2015&amp;pages=144-154&amp;pmid=25650801&amp;doi=10.1038/nrm3949&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R17">
<cite>Hocker J.D.
et al.  (2021) ‘Cardiac cell type-specific gene regulatory programs and disease risk association’, Science advances, 7(20). Available at: 10.1126/sciadv.abf1444.</cite> [<a href="https://doi.org/10.1126/sciadv.abf1444" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8121433/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33990324/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Science%20advances&amp;title=Cardiac%20cell%20type-specific%20gene%20regulatory%20programs%20and%20disease%20risk%20association&amp;author=J.D.%20Hocker&amp;volume=7&amp;issue=20&amp;publication_year=2021&amp;pmid=33990324&amp;doi=10.1126/sciadv.abf1444&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R18">
<cite>Kamimoto K., Hoffmann C.M. and Morris S.A. (2020) ‘CellOracle: Dissecting cell identity via network inference and in silico gene perturbation’, bioRxiv. Available at: 10.1101/2020.02.17.947416.</cite> [<a href="https://doi.org/10.1101/2020.02.17.947416" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC9946838/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/36755098/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=bioRxiv&amp;title=CellOracle:%20Dissecting%20cell%20identity%20via%20network%20inference%20and%20in%20silico%20gene%20perturbation&amp;author=K.%20Kamimoto&amp;author=C.M.%20Hoffmann&amp;author=S.A.%20Morris&amp;publication_year=2020&amp;pmid=36755098&amp;doi=10.1101/2020.02.17.947416&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R19">
<cite>Kang H.M.
et al.  (2020) ‘Author Correction: Multiplexed droplet single-cell RNA-sequencing using natural genetic variation’, Nature biotechnology, 38(11), p. 1356.</cite> [<a href="https://doi.org/10.1038/s41587-020-0715-9" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33057163/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20biotechnology&amp;title=Author%20Correction:%20Multiplexed%20droplet%20single-cell%20RNA-sequencing%20using%20natural%20genetic%20variation&amp;author=H.M.%20Kang&amp;volume=38&amp;issue=11&amp;publication_year=2020&amp;pages=1356&amp;pmid=33057163&amp;doi=10.1038/s41587-020-0715-9&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R20">
<cite>Korsunsky I.
et al.  (2019) ‘Fast, sensitive and accurate integration of single-cell data with Harmony’, Nature methods, 16(12), pp. 1289–1296.</cite> [<a href="https://doi.org/10.1038/s41592-019-0619-0" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC6884693/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/31740819/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20methods&amp;title=Fast,%20sensitive%20and%20accurate%20integration%20of%20single-cell%20data%20with%20Harmony&amp;author=I.%20Korsunsky&amp;volume=16&amp;issue=12&amp;publication_year=2019&amp;pages=1289-1296&amp;pmid=31740819&amp;doi=10.1038/s41592-019-0619-0&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R21">
<cite>Lieberman-Aiden E.
et al.  (2009) ‘Comprehensive mapping of long-range interactions reveals folding principles of the human genome’, Science, 326(5950), pp. 289–293.</cite> [<a href="https://doi.org/10.1126/science.1181369" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC2858594/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/19815776/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=Comprehensive%20mapping%20of%20long-range%20interactions%20reveals%20folding%20principles%20of%20the%20human%20genome&amp;author=E.%20Lieberman-Aiden&amp;volume=326&amp;issue=5950&amp;publication_year=2009&amp;pages=289-293&amp;pmid=19815776&amp;doi=10.1126/science.1181369&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R22">
<cite>Liu H.
et al.  (2021) ‘DNA methylation atlas of the mouse brain at single-cell resolution‘, Nature, 598(7879), pp. 120–128.</cite> [<a href="https://doi.org/10.1038/s41586-020-03182-8" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8494641/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34616061/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=DNA%20methylation%20atlas%20of%20the%20mouse%20brain%20at%20single-cell%20resolution&amp;author=H.%20Liu&amp;volume=598&amp;issue=7879&amp;publication_year=2021&amp;pages=120-128&amp;pmid=34616061&amp;doi=10.1038/s41586-020-03182-8&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R23">
<cite>Li Y.E.
et al.  (2021) ‘An atlas of gene regulatory elements in adult mouse cerebrum’, Nature, 598(7879), pp. 129–136.</cite> [<a href="https://doi.org/10.1038/s41586-021-03604-1" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8494637/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34616068/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=An%20atlas%20of%20gene%20regulatory%20elements%20in%20adult%20mouse%20cerebrum&amp;author=Y.E.%20Li&amp;volume=598&amp;issue=7879&amp;publication_year=2021&amp;pages=129-136&amp;pmid=34616068&amp;doi=10.1038/s41586-021-03604-1&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R24">
<cite>Lobo M.K. and Nestler E.J. (2011) ‘The striatal balancing act in drug addiction: distinct roles of direct and indirect pathway medium spiny neurons’, Frontiers in neuroanatomy, 5, p. 41.</cite> [<a href="https://doi.org/10.3389/fnana.2011.00041" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC3140647/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/21811439/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Frontiers%20in%20neuroanatomy&amp;title=The%20striatal%20balancing%20act%20in%20drug%20addiction:%20distinct%20roles%20of%20direct%20and%20indirect%20pathway%20medium%20spiny%20neurons&amp;author=M.K.%20Lobo&amp;author=E.J.%20Nestler&amp;volume=5&amp;publication_year=2011&amp;pages=41&amp;pmid=21811439&amp;doi=10.3389/fnana.2011.00041&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R25">
<cite>Lu K.M.
et al.  (2014) ‘Dual role for Islet-1 in promoting striatonigral and repressing striatopallidal genetic programs to specify striatonigral cell identity’, Proceedings of the National Academy of Sciences of the United States of America, 111(1). Available at: 10.1073/pnas.1319138111.</cite> [<a href="https://doi.org/10.1073/pnas.1319138111" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC3890800/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/24351932/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Proceedings%20of%20the%20National%20Academy%20of%20Sciences%20of%20the%20United%20States%20of%20America&amp;title=Dual%20role%20for%20Islet-1%20in%20promoting%20striatonigral%20and%20repressing%20striatopallidal%20genetic%20programs%20to%20specify%20striatonigral%20cell%20identity&amp;author=K.M.%20Lu&amp;volume=111&amp;issue=1&amp;publication_year=2014&amp;pmid=24351932&amp;doi=10.1073/pnas.1319138111&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R26">
<cite>McArthur E. and Capra J.A. (2021) ‘Topologically associating domain boundaries that are stable across diverse cell types are evolutionarily constrained and enriched for heritability’, American journal of human genetics, 108(2), pp. 269–283.</cite> [<a href="https://doi.org/10.1016/j.ajhg.2021.01.001" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC7895846/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33545030/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=American%20journal%20of%20human%20genetics&amp;title=Topologically%20associating%20domain%20boundaries%20that%20are%20stable%20across%20diverse%20cell%20types%20are%20evolutionarily%20constrained%20and%20enriched%20for%20heritability&amp;author=E.%20McArthur&amp;author=J.A.%20Capra&amp;volume=108&amp;issue=2&amp;publication_year=2021&amp;pages=269-283&amp;pmid=33545030&amp;doi=10.1016/j.ajhg.2021.01.001&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R27">
<cite>McGinnis C.S., Murrow L.M. and Gartner Z.J. (2019) ‘DoubletFinder: Doublet Detection in Single-Cell RNA Sequencing Data Using Artificial Nearest Neighbors’, Cell systems, 8(4), pp. 329–337.e4.</cite> [<a href="https://doi.org/10.1016/j.cels.2019.03.003" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC6853612/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/30954475/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Cell%20systems&amp;title=DoubletFinder:%20Doublet%20Detection%20in%20Single-Cell%20RNA%20Sequencing%20Data%20Using%20Artificial%20Nearest%20Neighbors&amp;author=C.S.%20McGinnis&amp;author=L.M.%20Murrow&amp;author=Z.J.%20Gartner&amp;volume=8&amp;issue=4&amp;publication_year=2019&amp;pages=329-337.e4&amp;pmid=30954475&amp;doi=10.1016/j.cels.2019.03.003&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R28">
<cite>Panigrahi A. and O’Malley B.W. (2021) ‘Mechanisms of enhancer action: the known and the unknown’, Genome biology, 22(1), pp. 1–30.</cite> [<a href="https://doi.org/10.1186/s13059-021-02322-1" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8051032/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33858480/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Genome%20biology&amp;title=Mechanisms%20of%20enhancer%20action:%20the%20known%20and%20the%20unknown&amp;author=A.%20Panigrahi&amp;author=B.W.%20O%E2%80%99Malley&amp;volume=22&amp;issue=1&amp;publication_year=2021&amp;pages=1-30&amp;pmid=33858480&amp;doi=10.1186/s13059-021-02322-1&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R29">
<cite>Pedregosa F.
et al.  (2011) ‘Scikit-learn: Machine Learning in Python’, Journal of machine learning research: JMLR, 12(85), pp. 2825–2830.</cite> [<a href="https://scholar.google.com/scholar_lookup?journal=Journal%20of%20machine%20learning%20research:%20JMLR&amp;title=Scikit-learn:%20Machine%20Learning%20in%20Python&amp;author=F.%20Pedregosa&amp;volume=12&amp;issue=85&amp;publication_year=2011&amp;pages=2825-2830&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R30">
<cite>Pliner H.A.
et al.  (2018) ‘Cicero Predicts cis-Regulatory DNA Interactions from Single-Cell Chromatin Accessibility Data’, Molecular cell, 71(5), pp. 858–871.e8.</cite> [<a href="https://doi.org/10.1016/j.molcel.2018.06.044" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC6582963/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/30078726/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Molecular%20cell&amp;title=Cicero%20Predicts%20cis-Regulatory%20DNA%20Interactions%20from%20Single-Cell%20Chromatin%20Accessibility%20Data&amp;author=H.A.%20Pliner&amp;volume=71&amp;issue=5&amp;publication_year=2018&amp;pages=858-871.e8&amp;pmid=30078726&amp;doi=10.1016/j.molcel.2018.06.044&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R31">
<cite>Poirion O.
et al.  (2018) ‘Using single nucleotide variations in single-cell RNA-seq to identify subpopulations and genotype-phenotype linkage’, Nature communications, 9(1), pp. 1–13.</cite> [<a href="https://doi.org/10.1038/s41467-018-07170-5" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC6244222/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/30459309/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20communications&amp;title=Using%20single%20nucleotide%20variations%20in%20single-cell%20RNA-seq%20to%20identify%20subpopulations%20and%20genotype-phenotype%20linkage&amp;author=O.%20Poirion&amp;volume=9&amp;issue=1&amp;publication_year=2018&amp;pages=1-13&amp;pmid=30459309&amp;doi=10.1038/s41467-018-07170-5&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R32">
<cite>Quinlan J.R. (1986) ‘Induction of decision trees’, Machine learning, 1(1), pp. 81–106.</cite> [<a href="https://scholar.google.com/scholar_lookup?journal=Machine%20learning&amp;title=Induction%20of%20decision%20trees&amp;author=J.R.%20Quinlan&amp;volume=1&amp;issue=1&amp;publication_year=1986&amp;pages=81-106&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R33">
<cite>Robson M.I., Ringel A.R. and Mundlos S. (2019) ‘Regulatory Landscaping: How Enhancer-Promoter Communication Is Sculpted in 3D’, Molecular cell, 74(6), pp. 1110–1122.</cite> [<a href="https://doi.org/10.1016/j.molcel.2019.05.032" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/31226276/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Molecular%20cell&amp;title=Regulatory%20Landscaping:%20How%20Enhancer-Promoter%20Communication%20Is%20Sculpted%20in%203D&amp;author=M.I.%20Robson&amp;author=A.R.%20Ringel&amp;author=S.%20Mundlos&amp;volume=74&amp;issue=6&amp;publication_year=2019&amp;pages=1110-1122&amp;pmid=31226276&amp;doi=10.1016/j.molcel.2019.05.032&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R34">
<cite>Saul M.C.
et al.  (2019) ‘High-Diversity Mouse Populations for Complex Traits’, Trends in genetics: TIG, 35(7), pp. 501–514.</cite> [<a href="https://doi.org/10.1016/j.tig.2019.04.003" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC6571031/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/31133439/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Trends%20in%20genetics:%20TIG&amp;title=High-Diversity%20Mouse%20Populations%20for%20Complex%20Traits&amp;author=M.C.%20Saul&amp;volume=35&amp;issue=7&amp;publication_year=2019&amp;pages=501-514&amp;pmid=31133439&amp;doi=10.1016/j.tig.2019.04.003&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R35">
<cite>Saunders A.
et al.  (2018) ‘Molecular Diversity and Specializations among the Cells of the Adult Mouse Brain’, Cell, 174(4), pp. 1015–1030.e16.</cite> [<a href="https://doi.org/10.1016/j.cell.2018.07.028" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC6447408/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/30096299/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Cell&amp;title=Molecular%20Diversity%20and%20Specializations%20among%20the%20Cells%20of%20the%20Adult%20Mouse%20Brain&amp;author=A.%20Saunders&amp;volume=174&amp;issue=4&amp;publication_year=2018&amp;pages=1015-1030.e16&amp;pmid=30096299&amp;doi=10.1016/j.cell.2018.07.028&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R36">
<cite>Schoenfelder S.
et al.  (2018) ‘Promoter Capture Hi-C: High-resolution, Genome-wide Profiling of Promoter Interactions’, Journal of visualized experiments: JoVE
[Preprint], (136). Available at: 10.3791/57320.</cite> [<a href="https://doi.org/10.3791/57320" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC6102006/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/30010637/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Journal%20of%20visualized%20experiments:%20JoVE&amp;title=Promoter%20Capture%20Hi-C:%20High-resolution,%20Genome-wide%20Profiling%20of%20Promoter%20Interactions&amp;author=S.%20Schoenfelder&amp;issue=136&amp;publication_year=2018&amp;pmid=30010637&amp;doi=10.3791/57320&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R37">
<cite>Seabold S. and Perktold J. (2010) ‘Statsmodels: Econometric and statistical modeling with python’, in Proceedings of the 9th Python in Science Conference. Python in Science Conference, SciPy.
Available at: 10.25080/majora-92bf1922-011.</cite> [<a href="https://doi.org/10.25080/majora-92bf1922-011" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Proceedings%20of%20the%209th%20Python%20in%20Science%20Conference.%20Python%20in%20Science%20Conference,%20SciPy.&amp;title=Statsmodels:%20Econometric%20and%20statistical%20modeling%20with%20python&amp;author=S.%20Seabold&amp;author=J.%20Perktold&amp;publication_year=2010&amp;doi=10.25080/majora-92bf1922-011&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R38">
<cite>Stuart T.
et al.  (2021) ‘Single-cell chromatin state analysis with Signac’, Nature methods, 18(11), pp. 1333–1341.</cite> [<a href="https://doi.org/10.1038/s41592-021-01282-5" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC9255697/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34725479/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20methods&amp;title=Single-cell%20chromatin%20state%20analysis%20with%20Signac&amp;author=T.%20Stuart&amp;volume=18&amp;issue=11&amp;publication_year=2021&amp;pages=1333-1341&amp;pmid=34725479&amp;doi=10.1038/s41592-021-01282-5&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R39">
<cite>Umans B.D., Battle A. and Gilad Y. (2021) ‘Where are the disease-associated eQTLs?’, Trends in genetics: TIG, 37(2), p. 109.</cite> [<a href="https://doi.org/10.1016/j.tig.2020.08.009" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8162831/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/32912663/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Trends%20in%20genetics:%20TIG&amp;title=Where%20are%20the%20disease-associated%20eQTLs?&amp;author=B.D.%20Umans&amp;author=A.%20Battle&amp;author=Y.%20Gilad&amp;volume=37&amp;issue=2&amp;publication_year=2021&amp;pages=109&amp;pmid=32912663&amp;doi=10.1016/j.tig.2020.08.009&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R40">
<cite>Vandereyken K.
et al.  (2023) ‘Methods and applications for single-cell and spatial multi- <a href="http://omics" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">omics</a>’, Nature reviews. Genetics, pp. 1–22.</cite> [<a href="https://doi.org/10.1038/s41576-023-00580-2" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC9979144/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/36864178/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature%20reviews.%20Genetics&amp;title=%E2%80%98Methods%20and%20applications%20for%20single-cell%20and%20spatial%20multi-&amp;author=K.%20Vandereyken&amp;publication_year=2023&amp;pages=1-22&amp;pmid=36864178&amp;doi=10.1038/s41576-023-00580-2&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R41">
<cite>Wang A.
et al.  (2020) ‘Single-cell multiomic profiling of human lungs reveals cell-type-specific and age-dynamic control of SARS-CoV2 host genes’. Available at: 10.7554/eLife.62522.</cite> [<a href="https://doi.org/10.7554/eLife.62522" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC7688309/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33164753/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Single-cell%20multiomic%20profiling%20of%20human%20lungs%20reveals%20cell-type-specific%20and%20age-dynamic%20control%20of%20SARS-CoV2%20host%20genes&amp;author=A.%20Wang&amp;publication_year=2020&amp;pmid=33164753&amp;doi=10.7554/eLife.62522&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R42">
<cite>Website (no date a). Available at: 10.1111/j.2517-6161.1995.tb02031.x.</cite> [<a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Website%20(no%20date%20a)&amp;doi=10.1111/j.2517-6161.1995.tb02031.x&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R43">
<cite>Website (no date b). Available at: <a href="https://www.cell.com/trends/genetics/fulltext/S0168-9525(19)30065-49525(19)30065-4" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://www.cell.com/trends/genetics/fulltext/S0168-9525(19)30065-49525(19)30065-4</a>.</cite> [<a href="https://scholar.google.com/scholar_lookup?journal=Website%20(no%20date%20b)&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R44">
<cite>Website (no date c). Available at: 10.1002/ame2.12032.</cite> [<a href="https://doi.org/10.1002/ame2.12032" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Website%20(no%20date%20c)&amp;doi=10.1002/ame2.12032&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R45">
<cite>Yager L.M.
et al.  (2015) ‘The ins and outs of the striatum: role in drug addiction’, Neuroscience, 301, pp. 529–541.</cite> [<a href="https://doi.org/10.1016/j.neuroscience.2015.06.033" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC4523218/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/26116518/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Neuroscience&amp;title=The%20ins%20and%20outs%20of%20the%20striatum:%20role%20in%20drug%20addiction&amp;author=L.M.%20Yager&amp;volume=301&amp;publication_year=2015&amp;pages=529-541&amp;pmid=26116518&amp;doi=10.1016/j.neuroscience.2015.06.033&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R46">
<cite>Yang F.
et al.  (2017) ‘Identifying cis-mediators for trans-eQTLs across many human tissues using genomic mediation analysis’, Genome research, 27(11), p. 1859.</cite> [<a href="https://doi.org/10.1101/gr.216754.116" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC5668943/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/29021290/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Genome%20research&amp;title=Identifying%20cis-mediators%20for%20trans-eQTLs%20across%20many%20human%20tissues%20using%20genomic%20mediation%20analysis&amp;author=F.%20Yang&amp;volume=27&amp;issue=11&amp;publication_year=2017&amp;pages=1859&amp;pmid=29021290&amp;doi=10.1101/gr.216754.116&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R47">
<cite>Zhang K.
et al.  (2021) ‘A single-cell atlas of chromatin accessibility in the human genome‘, Cell, 184(24), pp. 5985–6001.e19.</cite> [<a href="https://doi.org/10.1016/j.cell.2021.10.024" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8664161/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34774128/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Cell&amp;title=A%20single-cell%20atlas%20of%20chromatin%20accessibility%20in%20the%20human%20genome&amp;author=K.%20Zhang&amp;volume=184&amp;issue=24&amp;publication_year=2021&amp;pages=5985-6001.e19&amp;pmid=34774128&amp;doi=10.1016/j.cell.2021.10.024&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R48">
<cite>Zhang Y.
et al.  (2008) ‘Model-based Analysis of ChIP-Seq (MACS)’, Genome biology, 9(9), pp. 1–9.</cite> [<a href="https://doi.org/10.1186/gb-2008-9-9-r137" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC2592715/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/18798982/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Genome%20biology&amp;title=Model-based%20Analysis%20of%20ChIP-Seq%20(MACS)&amp;author=Y.%20Zhang&amp;volume=9&amp;issue=9&amp;publication_year=2008&amp;pages=1-9&amp;pmid=18798982&amp;doi=10.1186/gb-2008-9-9-r137&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="R49">
<cite>Poirion O, Baker CN, Kumar P, Daigle S, Bhattacharyya T, Schott W, Harder J, Seignon M, Gaca M, Braun M, Churchill GA, Flynn B, White B, Robson P, George J, Ansarullah, Skelly DA (2023) Multi-tissue single cell profiling of diabetes susceptibility and resilience models reveals divergent, genetically encoded responses to an obesogenic diet, In Preparation.</cite> [<a href="https://scholar.google.com/scholar_lookup?journal=In%20Preparation&amp;title=Multi-tissue%20single%20cell%20profiling%20of%20diabetes%20susceptibility%20and%20resilience%20models%20reveals%20divergent,%20genetically%20encoded%20responses%20to%20an%20obesogenic%20diet&amp;author=O%20Poirion&amp;author=CN%20Baker&amp;author=P%20Kumar&amp;author=S%20Daigle&amp;author=T%20Bhattacharyya&amp;publication_year=2023&amp;" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
</ol></section></section><section id="_ad93_" lang="en" class="associated-data"><h2 class="pmc_sec_title">Associated Data</h2>
<p class="font-secondary"><em>This section collects any data citations, data availability statements, or supplementary materials included in this article.</em></p>
<section id="_adsm93_" lang="en" class="supplementary-materials"><h3 class="pmc_sec_title">Supplementary Materials</h3>
<section class="sm xbox font-sm" id="db_ds_supplementary-material1_reqid_"><div class="caption p">
<span>Supplement 1</span><p><strong>Additional file S1</strong> Extended description of the Enhlink procedure</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-1.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-1.pdf</a><sup> (165KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material2_reqid_"><div class="caption p">
<span>Supplement 2</span><p><strong>Table S1</strong> Description of Enhlink’s hyperparameters</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-2.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-2.pdf</a><sup> (51.8KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material3_reqid_"><div class="caption p">
<span>Supplement 3</span><p><strong>Table S2</strong> Description of the hyperparameter values used for the simulation experiment</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-3.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-3.pdf</a><sup> (48.6KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material4_reqid_"><div class="caption p">
<span>Supplement 4</span><p><strong>Figure S1</strong> f1-score, precision, and recall computed from scATAC-seq data and compared to their corresponding random score distribution using the cell types aCM, vCM, or all the cells for one enhancer from <em>KCNH2</em> and three enhancers from <em>MYL2</em>.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-4.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-4.pdf</a><sup> (464.6KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material5_reqid_"><div class="caption p">
<span>Supplement 5</span><p><strong>Figure S2</strong> Detailed Enhlink analytical workflow. Inputs are: <em>M</em><sub><em>peak</em></sub> the cell × peak matrix, <em>M</em><sub><em>target</em></sub> and <em>M</em><sub><em>cov</em></sub> (optional), the cell × target and cell × covariate matrices, <em>G</em> the list of target regions, and <em>Cl</em> (optional) a cell clustering. If <em>Cl</em> is not provided all the cells will be assigned to one cluster. <em>M</em><sub><em>i</em></sub> and <em>M</em>′<sub><em>i</em></sub> are the matrices from which the significant features associated with the target vectors are extracted. The random subsampling of the samples and features done on these matrices are not represented here for simplicity. <em>v</em><sub><em>feature</em></sub>, <em>v</em><sub><em>target</em></sub>, and <em>v</em><sub><em>eg</em></sub> are cell vectors indicating the accessibility of a region or the expression of a target. <em>Cov</em>′ is a set of significant covariates associated with <em>v</em><sub><em>target</em></sub>. The dashed procedures are optional.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-5.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-5.pdf</a><sup> (111.1KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material6_reqid_"><div class="caption p">
<span>Supplement 6</span><p><strong>Figure S3</strong> Importance of hyperparameters on Enhlink accuracy. <em>dataset</em> refers to the type of dataset used, <em>downsample</em> refers to the number of cells randomly selected for each tree and is the most important hyperparameter with regards to accuracy (higher is more accurate), <em>max_features</em> refers to the maximum number of explanatory features used and has low importance with regards to accuracy, the other variable names in x axis refer to Enhlink hyperparameters described in <a href="#SD2" class="usa-link">Table S1</a>.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-6.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-6.pdf</a><sup> (14.7KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material7_reqid_"><div class="caption p">
<span>Supplement 7</span><p><strong>Figure S4</strong> f1-score, precision and recall on 897 simulated genes and 4090 simulated enhancers when using different low-overlapping aggregate parameters of the ArchR method. <em>K</em> refers to the number of neighbors of the KNN steps (100 by default) and NS refers to the number of random samples used as references (500 by default). The result highlighted in purple refers to the default hyperparameter values used by ArchR. The Signac approach was used to infer a <em>p</em>-value from a random distribution.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-7.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-7.pdf</a><sup> (211.9KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material8_reqid_"><div class="caption p">
<span>Supplement 8</span><p><strong>Figure S5</strong> Histogram distribution of the <em>batch × link</em> entropy for Cicero, Chi2 and Enhlink and Maximum entropy value according to the number of classes used. The entropy is maximum when all the classes are equiprobable. 18 classes corresponding to the 18 libraries were used to compute the covariates entropy.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-8.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-8.pdf</a><sup> (234.5KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material9_reqid_"><div class="caption p">
<span>Supplement 9</span><p><strong>Figure S6</strong> Number of links per tissue (islet or adipose) and cell type, annotated according to overlap with PCHi-C and by biological covariate.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-9.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-9.pdf</a><sup> (840.1KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material10_reqid_"><div class="caption p">
<span>Supplement 10</span><p><strong>Figure S7 A</strong> UMAP projection of the single-cells and clusters for the snRNA-seq Striatum dataset. Enhlink score (<strong>B</strong>) and <em>p</em>-value (<strong>C)</strong> distributions of links inferred from promoter accessibility in <em>Drd1</em> and <em>Drd2</em> neurons separated by whether they were concordant or not with links inferred from gene expression.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-10.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-10.pdf</a><sup> (1MB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material11_reqid_"><div class="caption p">
<span>Supplement 11</span><p><strong>Figure S8</strong> Comparison of enhancer-gene expression association between Cicero and Enhlink links inferred from the multi-omic striatum dataset when using only the snATAC-seq data to infer enhancers. <strong>A</strong> Number of links inferred for the marker genes of <em>Drd1</em>/<em>Drd2</em> neurons by each method and for different Cicero cutoffs. <strong>B</strong> Number of genes inferred for each method and cutoff. <strong>C</strong> Distribution of the -log(<em>p</em>-value) of the univariate logistic regression using enhancer accessibility as dependent variable and gene expression as response.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-11.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-11.pdf</a><sup> (251.6KB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material12_reqid_"><div class="caption p">
<span>Supplement 12</span><p><strong>Figure S9</strong> Chromatin accessibility of distal <em>Drd1</em>-associated enhancers. <strong>A</strong> Four OCR regions linked to the top 10 striatonigral marker genes, including <em>Drd1</em> (grey). In addition, three <em>cis</em>-OCR regions are also linked to the <em>Drd1</em> promoter (green). <strong>B</strong> Exonic region (in grey) of <em>Isl1</em> correlated with both promoter accessibility and expression of nine out of the top 10 striatonigral (expressing <em>Drd1</em>) marker genes. A <em>cis</em>-OCR region linked to <em>Isl1</em> promoter is highlighted in green.</p>
</div>
<div class="media p"><div class="caption">
<a href="/articles/instance/10197707/bin/media-12.pdf" data-ga-action="click_feat_suppl" class="usa-link">media-12.pdf</a><sup> (116.5KB, pdf) </sup>
</div></div></section></section><section id="_adda93_" lang="en" class="data-availability-statement"><h3 class="pmc_sec_title">Data Availability Statement</h3>
<p>The PCHi-C data used in this manuscript are currently available with limited access on request. The PCHI-C data are planned to be released to the public on December 31, 2023. In the meantime, these data will be available on request. The multi-omics striatum dataset is publicly accessible using the following accession number: <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE228530" class="usa-link" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">GSE228530</a>. The Linkage atlases for the islet and adipose datasets are available as Figshare datasets with the following DOIs: <a href="https://doi.org/10.6084/m9.figshare.22336033.v1" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://doi.org/10.6084/m9.figshare.22336033.v1</a> (adipose) and <a href="https://doi.org/10.6084/m9.figshare.22335919.v1" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://doi.org/10.6084/m9.figshare.22335919.v1</a> (islet).</p></section></section></section><footer class="p courtesy-note font-secondary font-sm text-center"><hr class="headless">
<p>Articles from bioRxiv are provided here courtesy of <strong>Cold Spring Harbor Laboratory Preprints</strong></p></footer></section></article>

                      

                    </main>
                </div>
            </div>
        </div>

        



<!-- Secondary navigation placeholder -->
<div class="pmc-sidenav desktop:grid-col-4 display-flex">
    <section class="pmc-sidenav__container" aria-label="Article resources and navigation">
        <button type="button" class="usa-button pmc-sidenav__container__close usa-button--unstyled">
            <img src="/static/img/usa-icons/close.svg" role="img" alt="Close" />
        </button>
    <div class="display-none desktop:display-block">
       <section class="margin-top-4 desktop:margin-top-0">
              <h2 class="margin-top-0">ACTIONS</h2>
           <ul class="usa-list usa-list--unstyled usa-list--actions">
               
               <li>
                     <a
                             href="https://doi.org/10.1101/2023.05.11.540453"
                             class="usa-button usa-button--outline width-24 font-xs display-inline-flex flex-align-center flex-justify-start padding-left-1"
                             target="_blank"
                             rel="noreferrer noopener"
                             data-ga-category="actions"
                             data-ga-action="click"
                             data-ga-label="publisher_link_desktop"
                     >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#launch"></use>
                         </svg>
                         <span class="display-inline-flex flex-justify-center flex-1 padding-right-2">View on publisher site</span>
                     </a>
               </li>
               
               
               <li>
                    <a
                            href="pdf/nihpp-2023.05.11.540453v1.pdf"
                            class="usa-button usa-button--outline width-24 display-inline-flex flex-align-center flex-justify-start padding-left-1"
                            data-ga-category="actions"
                            data-ga-action="click"
                            data-ga-label="pdf_download_desktop"
                    >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#file_download"></use>
                        </svg>
                        <span class="display-inline-flex flex-justify-center flex-1">PDF (7.7 MB)</span>
                    </a>
               </li>
               
                
               <li>
                   <button role="button" class="usa-button width-24 citation-dialog-trigger display-inline-flex flex-align-center flex-justify-start padding-left-1"
                        aria-label="Open dialog with citation text in different styles"
                        data-ga-category="actions"
                        data-ga-action="open"
                        data-ga-label="cite_desktop"
                        data-all-citations-url="/resources/citations/10197707/"
                        data-citation-style="nlm"
                        data-download-format-link="/resources/citations/10197707/export/"
                    >
                        <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#format_quote"></use>
                        </svg>
                       <span class="display-inline-flex flex-justify-center flex-1 button-label">Cite</span>
                    </button>
               </li>
                
               <li>

                        <button class="usa-button width-24 collections-dialog-trigger collections-button display-inline-flex flex-align-center flex-justify-start padding-left-1 collections-button-empty"
                              aria-label="Save article in MyNCBI collections."
                              data-ga-category="actions"
                              data-ga-action="click"
                              data-ga-label="collections_button_desktop"
                              data-collections-open-dialog-enabled="false"
                              data-collections-open-dialog-url="https://account.ncbi.nlm.nih.gov/?back_url=https%3A%2F%2Fpmc.ncbi.nlm.nih.gov%2Farticles%2FPMC10197707%2F%23open-collections-dialog"
                              data-in-collections="false">
                            <svg class="usa-icon width-3 height-3 usa-icon--bookmark-full" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-full.svg#icon"></use>
                            </svg>
                            <svg class="usa-icon width-3 height-3 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-empty.svg#icon"></use>
                            </svg>
                            <span class="display-inline-flex flex-justify-center flex-1">Collections</span>
                       </button>
               </li>
               <li class="pmc-permalink">
                    <button
                            type="button"
                            class="usa-button width-24 display-inline-flex flex-align-center flex-justify padding-left-1 shadow-none"
                            aria-label="Show article permalink"
                            aria-expanded="false"
                            aria-haspopup="true"
                            data-ga-category="actions"
                            data-ga-action="open"
                            data-ga-label="permalink_desktop"
                    >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#share"></use>
                        </svg>
                        <span class="display-inline-flex flex-justify-center flex-1 button-label">Permalink</span>
                    </button>
                   

<div class="pmc-permalink__dropdown" hidden>
    <div class="pmc-permalink__dropdown__container">
          <h2 class="usa-modal__heading margin-top-0 margin-bottom-2 text-uppercase font-sans-xs">PERMALINK</h2>
          <div class="pmc-permalink__dropdown__content">
              <input type="text" class="usa-input" value="https://pmc.ncbi.nlm.nih.gov/articles/PMC10197707/" aria-label="Article permalink">
              <button class="usa-button display-inline-flex pmc-permalink__dropdown__copy__btn margin-right-0" title="Copy article permalink" data-ga-category="save_share" data-ga-action="link" data-ga-label="copy_link">
                  <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#content_copy"></use>
                  </svg>
                  <span class="margin-left-1">Copy</span>
              </button>
          </div>
    </div>
</div>
               </li>
           </ul>
       </section>
     </div>

        <section class="pmc-resources margin-top-6 desktop:margin-top-4" data-page-path="/articles/PMC10197707/">
            <h2 class="margin-top-0">RESOURCES</h2>
            
                <div class="usa-accordion usa-accordion--multiselectable" data-allow-multiple>
                    <h3 class="usa-accordion__heading">
                        <button
                        type="button"
                        class="usa-accordion__button"
                        aria-expanded="false"
                        aria-controls="resources-similar-articles"
                        data-ga-category="resources_accordion"
                        data-ga-action="open_similar_articles"
                        data-ga-label="/articles/PMC10197707/"
                        data-action-open="open_similar_articles"
                        data-action-close="close_similar_articles"
                        >
                            Similar articles
                        </button>
                    </h3>
                    <div
                            id="resources-similar-articles"
                            class="usa-accordion__content usa-prose"
                            
                                data-source-url="/resources/similar-article-links/37214950/"
                            
                    >
                        
                    </div>
                    <h3 class="usa-accordion__heading">
                        <button
                        type="button"
                        class="usa-accordion__button"
                        aria-expanded="false"
                        aria-controls="resources-cited-by-other-articles"
                        data-ga-category="resources_accordion"
                        data-ga-action="open_cited_by"
                        data-ga-label="/articles/PMC10197707/"
                        data-action-open="open_cited_by"
                        data-action-close="close_cited_by"
                        >
                             Cited by other articles
                        </button>
                    </h3>
                    <div
                            id="resources-cited-by-other-articles"
                            class="usa-accordion__content usa-prose"
                            
                                data-source-url="/resources/cited-by-links/37214950/"
                            
                    >
                          
                    </div>
                    
                        <h3 class="usa-accordion__heading">
                            <button
                            type="button"
                            class="usa-accordion__button"
                            aria-expanded="false"
                            aria-controls="resources-links-to-ncbi-databases"
                            data-ga-category="resources_accordion"
                            data-ga-action="open_NCBI_links"
                            data-ga-label="/articles/PMC10197707/"
                            data-action-open="open_NCBI_links"
                            data-action-close="close_NCBI_link"
                            >
                                 Links to NCBI Databases
                            </button>
                        </h3>
                        <div
                                id="resources-links-to-ncbi-databases"
                                class="usa-accordion__content usa-prose"
                                data-source-url="/resources/db-links/10197707/"
                        >
                        </div>
                    
                    
                </div>
            
        </section>


        <section
        class="usa-in-page-nav usa-in-page-nav--wide margin-top-6 desktop:margin-top-4"
        data-title-text="On this page"
        data-title-heading-level="h2"
        data-scroll-offset="0"
        data-root-margin="-10% 0px -80% 0px"
        data-main-content-selector="main"
        data-threshold="1"
        hidden
        ></section>
    </section>
</div>


        

<div class="overlay" role="dialog" aria-label="Citation Dialog" hidden>
    <div class="dialog citation-dialog" aria-hidden="true">
        <div class="display-inline-flex flex-align-center flex-justify width-full margin-bottom-2">
            <h2 class="usa-modal__heading margin-0">Cite</h2>
             <button type="button" class="usa-button usa-button--unstyled close-overlay text-black width-auto"  tabindex="1">
                <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#close"></use>
                </svg>
             </button>
        </div>

        

<div class="citation-text-block">
  <div class="citation-text margin-bottom-2"></div>
  <ul class="usa-list usa-list--unstyled display-inline-flex flex-justify width-full flex-align-center">
      <li>
        <button
          class="usa-button usa-button--unstyled text-no-underline display-flex flex-align-center copy-button dialog-focus"
          data-ga-category="save_share"
          data-ga-action="cite"
          data-ga-label="copy"
          tabindex="2">
            <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                <use xlink:href="/static/img/sprite.svg#content_copy"></use>
            </svg>
            <span>Copy</span>
        </button>
      </li>
      <li>
          <a
              href="#"
              role="button"
              class="usa-button usa-button--unstyled text-no-underline display-flex flex-align-center export-button"
              data-ga-category="save_share"
              data-ga-action="cite"
              data-ga-label="download"
              title="Download a file for external citation management software"
              tabindex="3">
                <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#file_download"></use>
                </svg>
                <span class="display-none mobile-lg:display-inline">Download .nbib</span>
                <span class="display-inline mobile-lg:display-none">.nbib</span>
            </a>
      </li>
      <li>
          

<div class="display-inline-flex flex-align-center">
  <label class="usa-label margin-top-0">Format:</label>
  <select aria-label="Format" class="usa-select citation-style-selector padding-1 margin-top-0 border-0 padding-right-4" tabindex="4" >
    
      <option data-style-url-name="ama"
              value="AMA"
              >
        AMA
      </option>
    
      <option data-style-url-name="apa"
              value="APA"
              >
        APA
      </option>
    
      <option data-style-url-name="mla"
              value="MLA"
              >
        MLA
      </option>
    
      <option data-style-url-name="nlm"
              value="NLM"
              selected="selected">
        NLM
      </option>
    
  </select>
</div>
      </li>
  </ul>
</div>
    </div>
</div>

        <div class="overlay" role="dialog" hidden>
  <div id="collections-action-dialog" class="dialog collections-dialog" aria-hidden="true">
   <div class="display-inline-flex flex-align-center flex-justify width-full margin-bottom-2">
        <h2 class="usa-modal__heading margin-0">Add to Collections</h2>
    </div>
    <div class="collections-action-panel action-panel">
      


<form id="collections-action-dialog-form"
      class="usa-form maxw-full collections-action-panel-form action-panel-content action-form action-panel-smaller-selectors"
      data-existing-collections-url="/list-existing-collections/"
      data-add-to-existing-collection-url="/add-to-existing-collection/"
      data-create-and-add-to-new-collection-url="/create-and-add-to-new-collection/"
      data-myncbi-max-collection-name-length="100"
      data-collections-root-url="https://www.ncbi.nlm.nih.gov/myncbi/collections/">

    <input type="hidden" name="csrfmiddlewaretoken" value="hhy5ufoWkYBEKmr9IZzzYJGOfQk3ICEzcs6UIvxyplxsbbK4x4KUSrZhPmpuhLhb">

    <fieldset class="usa-fieldset margin-bottom-2">
        <div class="usa-radio">
            <input type="radio"
            id="collections-action-dialog-new"
            class="usa-radio__input usa-radio__input--tile collections-new  margin-top-0"
            name="collections"
            value="new"
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="collections_radio_new" />
            <label class="usa-radio__label" for="collections-action-dialog-new">Create a new collection</label>
        </div>
        <div class="usa-radio">
            <input type="radio"
            id="collections-action-dialog-existing"
            class="usa-radio__input usa-radio__input--tile collections-existing"
            name="collections"
            value="existing"
            checked="true"
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="collections_radio_existing" />
            <label class="usa-radio__label" for="collections-action-dialog-existing">Add to an existing collection</label>
        </div>
    </fieldset>

    <fieldset class="usa-fieldset margin-bottom-2">
        <div class="action-panel-control-wrap new-collections-controls">
           <label for="collections-action-dialog-add-to-new" class="usa-label margin-top-0">
                Name your collection
               <abbr title="required" class="usa-hint usa-hint--required text-no-underline">*</abbr>
          </label>
          <input
            type="text"
            name="add-to-new-collection"
            id="collections-action-dialog-add-to-new"
            class="usa-input collections-action-add-to-new"
            pattern="[^&quot;&amp;=&lt;&gt;/]*" title="The following characters are not allowed in the Name field: &quot;&amp;=&lt;&gt;/"
            maxlength=""
            data-ga-category="collections_button"
            data-ga-action="create_collection"
            data-ga-label="non_favorties_collection"
            required
          />
        </div>
        <div class="action-panel-control-wrap existing-collections-controls">
             <label for="collections-action-dialog-add-to-existing" class="usa-label margin-top-0">
                Choose a collection
              </label>
              <select id="collections-action-dialog-add-to-existing"
                      class="usa-select collections-action-add-to-existing"
                      data-ga-category="collections_button"
                      data-ga-action="select_collection"
                      data-ga-label="($('.collections-action-add-to-existing').val() === 'Favorites') ? 'Favorites' : 'non_favorites_collection'">
              </select>
              <div class="collections-retry-load-on-error usa-input-error-message selection-validation-message">
                Unable to load your collection due to an error<br>
                <a href="#">Please try again</a>
              </div>
        </div>
    </fieldset>

    <div class="display-inline-flex">
        <button class="usa-button margin-top-0 action-panel-submit"
            type="submit"
            data-loading-label="Adding..."
            data-pinger-ignore
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="add">
          Add
        </button>
        <button class="usa-button usa-button--outline margin-top-0 action-panel-cancel"
                aria-label="Close 'Add to Collections' panel"
                ref="linksrc=close_collections_panel"
                data-ga-category="collections_button"
                data-ga-action="click"
                data-ga-label="cancel">
          Cancel
        </button>
    </div>
</form>
    </div>
  </div>
</div>

        

      </div>
    </div>
  </div>



        
    
    

<footer class="ncbi-footer ncbi-dark-background " >
    
        <div class="ncbi-footer__icon-section">
            <div class="ncbi-footer__social-header">
                Follow NCBI
            </div>

            <div class="grid-container ncbi-footer__ncbi-social-icons-container">
                
                    <a href="https://twitter.com/ncbi"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="40"
                             height="40"
                             viewBox="0 0 40 40"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="m6.067 8 10.81 13.9L6 33.2h4.2l8.4-9.1 7.068 9.1H34L22.8 18.5 31.9 8h-3.5l-7.7 8.4L14.401 8H6.067Zm3.6 1.734h3.266l16.8 21.732H26.57L9.668 9.734Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on X (formerly known as Twitter)</span>
                    </a>
                

                
                    <a href="https://www.facebook.com/ncbi.nlm"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="16"
                             height="29"
                             focusable="false"
                             aria-hidden="true"
                             viewBox="0 0 16 29"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M3.8809 21.4002C3.8809 19.0932 3.8809 16.7876 3.8809 14.478C3.8809 14.2117 3.80103 14.1452 3.54278 14.1492C2.53372 14.1638 1.52334 14.1492 0.514288 14.1598C0.302626 14.1598 0.248047 14.0972 0.248047 13.8936C0.256034 12.4585 0.256034 11.0239 0.248047 9.58978C0.248047 9.37013 0.302626 9.30224 0.528931 9.3049C1.53798 9.31688 2.54837 9.3049 3.55742 9.31555C3.80103 9.31555 3.8809 9.26097 3.87957 9.00272C3.87158 8.00565 3.85428 7.00592 3.90753 6.00884C3.97142 4.83339 4.31487 3.73115 5.04437 2.78467C5.93095 1.63318 7.15699 1.09005 8.56141 0.967577C10.5582 0.79319 12.555 0.982221 14.5518 0.927641C14.7102 0.927641 14.7462 0.99287 14.7449 1.13664C14.7449 2.581 14.7449 4.02668 14.7449 5.47104C14.7449 5.67604 14.6517 5.68669 14.4946 5.68669C13.4523 5.68669 12.4113 5.68669 11.3703 5.68669C10.3506 5.68669 9.92057 6.10868 9.90593 7.13904C9.89661 7.7647 9.91525 8.39303 9.89794 9.01869C9.88995 9.26364 9.96583 9.31822 10.2015 9.31688C11.7204 9.30623 13.2393 9.31688 14.7595 9.3049C15.0257 9.3049 15.0723 9.3728 15.0444 9.62439C14.89 10.9849 14.7515 12.3467 14.6144 13.7085C14.5691 14.1571 14.5785 14.1585 14.1458 14.1585C12.8386 14.1585 11.5313 14.1665 10.2254 14.1518C9.95119 14.1518 9.89794 14.2317 9.89794 14.4899C9.90593 19.0799 9.89794 23.6752 9.91125 28.2612C9.91125 28.5674 9.8407 28.646 9.53186 28.6433C7.77866 28.6273 6.02414 28.6366 4.27094 28.634C3.82499 28.634 3.87158 28.6992 3.87158 28.22C3.87602 25.9472 3.87913 23.6739 3.8809 21.4002Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on Facebook</span>
                    </a>
                

                
                    <a href="https://www.linkedin.com/company/ncbinlm"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="25"
                             height="23"
                             viewBox="0 0 26 24"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M14.6983 9.98423C15.6302 9.24808 16.5926 8.74754 17.6762 8.51991C19.673 8.09126 21.554 8.30824 23.1262 9.7526C24.2351 10.7723 24.7529 12.1115 25.0165 13.5612C25.1486 14.3363 25.2105 15.1218 25.2015 15.9081C25.2015 18.3043 25.2015 20.6898 25.2082 23.0806C25.2082 23.3468 25.1549 23.444 24.8621 23.4414C23.1297 23.4272 21.3992 23.4272 19.6704 23.4414C19.4041 23.4414 19.3429 23.3588 19.3442 23.1019C19.3535 20.5194 19.3442 17.9368 19.3442 15.3543C19.3442 14.0005 18.3258 12.9448 17.0266 12.9488C15.7273 12.9528 14.6983 14.0071 14.6983 15.361C14.6983 17.9328 14.6917 20.5047 14.6983 23.0753C14.6983 23.3708 14.6198 23.444 14.3296 23.4427C12.6185 23.4294 10.9079 23.4294 9.19779 23.4427C8.93155 23.4427 8.86099 23.3735 8.86232 23.1086C8.8783 19.7619 8.88628 16.4144 8.88628 13.066C8.88628 11.5688 8.87874 10.0708 8.86365 8.57182C8.86365 8.3575 8.90758 8.27896 9.14054 8.28029C10.9048 8.29094 12.6687 8.29094 14.4321 8.28029C14.6464 8.28029 14.6983 8.34818 14.6983 8.54653C14.6903 9.00047 14.6983 9.45441 14.6983 9.98423Z">
                            </path>
                            <path d="M6.55316 15.8443C6.55316 18.2564 6.55316 20.6699 6.55316 23.082C6.55316 23.3629 6.48127 23.4388 6.19906 23.4374C4.47737 23.4241 2.75568 23.4241 1.03399 23.4374C0.767751 23.4374 0.69986 23.3629 0.701191 23.1006C0.709178 18.2648 0.709178 13.4281 0.701191 8.59053C0.701191 8.34026 0.765089 8.27237 1.01669 8.2737C2.74991 8.28435 4.48048 8.28435 6.20838 8.2737C6.47462 8.2737 6.5465 8.33627 6.54517 8.6065C6.54783 11.0186 6.55316 13.4308 6.55316 15.8443Z">
                            </path>
                            <path d="M3.65878 0.243898C5.36804 0.243898 6.58743 1.45529 6.58743 3.1406C6.58743 4.75801 5.32145 5.95742 3.60819 5.96807C3.22177 5.97614 2.83768 5.90639 2.47877 5.76299C2.11985 5.61959 1.79344 5.40546 1.51897 5.13334C1.24449 4.86123 1.02755 4.53668 0.881058 4.17902C0.734563 3.82136 0.661505 3.43788 0.666231 3.05141C0.67555 1.42601 1.9362 0.242566 3.65878 0.243898Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on LinkedIn</span>
                    </a>
                

                
                    <a href="https://github.com/ncbi"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="28"
                             height="27"
                             viewBox="0 0 28 28"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M16.7228 20.6334C17.5057 20.5527 18.2786 20.3944 19.0301 20.1608C21.3108 19.4193 22.5822 17.8259 22.963 15.4909C23.1228 14.5112 23.1814 13.5287 22.9883 12.5437C22.8106 11.6423 22.4013 10.8028 21.8007 10.1076C21.7526 10.0605 21.7197 10 21.7064 9.934C21.6931 9.86799 21.7 9.79952 21.7262 9.73748C22.0856 8.6206 21.9711 7.51969 21.601 6.42677C21.582 6.3497 21.5345 6.2827 21.468 6.23923C21.4016 6.19577 21.3211 6.17906 21.2429 6.19248C20.7329 6.21649 20.2313 6.33051 19.7611 6.52928C19.1103 6.7908 18.4899 7.12198 17.9104 7.51703C17.84 7.56996 17.7581 7.60551 17.6713 7.62078C17.5846 7.63605 17.4954 7.6306 17.4112 7.60489C15.2596 7.05882 13.0054 7.06203 10.8554 7.61421C10.7806 7.63586 10.7018 7.63967 10.6253 7.62534C10.5487 7.611 10.4766 7.57892 10.4148 7.53167C9.64788 7.03247 8.85171 6.58918 7.96368 6.33359C7.65781 6.24338 7.34123 6.19458 7.02239 6.18849C6.94879 6.17986 6.87462 6.19893 6.81432 6.242C6.75402 6.28507 6.71191 6.34904 6.69621 6.42145C6.32342 7.51437 6.2209 8.61527 6.56307 9.73348C6.59635 9.84264 6.64694 9.93316 6.54177 10.0516C5.47666 11.2604 5.09988 12.6834 5.19574 14.2676C5.2663 15.4244 5.46201 16.5466 6.01454 17.5769C6.84399 19.1171 8.21664 19.9119 9.85158 20.3352C10.3938 20.4706 10.9444 20.5698 11.4998 20.632C11.5384 20.7492 11.4506 20.7798 11.408 20.8291C11.1734 21.1179 10.9894 21.4441 10.8634 21.7942C10.7622 22.0458 10.8315 22.4039 10.6065 22.5516C10.263 22.7766 9.83827 22.8485 9.42421 22.8871C8.17936 23.0056 7.26471 22.4877 6.6283 21.4348C6.25552 20.8184 5.76956 20.3325 5.08523 20.0663C4.76981 19.9325 4.42139 19.8967 4.08537 19.9638C3.7898 20.029 3.73788 20.1901 3.93891 20.4111C4.03639 20.5234 4.14989 20.6207 4.27575 20.6999C4.9796 21.1318 5.51717 21.7884 5.80152 22.5636C6.37002 23.9973 7.48039 24.5697 8.93825 24.6323C9.43741 24.6575 9.93768 24.615 10.4254 24.5058C10.5892 24.4672 10.6531 24.4872 10.6517 24.6762C10.6451 25.4936 10.6637 26.3123 10.6517 27.131C10.6517 27.6635 10.1684 27.9297 9.58663 27.7393C8.17396 27.2671 6.84977 26.5631 5.66838 25.656C2.59555 23.2891 0.720966 20.1861 0.217704 16.3376C-0.357453 11.9127 0.911353 8.00824 3.98551 4.73881C6.11909 2.42656 8.99932 0.939975 12.1203 0.540191C16.5351 -0.0601815 20.4347 1.14323 23.7232 4.16373C26.2449 6.47869 27.724 9.37672 28.1048 12.7726C28.5828 17.0325 27.3686 20.7945 24.4768 23.9827C22.9762 25.6323 21.0956 26.8908 18.9982 27.6488C18.8783 27.6927 18.7585 27.738 18.636 27.7726C18.0356 27.9404 17.6189 27.6395 17.6189 27.0098C17.6189 25.7452 17.6308 24.4806 17.6295 23.2159C17.6329 22.9506 17.6128 22.6856 17.5696 22.4238C17.4325 21.6664 17.3419 21.484 16.7228 20.6334Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on GitHub</span>
                    </a>
                

                
                    <a href="https://ncbiinsights.ncbi.nlm.nih.gov/"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="26"
                             height="26"
                             viewBox="0 0 27 27"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M23.7778 26.4574C23.1354 26.3913 22.0856 26.8024 21.636 26.3087C21.212 25.8444 21.4359 24.8111 21.324 24.0347C19.9933 14.8323 14.8727 8.80132 6.09057 5.85008C4.37689 5.28406 2.58381 4.99533 0.779072 4.99481C0.202773 4.99481 -0.0229751 4.83146 0.00455514 4.21479C0.0660406 3.08627 0.0660406 1.95525 0.00455514 0.826734C-0.0413285 0.0815827 0.259669 -0.0193618 0.896534 0.00266238C6.96236 0.222904 12.3693 2.24179 16.9889 6.16209C22.9794 11.2478 26.1271 17.7688 26.4372 25.648C26.4629 26.294 26.3179 26.5271 25.6609 26.4684C25.0827 26.417 24.4991 26.4574 23.7778 26.4574Z">
                            </path>
                            <path d="M14.8265 26.441C14.0924 26.441 13.2371 26.6795 12.6626 26.3786C12.0092 26.0372 12.3781 25.0644 12.246 24.378C11.1154 18.5324 6.6849 14.5497 0.74755 14.1001C0.217135 14.0615 -0.0104482 13.9422 0.0134113 13.3659C0.0519536 12.1454 0.0482829 10.9213 0.0134113 9.69524C-0.00127145 9.14464 0.196946 9.03268 0.703502 9.04736C9.21217 9.27128 16.5994 16.2511 17.2804 24.7231C17.418 26.4446 17.418 26.4446 15.6579 26.4446H14.832L14.8265 26.441Z">
                            </path>
                            <path d="M3.58928 26.4555C2.64447 26.4618 1.73584 26.0925 1.06329 25.4289C0.39073 24.7653 0.00933763 23.8617 0.0030097 22.9169C-0.00331824 21.9721 0.365937 21.0635 1.02954 20.3909C1.69315 19.7184 2.59675 19.337 3.54156 19.3306C4.48637 19.3243 5.39499 19.6936 6.06755 20.3572C6.7401 21.0208 7.1215 21.9244 7.12782 22.8692C7.13415 23.814 6.7649 24.7226 6.10129 25.3952C5.43768 26.0677 4.53409 26.4491 3.58928 26.4555Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI RSS feed</span>
                    </a>
                
            </div>
        </div>
    

    <div data-testid="gridContainer"
         class="grid-container ncbi-footer__container">
        <div class="grid-row ncbi-footer__main-content-container"
             data-testid="grid">
            
                <div class="ncbi-footer__column">
                    
                        <p class="ncbi-footer__circled-icons-heading">
                            Connect with NLM
                        </p>
                    

                    <div class="ncbi-footer__circled-icons-list">
                        
                            <a href=https://twitter.com/nlm_nih class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="32"
                                     height="32"
                                     viewBox="0 0 40 40"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="m6.067 8 10.81 13.9L6 33.2h4.2l8.4-9.1 7.068 9.1H34L22.8 18.5 31.9 8h-3.5l-7.7 8.4L14.401 8H6.067Zm3.6 1.734h3.266l16.8 21.732H26.57L9.668 9.734Z">
                                    </path>
                                </svg>
                                <span class="usa-sr-only">NLM on X (formerly known as Twitter)</span>
                            </a>
                        

                        
                            <a href=https://www.facebook.com/nationallibraryofmedicine class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="13"
                                     height="24"
                                     viewBox="0 0 13 24"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="M4.11371 23.1369C4.11371 23.082 4.11371 23.0294 4.11371 22.9745V12.9411H0.817305C0.6709 12.9411 0.670898 12.9411 0.670898 12.8016C0.670898 11.564 0.670898 10.3287 0.670898 9.09341C0.670898 8.97903 0.705213 8.95158 0.815017 8.95158C1.8673 8.95158 2.91959 8.95158 3.97417 8.95158H4.12057V8.83263C4.12057 7.8055 4.12057 6.7738 4.12057 5.74897C4.1264 4.92595 4.31387 4.11437 4.66959 3.37217C5.12916 2.38246 5.94651 1.60353 6.95717 1.1921C7.64827 0.905008 8.3913 0.764035 9.13953 0.778051C10.0019 0.791777 10.8644 0.830666 11.7268 0.860404C11.8869 0.860404 12.047 0.894717 12.2072 0.90158C12.2964 0.90158 12.3261 0.940469 12.3261 1.02968C12.3261 1.5421 12.3261 2.05452 12.3261 2.56465C12.3261 3.16857 12.3261 3.7725 12.3261 4.37642C12.3261 4.48165 12.2964 4.51367 12.1912 4.51138C11.5369 4.51138 10.8804 4.51138 10.2261 4.51138C9.92772 4.51814 9.63058 4.5526 9.33855 4.61433C9.08125 4.6617 8.84537 4.78881 8.66431 4.97766C8.48326 5.16652 8.3662 5.40755 8.32972 5.66661C8.28476 5.89271 8.26027 6.1224 8.25652 6.35289C8.25652 7.19014 8.25652 8.02969 8.25652 8.86923C8.25652 8.89439 8.25652 8.91955 8.25652 8.95615H12.0219C12.1797 8.95615 12.182 8.95616 12.1614 9.10714C12.0768 9.76596 11.9876 10.4248 11.9029 11.0813C11.8312 11.6319 11.7626 12.1824 11.697 12.733C11.6719 12.9434 11.6787 12.9434 11.4683 12.9434H8.26338V22.899C8.26338 22.979 8.26338 23.0591 8.26338 23.1392L4.11371 23.1369Z">
                                    </path>
                                </svg>
                                <span class="usa-sr-only">NLM on Facebook</span>
                            </a>
                        

                        
                            <a href=https://www.youtube.com/user/NLMNIH class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="21"
                                     height="15"
                                     viewBox="0 0 21 15"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="M19.2561 1.47914C18.9016 1.15888 18.5699 0.957569 17.2271 0.834039C15.5503 0.678484 13.2787 0.655608 11.563 0.65332H9.43556C7.71987 0.65332 5.4483 0.678484 3.77151 0.834039C2.43098 0.957569 2.097 1.15888 1.74242 1.47914C0.813665 2.32097 0.619221 4.62685 0.598633 6.89384C0.598633 7.31781 0.598633 7.74101 0.598633 8.16345C0.626084 10.4121 0.827391 12.686 1.74242 13.521C2.097 13.8412 2.4287 14.0425 3.77151 14.1661C5.4483 14.3216 7.71987 14.3445 9.43556 14.3468H11.563C13.2787 14.3468 15.5503 14.3216 17.2271 14.1661C18.5676 14.0425 18.9016 13.8412 19.2561 13.521C20.1712 12.6929 20.3725 10.451 20.3999 8.22064C20.3999 7.74025 20.3999 7.25986 20.3999 6.77946C20.3725 4.54907 20.1689 2.30724 19.2561 1.47914ZM8.55942 10.5311V4.65201L13.5601 7.50005L8.55942 10.5311Z"
                                          fill="white" />
                                </svg>
                                <span class="usa-sr-only">NLM on YouTube</span>
                            </a>
                        
                    </div>
                </div>
            

            
                <address class="ncbi-footer__address ncbi-footer__column">
                    
        <p>
            <a class="usa-link usa-link--external"
            href="https://www.google.com/maps/place/8600+Rockville+Pike,+Bethesda,+MD+20894/%4038.9959508,
            -77.101021,17z/data%3D!3m1!4b1!4m5!3m4!1s0x89b7c95e25765ddb%3A0x19156f88b27635b8!8m2!3d38.9959508!
            4d-77.0988323"
            rel="noopener noreferrer" target="_blank">National Library of Medicine
            <br/> 8600 Rockville Pike<br/> Bethesda, MD 20894</a>
        </p>
    
                </address>
            

            
                <ul class="usa-list usa-list--unstyled ncbi-footer__vertical-list ncbi-footer__column">
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/web_policies.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Web Policies
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nih.gov/institutes-nih/nih-office-director/office-communications-public-liaison/freedom-information-act-office" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            FOIA
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.hhs.gov/vulnerability-disclosure-policy/index.html" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            HHS Vulnerability Disclosure
        

        
    </a>


                        </li>
                    
                </ul>
            

            
                <ul class="usa-list usa-list--unstyled ncbi-footer__vertical-list ncbi-footer__column">
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://support.nlm.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Help
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/accessibility.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Accessibility
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/careers/careers.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Careers
        

        
    </a>


                        </li>
                    
                </ul>
            
        </div>

        
            <div class="grid-row grid-col-12" data-testid="grid">
                <ul class="ncbi-footer__bottom-links-list">
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.nlm.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            NLM
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            NIH
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.hhs.gov/" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            HHS
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.usa.gov/" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            USA.gov
        

        
    </a>


                        </li>
                    
                </ul>
            </div>
        
    </div>
</footer>

    


        
        
    
  <script  type="text/javascript" src="https://cdn.ncbi.nlm.nih.gov/core/pinger/pinger.js"> </script>


    
        

<button class="back-to-top" data-ga-category="pagination" data-ga-action="back_to_top">
    <label>Back to Top</label>
    <svg class="usa-icon order-0" aria-hidden="true" focusable="false" role="img">
        <use xlink:href="/static/img/sprite.svg#arrow_upward"></use>
    </svg>
</button>
    


        
    
    
    
        
    <script type="application/javascript">
    window.ncbi = window.ncbi || {};
    window.ncbi.pmc = window.ncbi.pmc || {};
    window.ncbi.pmc.options = {
        logLevel: 'INFO',
        
        staticEndpoint: '/static/',
        
        citeCookieName: 'pmc-cf',
    };
</script>
    <script type="module" crossorigin="" src="/static/assets/base-133c6271.js"></script>
    
    <script type="text/javascript" src="https://cdn.ncbi.nlm.nih.gov/core/jquery/jquery-3.6.0.min.js">&#xA0;</script>
    <script type="text/javascript">
        jQuery.getScript("https://cdn.ncbi.nlm.nih.gov/core/alerts/alerts.js", function () {
            galert(['div.nav_and_browser', 'div.header', '#universal_header', '.usa-banner', 'body > *:nth-child(1)'])
        });
    </script>


    <script type="text/javascript">var exports = {};</script>
     <script src="/static/CACHE/js/output.13b077bc3ffd.js"></script>

    <script type="module" crossorigin="" src="/static/assets/article-44d04358.js"></script>
    
        <script type="module" crossorigin="" src="/static/assets/math-574fdcc6.js"></script>
    
    

    </body>
</html>
